{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Starbucks Capstone Challenge\n",
    "\n",
    "### Introduction\n",
    "\n",
    "This data set contains simulated data that mimics customer behavior on the Starbucks rewards mobile app. Once every few days, Starbucks sends out an offer to users of the mobile app. An offer can be merely an advertisement for a drink or an actual offer such as a discount or BOGO (buy one get one free). Some users might not receive any offer during certain weeks. \n",
    "\n",
    "Not all users receive the same offer, and that is the challenge to solve with this data set.\n",
    "\n",
    "Your task is to combine transaction, demographic and offer data to determine which demographic groups respond best to which offer type. This data set is a simplified version of the real Starbucks app because the underlying simulator only has one product whereas Starbucks actually sells dozens of products.\n",
    "\n",
    "Every offer has a validity period before the offer expires. As an example, a BOGO offer might be valid for only 5 days. You'll see in the data set that informational offers have a validity period even though these ads are merely providing information about a product; for example, if an informational offer has 7 days of validity, you can assume the customer is feeling the influence of the offer for 7 days after receiving the advertisement.\n",
    "\n",
    "You'll be given transactional data showing user purchases made on the app including the timestamp of purchase and the amount of money spent on a purchase. This transactional data also has a record for each offer that a user receives as well as a record for when a user actually views the offer. There are also records for when a user completes an offer. \n",
    "\n",
    "Keep in mind as well that someone using the app might make a purchase through the app without having received an offer or seen an offer.\n",
    "\n",
    "### Example\n",
    "\n",
    "To give an example, a user could receive a discount offer buy 10 dollars get 2 off on Monday. The offer is valid for 10 days from receipt. If the customer accumulates at least 10 dollars in purchases during the validity period, the customer completes the offer.\n",
    "\n",
    "However, there are a few things to watch out for in this data set. Customers do not opt into the offers that they receive; in other words, a user can receive an offer, never actually view the offer, and still complete the offer. For example, a user might receive the \"buy 10 dollars get 2 dollars off offer\", but the user never opens the offer during the 10 day validity period. The customer spends 15 dollars during those ten days. There will be an offer completion record in the data set; however, the customer was not influenced by the offer because the customer never viewed the offer.\n",
    "\n",
    "### Cleaning\n",
    "\n",
    "This makes data cleaning especially important and tricky.\n",
    "\n",
    "You'll also want to take into account that some demographic groups will make purchases even if they don't receive an offer. From a business perspective, if a customer is going to make a 10 dollar purchase without an offer anyway, you wouldn't want to send a buy 10 dollars get 2 dollars off offer. You'll want to try to assess what a certain demographic group will buy when not receiving any offers.\n",
    "\n",
    "### Final Advice\n",
    "\n",
    "Because this is a capstone project, you are free to analyze the data any way you see fit. For example, you could build a machine learning model that predicts how much someone will spend based on demographics and offer type. Or you could build a model that predicts whether or not someone will respond to an offer. Or, you don't need to build a machine learning model at all. You could develop a set of heuristics that determine what offer you should send to each customer (i.e., 75 percent of women customers who were 35 years old responded to offer A vs 40 percent from the same demographic to offer B, so send offer A)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Data Sets\n",
    "\n",
    "The data is contained in three files:\n",
    "\n",
    "* portfolio.json - containing offer ids and meta data about each offer (duration, type, etc.)\n",
    "* profile.json - demographic data for each customer\n",
    "* transcript.json - records for transactions, offers received, offers viewed, and offers completed\n",
    "\n",
    "Here is the schema and explanation of each variable in the files:\n",
    "\n",
    "**portfolio.json**\n",
    "* id (string) - offer id\n",
    "* offer_type (string) - type of offer ie BOGO, discount, informational\n",
    "* difficulty (int) - minimum required spend to complete an offer\n",
    "* reward (int) - reward given for completing an offer\n",
    "* duration (int) - time for offer to be open, in days\n",
    "* channels (list of strings)\n",
    "\n",
    "**profile.json**\n",
    "* age (int) - age of the customer \n",
    "* became_member_on (int) - date when customer created an app account\n",
    "* gender (str) - gender of the customer (note some entries contain 'O' for other rather than M or F)\n",
    "* id (str) - customer id\n",
    "* income (float) - customer's income\n",
    "\n",
    "**transcript.json**\n",
    "* event (str) - record description (ie transaction, offer received, offer viewed, etc.)\n",
    "* person (str) - customer id\n",
    "* time (int) - time in hours since start of test. The data begins at time t=0\n",
    "* value - (dict of strings) - either an offer id or transaction amount depending on the record\n",
    "\n",
    "**Note:** If you are using the workspace, you will need to go to the terminal and run the command `conda update pandas` before reading in the files. This is because the version of pandas in the workspace cannot read in the transcript.json file correctly, but the newest version of pandas can. You can access the termnal from the orange icon in the top left of this notebook.  \n",
    "\n",
    "You can see how to access the terminal and how the install works using the two images below.  First you need to access the terminal:\n",
    "\n",
    "<img src=\"pic1.png\"/>\n",
    "\n",
    "Then you will want to run the above command:\n",
    "\n",
    "<img src=\"pic2.png\"/>\n",
    "\n",
    "Finally, when you enter back into the notebook (use the jupyter icon again), you should be able to run the below cell without any errors."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import math\n",
    "import json\n",
    "%matplotlib inline\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')\n",
    "\n",
    "# read in the json files\n",
    "portfolio = pd.read_json('data/portfolio.json', orient='records', lines=True)\n",
    "profile = pd.read_json('data/profile.json', orient='records', lines=True)\n",
    "transcript = pd.read_json('data/transcript.json', orient='records', lines=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 175,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>person</th>\n",
       "      <th>event</th>\n",
       "      <th>value</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>78afa995795e4d85b5d9ceeca43f5fef</td>\n",
       "      <td>offer received</td>\n",
       "      <td>{'offer id': '9b98b8c7a33c4b65b9aebfe6a799e6d9'}</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>a03223e636434f42ac4c3df47e8bac43</td>\n",
       "      <td>offer received</td>\n",
       "      <td>{'offer id': '0b1e1539f2cc45b7b9fa7c272da2e1d7'}</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>e2127556f4f64592b11af22de27a7932</td>\n",
       "      <td>offer received</td>\n",
       "      <td>{'offer id': '2906b810c7d4411798c6938adc9daaa5'}</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>8ec6ce2a7e7949b1bf142def7d0e0586</td>\n",
       "      <td>offer received</td>\n",
       "      <td>{'offer id': 'fafdcd668e3743c1bb461111dcafc2a4'}</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>68617ca6246f4fbc85e91a2a49552598</td>\n",
       "      <td>offer received</td>\n",
       "      <td>{'offer id': '4d5c57ea9a6940dd891ad53e9dbe8da0'}</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                             person           event  \\\n",
       "0  78afa995795e4d85b5d9ceeca43f5fef  offer received   \n",
       "1  a03223e636434f42ac4c3df47e8bac43  offer received   \n",
       "2  e2127556f4f64592b11af22de27a7932  offer received   \n",
       "3  8ec6ce2a7e7949b1bf142def7d0e0586  offer received   \n",
       "4  68617ca6246f4fbc85e91a2a49552598  offer received   \n",
       "\n",
       "                                              value  time  \n",
       "0  {'offer id': '9b98b8c7a33c4b65b9aebfe6a799e6d9'}     0  \n",
       "1  {'offer id': '0b1e1539f2cc45b7b9fa7c272da2e1d7'}     0  \n",
       "2  {'offer id': '2906b810c7d4411798c6938adc9daaa5'}     0  \n",
       "3  {'offer id': 'fafdcd668e3743c1bb461111dcafc2a4'}     0  \n",
       "4  {'offer id': '4d5c57ea9a6940dd891ad53e9dbe8da0'}     0  "
      ]
     },
     "execution_count": 175,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transcript.head(5)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>person</th>\n",
       "      <th>event</th>\n",
       "      <th>value</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>306529</th>\n",
       "      <td>b3a1272bc9904337b331bf348c3e8c17</td>\n",
       "      <td>transaction</td>\n",
       "      <td>{'amount': 1.5899999999999999}</td>\n",
       "      <td>714</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306530</th>\n",
       "      <td>68213b08d99a4ae1b0dcb72aebd9aa35</td>\n",
       "      <td>transaction</td>\n",
       "      <td>{'amount': 9.53}</td>\n",
       "      <td>714</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306531</th>\n",
       "      <td>a00058cf10334a308c68e7631c529907</td>\n",
       "      <td>transaction</td>\n",
       "      <td>{'amount': 3.61}</td>\n",
       "      <td>714</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306532</th>\n",
       "      <td>76ddbd6576844afe811f1a3c0fbb5bec</td>\n",
       "      <td>transaction</td>\n",
       "      <td>{'amount': 3.5300000000000002}</td>\n",
       "      <td>714</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306533</th>\n",
       "      <td>c02b10e8752c4d8e9b73f918558531f7</td>\n",
       "      <td>transaction</td>\n",
       "      <td>{'amount': 4.05}</td>\n",
       "      <td>714</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  person        event  \\\n",
       "306529  b3a1272bc9904337b331bf348c3e8c17  transaction   \n",
       "306530  68213b08d99a4ae1b0dcb72aebd9aa35  transaction   \n",
       "306531  a00058cf10334a308c68e7631c529907  transaction   \n",
       "306532  76ddbd6576844afe811f1a3c0fbb5bec  transaction   \n",
       "306533  c02b10e8752c4d8e9b73f918558531f7  transaction   \n",
       "\n",
       "                                 value  time  \n",
       "306529  {'amount': 1.5899999999999999}   714  \n",
       "306530                {'amount': 9.53}   714  \n",
       "306531                {'amount': 3.61}   714  \n",
       "306532  {'amount': 3.5300000000000002}   714  \n",
       "306533                {'amount': 4.05}   714  "
      ]
     },
     "execution_count": 176,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transcript.tail(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 177,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>id</th>\n",
       "      <th>became_member_on</th>\n",
       "      <th>income</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>68be06ca386d4c31939f3a4f0e3dd783</td>\n",
       "      <td>20170212</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>F</td>\n",
       "      <td>55</td>\n",
       "      <td>0610b486422d4921ae7d2bf64640c50b</td>\n",
       "      <td>20170715</td>\n",
       "      <td>112000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>38fe809add3b4fcf9315a9694bb96ff5</td>\n",
       "      <td>20180712</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>F</td>\n",
       "      <td>75</td>\n",
       "      <td>78afa995795e4d85b5d9ceeca43f5fef</td>\n",
       "      <td>20170509</td>\n",
       "      <td>100000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>a03223e636434f42ac4c3df47e8bac43</td>\n",
       "      <td>20170804</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  gender  age                                id  became_member_on    income\n",
       "0   None  118  68be06ca386d4c31939f3a4f0e3dd783          20170212       NaN\n",
       "1      F   55  0610b486422d4921ae7d2bf64640c50b          20170715  112000.0\n",
       "2   None  118  38fe809add3b4fcf9315a9694bb96ff5          20180712       NaN\n",
       "3      F   75  78afa995795e4d85b5d9ceeca43f5fef          20170509  100000.0\n",
       "4   None  118  a03223e636434f42ac4c3df47e8bac43          20170804       NaN"
      ]
     },
     "execution_count": 177,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>reward</th>\n",
       "      <th>channels</th>\n",
       "      <th>difficulty</th>\n",
       "      <th>duration</th>\n",
       "      <th>offer_type</th>\n",
       "      <th>id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10</td>\n",
       "      <td>[email, mobile, social]</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>bogo</td>\n",
       "      <td>ae264e3637204a6fb9bb56bc8210ddfd</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10</td>\n",
       "      <td>[web, email, mobile, social]</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>bogo</td>\n",
       "      <td>4d5c57ea9a6940dd891ad53e9dbe8da0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>[web, email, mobile]</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>informational</td>\n",
       "      <td>3f207df678b143eea3cee63160fa8bed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>5</td>\n",
       "      <td>[web, email, mobile]</td>\n",
       "      <td>5</td>\n",
       "      <td>7</td>\n",
       "      <td>bogo</td>\n",
       "      <td>9b98b8c7a33c4b65b9aebfe6a799e6d9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>[web, email]</td>\n",
       "      <td>20</td>\n",
       "      <td>10</td>\n",
       "      <td>discount</td>\n",
       "      <td>0b1e1539f2cc45b7b9fa7c272da2e1d7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   reward                      channels  difficulty  duration     offer_type  \\\n",
       "0      10       [email, mobile, social]          10         7           bogo   \n",
       "1      10  [web, email, mobile, social]          10         5           bogo   \n",
       "2       0          [web, email, mobile]           0         4  informational   \n",
       "3       5          [web, email, mobile]           5         7           bogo   \n",
       "4       5                  [web, email]          20        10       discount   \n",
       "\n",
       "                                 id  \n",
       "0  ae264e3637204a6fb9bb56bc8210ddfd  \n",
       "1  4d5c57ea9a6940dd891ad53e9dbe8da0  \n",
       "2  3f207df678b143eea3cee63160fa8bed  \n",
       "3  9b98b8c7a33c4b65b9aebfe6a799e6d9  \n",
       "4  0b1e1539f2cc45b7b9fa7c272da2e1d7  "
      ]
     },
     "execution_count": 178,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data Cleaning"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Customer ID column is given different name in these sets renaming them to maintain consistency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 179,
   "metadata": {},
   "outputs": [],
   "source": [
    "portfolio.rename({'id': 'offer_id'}, axis = 1, inplace = True)\n",
    "transcript.rename({'person': 'customer_id'}, axis = 1, inplace = True)\n",
    "profile.rename({'id': 'customer_id'}, axis = 1, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "unhashable type: 'list'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi\u001b[0m in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.map_locations\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mTypeError\u001b[0m: unhashable type: 'list'"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Exception ignored in: 'pandas._libs.index.IndexEngine._call_map_locations'\n",
      "Traceback (most recent call last):\n",
      "  File \"pandas\\_libs\\hashtable_class_helper.pxi\", line 5231, in pandas._libs.hashtable.PyObjectHashTable.map_locations\n",
      "TypeError: unhashable type: 'list'\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[web, email, mobile, social]    4\n",
       "[web, email, mobile]            3\n",
       "[email, mobile, social]         2\n",
       "[web, email]                    1\n",
       "Name: channels, dtype: int64"
      ]
     },
     "execution_count": 180,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio[\"channels\"].value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The offer can be notified to the customer in four different channels.Creating dummy variables for respective channels."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "So there are totaly 10 offers, 4 Buy One Get One,4 discount and 2 informational offers."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Creating dummy variables for channels\n",
    "portfolio['email'] = portfolio['channels'].apply(lambda x: 1 if 'email' in x else 0)\n",
    "portfolio['mobile'] = portfolio['channels'].apply(lambda x: 1 if 'mobile' in x else 0)\n",
    "portfolio['social'] = portfolio['channels'].apply(lambda x: 1 if 'social'in x else 0)\n",
    "portfolio['web'] = portfolio['channels'].apply(lambda x: 1 if 'web' in x else 0)\n",
    "#we dont need channels anymore\n",
    "portfolio.drop(\"channels\",inplace=True,axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 182,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "bogo             4\n",
       "discount         4\n",
       "informational    2\n",
       "Name: offer_type, dtype: int64"
      ]
     },
     "execution_count": 182,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio[\"offer_type\"].value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "So there are totaly 10 offers, 4 Buy One Get One,4 discount and 2 informational offers."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Creating dummy variables for offer_type\n",
    "portfolio[\"bogo\"]=portfolio[\"offer_type\"].apply(lambda x: 1 if \"bogo\" in x else 0)\n",
    "portfolio[\"informational\"]=portfolio[\"offer_type\"].apply(lambda x: 1 if \"informational\" in x else 0)\n",
    "portfolio[\"discount\"]=portfolio[\"offer_type\"].apply(lambda x: 1 if \"discount\" in x else 0)\n",
    "portfolio.drop(\"offer_type\",inplace=True,axis=1)                                                      "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 184,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "transaction        138953\n",
       "offer received      76277\n",
       "offer viewed        57725\n",
       "offer completed     33579\n",
       "Name: event, dtype: int64"
      ]
     },
     "execution_count": 184,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transcript['event'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_received = transcript[transcript['event'] == 'offer received']\n",
    "offer_viewed =transcript[transcript['event'] == 'offer viewed']\n",
    "offer_completed  =transcript[transcript['event'] == 'offer completed']\n",
    "transaction =transcript[transcript['event'] == 'transaction']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Created seperate Dataframes to find the combination of values present in event column."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "unhashable type: 'dict'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi\u001b[0m in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.map_locations\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mTypeError\u001b[0m: unhashable type: 'dict'"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Exception ignored in: 'pandas._libs.index.IndexEngine._call_map_locations'\n",
      "Traceback (most recent call last):\n",
      "  File \"pandas\\_libs\\hashtable_class_helper.pxi\", line 5231, in pandas._libs.hashtable.PyObjectHashTable.map_locations\n",
      "TypeError: unhashable type: 'dict'\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{'offer id': '9b98b8c7a33c4b65b9aebfe6a799e6d9'}    7677\n",
       "{'offer id': '0b1e1539f2cc45b7b9fa7c272da2e1d7'}    7668\n",
       "{'offer id': 'ae264e3637204a6fb9bb56bc8210ddfd'}    7658\n",
       "{'offer id': '2298d6c36e964ae4a3e7e9706d1fb8c2'}    7646\n",
       "{'offer id': '2906b810c7d4411798c6938adc9daaa5'}    7632\n",
       "{'offer id': '5a8bc65990b245e5a138643cd4eb9837'}    7618\n",
       "{'offer id': '3f207df678b143eea3cee63160fa8bed'}    7617\n",
       "{'offer id': 'fafdcd668e3743c1bb461111dcafc2a4'}    7597\n",
       "{'offer id': '4d5c57ea9a6940dd891ad53e9dbe8da0'}    7593\n",
       "{'offer id': 'f19421c1d4aa40978ebb69ca19b0e20d'}    7571\n",
       "Name: value, dtype: int64"
      ]
     },
     "execution_count": 186,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_received['value'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "unhashable type: 'dict'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi\u001b[0m in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.map_locations\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mTypeError\u001b[0m: unhashable type: 'dict'"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Exception ignored in: 'pandas._libs.index.IndexEngine._call_map_locations'\n",
      "Traceback (most recent call last):\n",
      "  File \"pandas\\_libs\\hashtable_class_helper.pxi\", line 5231, in pandas._libs.hashtable.PyObjectHashTable.map_locations\n",
      "TypeError: unhashable type: 'dict'\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{'offer id': '2298d6c36e964ae4a3e7e9706d1fb8c2'}    7337\n",
       "{'offer id': 'fafdcd668e3743c1bb461111dcafc2a4'}    7327\n",
       "{'offer id': '4d5c57ea9a6940dd891ad53e9dbe8da0'}    7298\n",
       "{'offer id': 'f19421c1d4aa40978ebb69ca19b0e20d'}    7264\n",
       "{'offer id': 'ae264e3637204a6fb9bb56bc8210ddfd'}    6716\n",
       "{'offer id': '5a8bc65990b245e5a138643cd4eb9837'}    6687\n",
       "{'offer id': '9b98b8c7a33c4b65b9aebfe6a799e6d9'}    4171\n",
       "{'offer id': '3f207df678b143eea3cee63160fa8bed'}    4144\n",
       "{'offer id': '2906b810c7d4411798c6938adc9daaa5'}    4118\n",
       "{'offer id': '0b1e1539f2cc45b7b9fa7c272da2e1d7'}    2663\n",
       "Name: value, dtype: int64"
      ]
     },
     "execution_count": 187,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_viewed['value'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "unhashable type: 'dict'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi\u001b[0m in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.map_locations\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mTypeError\u001b[0m: unhashable type: 'dict'"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Exception ignored in: 'pandas._libs.index.IndexEngine._call_map_locations'\n",
      "Traceback (most recent call last):\n",
      "  File \"pandas\\_libs\\hashtable_class_helper.pxi\", line 5231, in pandas._libs.hashtable.PyObjectHashTable.map_locations\n",
      "TypeError: unhashable type: 'dict'\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{'offer_id': 'fafdcd668e3743c1bb461111dcafc2a4', 'reward': 2}     5317\n",
       "{'offer_id': '2298d6c36e964ae4a3e7e9706d1fb8c2', 'reward': 3}     5156\n",
       "{'offer_id': '9b98b8c7a33c4b65b9aebfe6a799e6d9', 'reward': 5}     4354\n",
       "{'offer_id': 'f19421c1d4aa40978ebb69ca19b0e20d', 'reward': 5}     4296\n",
       "{'offer_id': '2906b810c7d4411798c6938adc9daaa5', 'reward': 2}     4017\n",
       "{'offer_id': 'ae264e3637204a6fb9bb56bc8210ddfd', 'reward': 10}    3688\n",
       "{'offer_id': '0b1e1539f2cc45b7b9fa7c272da2e1d7', 'reward': 5}     3420\n",
       "{'offer_id': '4d5c57ea9a6940dd891ad53e9dbe8da0', 'reward': 10}    3331\n",
       "Name: value, dtype: int64"
      ]
     },
     "execution_count": 188,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_completed['value'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 189,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "unhashable type: 'dict'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi\u001b[0m in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.map_locations\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mTypeError\u001b[0m: unhashable type: 'dict'"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Exception ignored in: 'pandas._libs.index.IndexEngine._call_map_locations'\n",
      "Traceback (most recent call last):\n",
      "  File \"pandas\\_libs\\hashtable_class_helper.pxi\", line 5231, in pandas._libs.hashtable.PyObjectHashTable.map_locations\n",
      "TypeError: unhashable type: 'dict'\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{'amount': 0.05}      431\n",
       "{'amount': 0.66}      166\n",
       "{'amount': 1.18}      165\n",
       "{'amount': 1.01}      163\n",
       "{'amount': 1.23}      161\n",
       "                     ... \n",
       "{'amount': 42.31}       1\n",
       "{'amount': 44.62}       1\n",
       "{'amount': 42.27}       1\n",
       "{'amount': 108.89}      1\n",
       "{'amount': 476.33}      1\n",
       "Name: value, Length: 5103, dtype: int64"
      ]
     },
     "execution_count": 189,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transaction['value'].value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "There are four different values in the 'event' column, and correspondingly, there are four different inputs in the 'value' column\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![event_n_value](img/event_n_value.png)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "metadata": {},
   "outputs": [],
   "source": [
    "def offer_mapper(data):\n",
    "    \"\"\"\n",
    "    Returns offer id value from the dict\n",
    "    Args:\n",
    "    data:  a dict that contains alpha-numeric id as key and two possible spellings of the key \n",
    "    Return: \n",
    "    data['offer_id']/data['offerid']: clean offer id from the dict\n",
    "    \"\"\"\n",
    "    \n",
    "    if 'offer id' in data:\n",
    "        return data['offer id']\n",
    "    elif 'offer_id' in data:\n",
    "        return data['offer_id']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "metadata": {},
   "outputs": [],
   "source": [
    "def id_mapper(df,column_name):\n",
    "    \"\"\"\n",
    "    Returns dict with clean numbers as values and alpha-numeric ids as keys when df and column name are specified\n",
    "    Args:\n",
    "    df:  a dataframe \n",
    "    column_name: name of the column with alpha-numeric id\n",
    "    Return: \n",
    "    dict: dict with clean numbers as values and alpha-numeric ids as keys\n",
    "    \"\"\"\n",
    "    dict_=dict()\n",
    "    index=1\n",
    "    \n",
    "    for val in df[column_name]:\n",
    "        if val not in dict_:\n",
    "            dict_[val]=index\n",
    "            index=index+1\n",
    "    \n",
    "    return dict_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "metadata": {},
   "outputs": [],
   "source": [
    "ids_dict=id_mapper(profile,'customer_id')\n",
    "offer_ids_dict=id_mapper(portfolio,'offer_id')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 193,
   "metadata": {},
   "outputs": [],
   "source": [
    "def reward_mapper(data):\n",
    "    \"\"\"\n",
    "    Returns reward value from the dict if reward is present in the dict\n",
    "    Args:\n",
    "    data:  a dict that contains alpha-numeric id as key for offer id and reward as another key\n",
    "    Return: \n",
    "    data['reward']: reward value or 0 if reward is not present in the data\n",
    "    \"\"\"\n",
    "    \n",
    "    if 'reward' in data:\n",
    "        #print(\"{} is being returned for {}\".format(data['reward'],data))\n",
    "        return data['reward']\n",
    "    else:\n",
    "        return 0"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Splitting the ‘transcript’ into ‘offer_activity’ and ‘transactions’ dataframes. ‘Offer_activity’ contains all the information about receive, view and complete events, while ‘transactions’ will include only information about customer transactions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 194,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_activity = transcript[transcript['event'] != 'transaction' ]\n",
    "transactions = transcript[transcript['event'] == 'transaction' ]\n",
    "offer_dict = id_mapper(portfolio, 'offer_id')\n",
    "# map offer activity with set IDs and reward amounts\n",
    "offer_activity.loc[:, 'offer_id'] = offer_activity['value'].apply(offer_mapper)\n",
    "offer_activity.loc[:, 'reward'] = offer_activity['value'].apply(reward_mapper)\n",
    "offer_activity.loc[:, 'offer_id'] = offer_activity['offer_id'].map(offer_dict)\n",
    "offer_activity['customer_id']=offer_activity['customer_id'].map(ids_dict)\n",
    "offer_activity.drop('value',axis=1,inplace=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 195,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>event</th>\n",
       "      <th>time</th>\n",
       "      <th>offer_id</th>\n",
       "      <th>reward</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>5</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>7</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>8</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   customer_id           event  time  offer_id  reward\n",
       "0            4  offer received     0         4       0\n",
       "1            5  offer received     0         5       0\n",
       "2            6  offer received     0        10       0\n",
       "3            7  offer received     0         7       0\n",
       "4            8  offer received     0         2       0"
      ]
     },
     "execution_count": 195,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 196,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>event</th>\n",
       "      <th>time</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12654</th>\n",
       "      <td>42</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>0.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12657</th>\n",
       "      <td>56</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>34.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12659</th>\n",
       "      <td>64</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>13.23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12670</th>\n",
       "      <td>135</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>19.51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12671</th>\n",
       "      <td>152</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>18.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306529</th>\n",
       "      <td>16960</td>\n",
       "      <td>transaction</td>\n",
       "      <td>714</td>\n",
       "      <td>1.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306530</th>\n",
       "      <td>16965</td>\n",
       "      <td>transaction</td>\n",
       "      <td>714</td>\n",
       "      <td>9.53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306531</th>\n",
       "      <td>16980</td>\n",
       "      <td>transaction</td>\n",
       "      <td>714</td>\n",
       "      <td>3.61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306532</th>\n",
       "      <td>16988</td>\n",
       "      <td>transaction</td>\n",
       "      <td>714</td>\n",
       "      <td>3.53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306533</th>\n",
       "      <td>16995</td>\n",
       "      <td>transaction</td>\n",
       "      <td>714</td>\n",
       "      <td>4.05</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>138953 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        customer_id        event  time  amount\n",
       "12654            42  transaction     0    0.83\n",
       "12657            56  transaction     0   34.56\n",
       "12659            64  transaction     0   13.23\n",
       "12670           135  transaction     0   19.51\n",
       "12671           152  transaction     0   18.97\n",
       "...             ...          ...   ...     ...\n",
       "306529        16960  transaction   714    1.59\n",
       "306530        16965  transaction   714    9.53\n",
       "306531        16980  transaction   714    3.61\n",
       "306532        16988  transaction   714    3.53\n",
       "306533        16995  transaction   714    4.05\n",
       "\n",
       "[138953 rows x 4 columns]"
      ]
     },
     "execution_count": 196,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transactions['customer_id']=transactions['customer_id'].map(ids_dict)\n",
    "transactions['amount'] = transactions['value'].apply(lambda x: x['amount'])\n",
    "transactions.drop('value', inplace = True, axis = 1)\n",
    "transactions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 197,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>event</th>\n",
       "      <th>time</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12654</th>\n",
       "      <td>42</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>0.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12657</th>\n",
       "      <td>56</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>34.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12659</th>\n",
       "      <td>64</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>13.23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12670</th>\n",
       "      <td>135</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>19.51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12671</th>\n",
       "      <td>152</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>18.97</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       customer_id        event  time  amount\n",
       "12654           42  transaction     0    0.83\n",
       "12657           56  transaction     0   34.56\n",
       "12659           64  transaction     0   13.23\n",
       "12670          135  transaction     0   19.51\n",
       "12671          152  transaction     0   18.97"
      ]
     },
     "execution_count": 197,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transactions.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 198,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>reward</th>\n",
       "      <th>difficulty</th>\n",
       "      <th>duration</th>\n",
       "      <th>offer_id</th>\n",
       "      <th>email</th>\n",
       "      <th>mobile</th>\n",
       "      <th>social</th>\n",
       "      <th>web</th>\n",
       "      <th>bogo</th>\n",
       "      <th>informational</th>\n",
       "      <th>discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>120</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>96</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>168</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>20</td>\n",
       "      <td>240</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>168</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>240</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>72</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>120</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   reward  difficulty  duration  offer_id  email  mobile  social  web  bogo  \\\n",
       "0      10          10       168         1      1       1       1    0     1   \n",
       "1      10          10       120         2      1       1       1    1     1   \n",
       "2       0           0        96         3      1       1       0    1     0   \n",
       "3       5           5       168         4      1       1       0    1     1   \n",
       "4       5          20       240         5      1       0       0    1     0   \n",
       "5       3           7       168         6      1       1       1    1     0   \n",
       "6       2          10       240         7      1       1       1    1     0   \n",
       "7       0           0        72         8      1       1       1    0     0   \n",
       "8       5           5       120         9      1       1       1    1     1   \n",
       "9       2          10       168        10      1       1       0    1     0   \n",
       "\n",
       "   informational  discount  \n",
       "0              0         0  \n",
       "1              0         0  \n",
       "2              1         0  \n",
       "3              0         0  \n",
       "4              0         1  \n",
       "5              0         1  \n",
       "6              0         1  \n",
       "7              1         0  \n",
       "8              0         0  \n",
       "9              0         1  "
      ]
     },
     "execution_count": 198,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio['offer_id']=portfolio['offer_id'].map(offer_ids_dict)\n",
    "#duration (int) in portfolio - time for offer to be open, in days and time (int) in transcript- time in hours since start of test.\n",
    "#converting duration(int) to hours to be on the same page\n",
    "portfolio['duration']=portfolio['duration'].apply(lambda x:x*24)\n",
    "portfolio"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 199,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>reward</th>\n",
       "      <th>difficulty</th>\n",
       "      <th>duration</th>\n",
       "      <th>offer_id</th>\n",
       "      <th>email</th>\n",
       "      <th>mobile</th>\n",
       "      <th>social</th>\n",
       "      <th>web</th>\n",
       "      <th>bogo</th>\n",
       "      <th>informational</th>\n",
       "      <th>discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>120</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>96</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>168</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>20</td>\n",
       "      <td>240</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   reward  difficulty  duration  offer_id  email  mobile  social  web  bogo  \\\n",
       "0      10          10       168         1      1       1       1    0     1   \n",
       "1      10          10       120         2      1       1       1    1     1   \n",
       "2       0           0        96         3      1       1       0    1     0   \n",
       "3       5           5       168         4      1       1       0    1     1   \n",
       "4       5          20       240         5      1       0       0    1     0   \n",
       "\n",
       "   informational  discount  \n",
       "0              0         0  \n",
       "1              0         0  \n",
       "2              1         0  \n",
       "3              0         0  \n",
       "4              0         1  "
      ]
     },
     "execution_count": 199,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 200,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>customer_id</th>\n",
       "      <th>became_member_on</th>\n",
       "      <th>income</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>1</td>\n",
       "      <td>20170212</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>F</td>\n",
       "      <td>55</td>\n",
       "      <td>2</td>\n",
       "      <td>20170715</td>\n",
       "      <td>112000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>3</td>\n",
       "      <td>20180712</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>F</td>\n",
       "      <td>75</td>\n",
       "      <td>4</td>\n",
       "      <td>20170509</td>\n",
       "      <td>100000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>5</td>\n",
       "      <td>20170804</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16995</th>\n",
       "      <td>F</td>\n",
       "      <td>45</td>\n",
       "      <td>16996</td>\n",
       "      <td>20180604</td>\n",
       "      <td>54000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16996</th>\n",
       "      <td>M</td>\n",
       "      <td>61</td>\n",
       "      <td>16997</td>\n",
       "      <td>20180713</td>\n",
       "      <td>72000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16997</th>\n",
       "      <td>M</td>\n",
       "      <td>49</td>\n",
       "      <td>16998</td>\n",
       "      <td>20170126</td>\n",
       "      <td>73000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16998</th>\n",
       "      <td>F</td>\n",
       "      <td>83</td>\n",
       "      <td>16999</td>\n",
       "      <td>20160307</td>\n",
       "      <td>50000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16999</th>\n",
       "      <td>F</td>\n",
       "      <td>62</td>\n",
       "      <td>17000</td>\n",
       "      <td>20170722</td>\n",
       "      <td>82000.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>17000 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      gender  age  customer_id  became_member_on    income\n",
       "0       None  118            1          20170212       NaN\n",
       "1          F   55            2          20170715  112000.0\n",
       "2       None  118            3          20180712       NaN\n",
       "3          F   75            4          20170509  100000.0\n",
       "4       None  118            5          20170804       NaN\n",
       "...      ...  ...          ...               ...       ...\n",
       "16995      F   45        16996          20180604   54000.0\n",
       "16996      M   61        16997          20180713   72000.0\n",
       "16997      M   49        16998          20170126   73000.0\n",
       "16998      F   83        16999          20160307   50000.0\n",
       "16999      F   62        17000          20170722   82000.0\n",
       "\n",
       "[17000 rows x 5 columns]"
      ]
     },
     "execution_count": 200,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile['customer_id']=profile['customer_id'].map(ids_dict)\n",
    "profile"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 201,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>customer_id</th>\n",
       "      <th>became_member_on</th>\n",
       "      <th>income</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>1</td>\n",
       "      <td>20170212</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>F</td>\n",
       "      <td>55</td>\n",
       "      <td>2</td>\n",
       "      <td>20170715</td>\n",
       "      <td>112000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>3</td>\n",
       "      <td>20180712</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>F</td>\n",
       "      <td>75</td>\n",
       "      <td>4</td>\n",
       "      <td>20170509</td>\n",
       "      <td>100000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>5</td>\n",
       "      <td>20170804</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  gender  age  customer_id  became_member_on    income\n",
       "0   None  118            1          20170212       NaN\n",
       "1      F   55            2          20170715  112000.0\n",
       "2   None  118            3          20180712       NaN\n",
       "3      F   75            4          20170509  100000.0\n",
       "4   None  118            5          20170804       NaN"
      ]
     },
     "execution_count": 201,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 202,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Extracting customer id's and offer id's for future use\n",
    "customer_ids=list(x for x in ids_dict.values())\n",
    "offer_ids=list(x for x in offer_ids_dict.values())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Exploratory Data Analysis"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Profile"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 203,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "17000"
      ]
     },
     "execution_count": 203,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 204,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['gender', 'age', 'customer_id', 'became_member_on', 'income'], dtype='object')"
      ]
     },
     "execution_count": 204,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 205,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "M    8484\n",
       "F    6129\n",
       "O     212\n",
       "Name: gender, dtype: int64"
      ]
     },
     "execution_count": 205,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile['gender'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 206,
   "metadata": {},
   "outputs": [],
   "source": [
    "profile['became_member_on'] = pd.to_datetime(profile['became_member_on'], format = '%Y%m%d')\n",
    "profile['year_joined'] = profile['became_member_on'].dt.year\n",
    "profile.drop('became_member_on',axis=1,inplace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Starbucks was founded by Jerry Baldwin, Gordon Bowker, and Zev Siegl, opening its first store in 1971.So 'Year joined' Column cannot have a value less than 1971"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 207,
   "metadata": {},
   "outputs": [],
   "source": [
    "import datetime\n",
    "profile['year_joined']=profile['year_joined'].apply(lambda x:None if x<1971 else x)\n",
    "profile['year_joined']=profile['year_joined'].apply(lambda x:None if x>datetime.datetime.now().year else x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 208,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "gender         2175\n",
       "age               0\n",
       "customer_id       0\n",
       "income         2175\n",
       "year_joined       0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 208,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 209,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>customer_id</th>\n",
       "      <th>income</th>\n",
       "      <th>year_joined</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16980</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16981</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16982</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16983</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16989</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16990</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16991</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16992</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16994</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16995</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2175 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      gender  age  customer_id  income  year_joined\n",
       "0       None  118            1     NaN         2017\n",
       "2       None  118            3     NaN         2018\n",
       "4       None  118            5     NaN         2017\n",
       "6       None  118            7     NaN         2017\n",
       "7       None  118            8     NaN         2017\n",
       "...      ...  ...          ...     ...          ...\n",
       "16980   None  118        16981     NaN         2016\n",
       "16982   None  118        16983     NaN         2016\n",
       "16989   None  118        16990     NaN         2018\n",
       "16991   None  118        16992     NaN         2016\n",
       "16994   None  118        16995     NaN         2015\n",
       "\n",
       "[2175 rows x 5 columns]"
      ]
     },
     "execution_count": 209,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile[profile['gender'].isna()]\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "2175 entires have missing values in gender and it also looks like for every NaN value of gender there is a NaN value in income and the age is 118."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 210,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age</th>\n",
       "      <th>customer_id</th>\n",
       "      <th>income</th>\n",
       "      <th>year_joined</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16980</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16981</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16982</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16983</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16989</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16990</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16991</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16992</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16994</th>\n",
       "      <td>None</td>\n",
       "      <td>118</td>\n",
       "      <td>16995</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2175 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      gender  age  customer_id  income  year_joined\n",
       "0       None  118            1     NaN         2017\n",
       "2       None  118            3     NaN         2018\n",
       "4       None  118            5     NaN         2017\n",
       "6       None  118            7     NaN         2017\n",
       "7       None  118            8     NaN         2017\n",
       "...      ...  ...          ...     ...          ...\n",
       "16980   None  118        16981     NaN         2016\n",
       "16982   None  118        16983     NaN         2016\n",
       "16989   None  118        16990     NaN         2018\n",
       "16991   None  118        16992     NaN         2016\n",
       "16994   None  118        16995     NaN         2015\n",
       "\n",
       "[2175 rows x 5 columns]"
      ]
     },
     "execution_count": 210,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile[(profile[['gender','income']].isnull().all(1)) & (profile['age']==118)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 211,
   "metadata": {},
   "outputs": [],
   "source": [
    "all_null_values_df=profile[profile['gender'].isna()]\n",
    "age_118_and_both_col_nullvalues=profile[(profile[['gender','income']].isnull().all(1)) & (profile['age']==118)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 212,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 212,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_null_values_df.equals(age_118_and_both_col_nullvalues)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "So there are 2175 rows with null values in both 'gender' and 'income' with age as 118.Its better to remove these rows instead of filling the NaN's with any of the filling methods."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 213,
   "metadata": {},
   "outputs": [],
   "source": [
    "profile.dropna(inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 214,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "54.39352445193929"
      ]
     },
     "execution_count": 214,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile['age'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 215,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "65404.9915682968"
      ]
     },
     "execution_count": 215,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile['income'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 216,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "120000.0\n",
      "30000.0\n"
     ]
    }
   ],
   "source": [
    "print(profile['income'].max())\n",
    "print(profile['income'].min())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Everything with income looks fine"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 217,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "gender         0\n",
       "age            0\n",
       "customer_id    0\n",
       "income         0\n",
       "year_joined    0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 217,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile.isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Customerd ID's that got dropped from profile should also be dropped from transactions dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 218,
   "metadata": {},
   "outputs": [],
   "source": [
    "customer_ids=profile['customer_id'].to_list()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 219,
   "metadata": {},
   "outputs": [],
   "source": [
    "profile=profile[['customer_id','age','gender','income','year_joined']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 220,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>income</th>\n",
       "      <th>year_joined</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>F</td>\n",
       "      <td>112000.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>100000.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>68</td>\n",
       "      <td>M</td>\n",
       "      <td>70000.0</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>65</td>\n",
       "      <td>M</td>\n",
       "      <td>53000.0</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>13</td>\n",
       "      <td>58</td>\n",
       "      <td>M</td>\n",
       "      <td>51000.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16995</th>\n",
       "      <td>16996</td>\n",
       "      <td>45</td>\n",
       "      <td>F</td>\n",
       "      <td>54000.0</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16996</th>\n",
       "      <td>16997</td>\n",
       "      <td>61</td>\n",
       "      <td>M</td>\n",
       "      <td>72000.0</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16997</th>\n",
       "      <td>16998</td>\n",
       "      <td>49</td>\n",
       "      <td>M</td>\n",
       "      <td>73000.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16998</th>\n",
       "      <td>16999</td>\n",
       "      <td>83</td>\n",
       "      <td>F</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16999</th>\n",
       "      <td>17000</td>\n",
       "      <td>62</td>\n",
       "      <td>F</td>\n",
       "      <td>82000.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14825 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       customer_id  age gender    income  year_joined\n",
       "1                2   55      F  112000.0         2017\n",
       "3                4   75      F  100000.0         2017\n",
       "5                6   68      M   70000.0         2018\n",
       "8                9   65      M   53000.0         2018\n",
       "12              13   58      M   51000.0         2017\n",
       "...            ...  ...    ...       ...          ...\n",
       "16995        16996   45      F   54000.0         2018\n",
       "16996        16997   61      M   72000.0         2018\n",
       "16997        16998   49      M   73000.0         2017\n",
       "16998        16999   83      F   50000.0         2016\n",
       "16999        17000   62      F   82000.0         2017\n",
       "\n",
       "[14825 rows x 5 columns]"
      ]
     },
     "execution_count": 220,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Portfolio"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 221,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['reward', 'difficulty', 'duration', 'offer_id', 'email', 'mobile',\n",
       "       'social', 'web', 'bogo', 'informational', 'discount'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 221,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 222,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The min reward for a offer is: 0\n",
      "The max reward for a offer is: 10\n",
      "The min difficulty for a offer is: 0\n",
      "The max difficulty for a offer is: 20\n",
      "The min duration for a offer in hours is: 72\n",
      "The max duration for a offer in hours is: 240\n"
     ]
    }
   ],
   "source": [
    "\n",
    "print(\"The min reward for a offer is:\",portfolio['reward'].min())\n",
    "print(\"The max reward for a offer is:\",portfolio['reward'].max())\n",
    "print(\"The min difficulty for a offer is:\",portfolio['difficulty'].min())\n",
    "print(\"The max difficulty for a offer is:\",portfolio['difficulty'].max())\n",
    "print(\"The min duration for a offer in hours is:\",portfolio['duration'].min())\n",
    "print(\"The max duration for a offer in hours is:\",portfolio['duration'].max())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "A offer cannot be BOGO,informational and discount at the same time.If the offer belongs to a particular category it cannot belong any other"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 223,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 223,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sum((portfolio[['bogo','informational','discount']].sum(axis=1)>1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 224,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "reward           0\n",
       "difficulty       0\n",
       "duration         0\n",
       "offer_id         0\n",
       "email            0\n",
       "mobile           0\n",
       "social           0\n",
       "web              0\n",
       "bogo             0\n",
       "informational    0\n",
       "discount         0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 224,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 225,
   "metadata": {},
   "outputs": [],
   "source": [
    "#rearranging columns\n",
    "portfolio=portfolio[['offer_id','reward', 'difficulty', 'duration','email', 'mobile',\n",
    "       'social', 'web', 'bogo', 'informational', 'discount']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 226,
   "metadata": {},
   "outputs": [],
   "source": [
    "portfolio.to_csv('data/portfolio_cleaned.csv',index=False,mode='w+')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Transcript"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Transcript got divide into two seperate dataframs 'offer_activity' with all the events related to offers and 'transactions' related to all the transactions done by the customers.\n",
    "#### offer_activity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 227,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "167581"
      ]
     },
     "execution_count": 227,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 228,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['customer_id', 'event', 'time', 'offer_id', 'reward'], dtype='object')"
      ]
     },
     "execution_count": 228,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 229,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_activity=offer_activity[offer_activity['customer_id'].isin(customer_ids)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 230,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "offer received     66501\n",
       "offer viewed       49860\n",
       "offer completed    32444\n",
       "Name: event, dtype: int64"
      ]
     },
     "execution_count": 230,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity['event'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 231,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The min time 0\n",
      "The max time 714\n",
      "The min reward 0\n",
      "The max time 10\n"
     ]
    }
   ],
   "source": [
    "print(\"The min time\",offer_activity['time'].min())\n",
    "print(\"The max time\",offer_activity['time'].max())\n",
    "print(\"The min reward\",offer_activity['reward'].min())\n",
    "print(\"The max time\",offer_activity['reward'].max())\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 232,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "customer_id    0\n",
       "event          0\n",
       "time           0\n",
       "offer_id       0\n",
       "reward         0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 232,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 233,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_activity=offer_activity[['customer_id','offer_id', 'event', 'time','reward']]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The zero value for min time implies the start of the test and min reward implies that it is just a informational offer"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### transactions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 234,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "138953"
      ]
     },
     "execution_count": 234,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transactions.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 235,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['customer_id', 'event', 'time', 'amount'], dtype='object')"
      ]
     },
     "execution_count": 235,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transactions.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 236,
   "metadata": {},
   "outputs": [],
   "source": [
    "transactions=transactions[transactions['customer_id'].isin(customer_ids)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 237,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "transaction    123957\n",
       "Name: event, dtype: int64"
      ]
     },
     "execution_count": 237,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transactions['event'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 238,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The min time 0\n",
      "The max time 714\n",
      "The min amount 0.05\n",
      "The max amount 1062.28\n"
     ]
    }
   ],
   "source": [
    "print(\"The min time\",transactions['time'].min())\n",
    "print(\"The max time\",transactions['time'].max())\n",
    "print(\"The min amount\",transactions['amount'].min())\n",
    "print(\"The max amount\",transactions['amount'].max())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 239,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "13.996324531893954"
      ]
     },
     "execution_count": 239,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transactions['amount'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 240,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>event</th>\n",
       "      <th>time</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12967</th>\n",
       "      <td>1899</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>0.05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15057</th>\n",
       "      <td>14320</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>0.05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15294</th>\n",
       "      <td>15604</td>\n",
       "      <td>transaction</td>\n",
       "      <td>0</td>\n",
       "      <td>0.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15765</th>\n",
       "      <td>1432</td>\n",
       "      <td>transaction</td>\n",
       "      <td>6</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16382</th>\n",
       "      <td>5656</td>\n",
       "      <td>transaction</td>\n",
       "      <td>6</td>\n",
       "      <td>0.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>304216</th>\n",
       "      <td>14935</td>\n",
       "      <td>transaction</td>\n",
       "      <td>702</td>\n",
       "      <td>0.05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>304514</th>\n",
       "      <td>2976</td>\n",
       "      <td>transaction</td>\n",
       "      <td>708</td>\n",
       "      <td>0.05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>305161</th>\n",
       "      <td>12960</td>\n",
       "      <td>transaction</td>\n",
       "      <td>708</td>\n",
       "      <td>0.05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>305938</th>\n",
       "      <td>7909</td>\n",
       "      <td>transaction</td>\n",
       "      <td>714</td>\n",
       "      <td>0.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306485</th>\n",
       "      <td>16492</td>\n",
       "      <td>transaction</td>\n",
       "      <td>714</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>307 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        customer_id        event  time  amount\n",
       "12967          1899  transaction     0    0.05\n",
       "15057         14320  transaction     0    0.05\n",
       "15294         15604  transaction     0    0.08\n",
       "15765          1432  transaction     6    0.07\n",
       "16382          5656  transaction     6    0.08\n",
       "...             ...          ...   ...     ...\n",
       "304216        14935  transaction   702    0.05\n",
       "304514         2976  transaction   708    0.05\n",
       "305161        12960  transaction   708    0.05\n",
       "305938         7909  transaction   714    0.08\n",
       "306485        16492  transaction   714    0.06\n",
       "\n",
       "[307 rows x 4 columns]"
      ]
     },
     "execution_count": 240,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transactions[transactions['amount']<0.10]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "No idea for what item the customers paid less than 0.10 dollars but not altering this data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 241,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "customer_id    0\n",
       "event          0\n",
       "time           0\n",
       "amount         0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 241,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transactions.isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now there are four cleaned dataframes, Profile,portfolio,offer_activity,transactions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 242,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>income</th>\n",
       "      <th>year_joined</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>F</td>\n",
       "      <td>112000.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>100000.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>68</td>\n",
       "      <td>M</td>\n",
       "      <td>70000.0</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>65</td>\n",
       "      <td>M</td>\n",
       "      <td>53000.0</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>13</td>\n",
       "      <td>58</td>\n",
       "      <td>M</td>\n",
       "      <td>51000.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    customer_id  age gender    income  year_joined\n",
       "1             2   55      F  112000.0         2017\n",
       "3             4   75      F  100000.0         2017\n",
       "5             6   68      M   70000.0         2018\n",
       "8             9   65      M   53000.0         2018\n",
       "12           13   58      M   51000.0         2017"
      ]
     },
     "execution_count": 242,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 243,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>offer_id</th>\n",
       "      <th>reward</th>\n",
       "      <th>difficulty</th>\n",
       "      <th>duration</th>\n",
       "      <th>email</th>\n",
       "      <th>mobile</th>\n",
       "      <th>social</th>\n",
       "      <th>web</th>\n",
       "      <th>bogo</th>\n",
       "      <th>informational</th>\n",
       "      <th>discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>120</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>96</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>20</td>\n",
       "      <td>240</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>240</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>72</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>120</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   offer_id  reward  difficulty  duration  email  mobile  social  web  bogo  \\\n",
       "0         1      10          10       168      1       1       1    0     1   \n",
       "1         2      10          10       120      1       1       1    1     1   \n",
       "2         3       0           0        96      1       1       0    1     0   \n",
       "3         4       5           5       168      1       1       0    1     1   \n",
       "4         5       5          20       240      1       0       0    1     0   \n",
       "5         6       3           7       168      1       1       1    1     0   \n",
       "6         7       2          10       240      1       1       1    1     0   \n",
       "7         8       0           0        72      1       1       1    0     0   \n",
       "8         9       5           5       120      1       1       1    1     1   \n",
       "9        10       2          10       168      1       1       0    1     0   \n",
       "\n",
       "   informational  discount  \n",
       "0              0         0  \n",
       "1              0         0  \n",
       "2              1         0  \n",
       "3              0         0  \n",
       "4              0         1  \n",
       "5              0         1  \n",
       "6              0         1  \n",
       "7              1         0  \n",
       "8              0         0  \n",
       "9              0         1  "
      ]
     },
     "execution_count": 243,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 244,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>offer_id</th>\n",
       "      <th>event</th>\n",
       "      <th>time</th>\n",
       "      <th>reward</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>10</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>13</td>\n",
       "      <td>3</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>14</td>\n",
       "      <td>5</td>\n",
       "      <td>offer received</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   customer_id  offer_id           event  time  reward\n",
       "0            4         4  offer received     0       0\n",
       "2            6        10  offer received     0       0\n",
       "5            9         9  offer received     0       0\n",
       "7           13         3  offer received     0       0\n",
       "8           14         5  offer received     0       0"
      ]
     },
     "execution_count": 244,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 245,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>offer_id</th>\n",
       "      <th>event</th>\n",
       "      <th>time</th>\n",
       "      <th>reward</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>53216</th>\n",
       "      <td>60</td>\n",
       "      <td>5</td>\n",
       "      <td>offer received</td>\n",
       "      <td>168</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>110869</th>\n",
       "      <td>60</td>\n",
       "      <td>3</td>\n",
       "      <td>offer received</td>\n",
       "      <td>336</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150639</th>\n",
       "      <td>60</td>\n",
       "      <td>1</td>\n",
       "      <td>offer received</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>174367</th>\n",
       "      <td>60</td>\n",
       "      <td>1</td>\n",
       "      <td>offer viewed</td>\n",
       "      <td>426</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201609</th>\n",
       "      <td>60</td>\n",
       "      <td>7</td>\n",
       "      <td>offer received</td>\n",
       "      <td>504</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>243237</th>\n",
       "      <td>60</td>\n",
       "      <td>7</td>\n",
       "      <td>offer viewed</td>\n",
       "      <td>570</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        customer_id  offer_id           event  time  reward\n",
       "53216            60         5  offer received   168       0\n",
       "110869           60         3  offer received   336       0\n",
       "150639           60         1  offer received   408       0\n",
       "174367           60         1    offer viewed   426       0\n",
       "201609           60         7  offer received   504       0\n",
       "243237           60         7    offer viewed   570       0"
      ]
     },
     "execution_count": 245,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity[offer_activity['customer_id']==60]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 246,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>event</th>\n",
       "      <th>time</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>38224</th>\n",
       "      <td>60</td>\n",
       "      <td>transaction</td>\n",
       "      <td>84</td>\n",
       "      <td>2.51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104850</th>\n",
       "      <td>60</td>\n",
       "      <td>transaction</td>\n",
       "      <td>300</td>\n",
       "      <td>4.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>147221</th>\n",
       "      <td>60</td>\n",
       "      <td>transaction</td>\n",
       "      <td>396</td>\n",
       "      <td>6.58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>237378</th>\n",
       "      <td>60</td>\n",
       "      <td>transaction</td>\n",
       "      <td>552</td>\n",
       "      <td>0.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>243238</th>\n",
       "      <td>60</td>\n",
       "      <td>transaction</td>\n",
       "      <td>570</td>\n",
       "      <td>0.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>268850</th>\n",
       "      <td>60</td>\n",
       "      <td>transaction</td>\n",
       "      <td>594</td>\n",
       "      <td>2.15</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        customer_id        event  time  amount\n",
       "38224            60  transaction    84    2.51\n",
       "104850           60  transaction   300    4.59\n",
       "147221           60  transaction   396    6.58\n",
       "237378           60  transaction   552    0.30\n",
       "243238           60  transaction   570    0.87\n",
       "268850           60  transaction   594    2.15"
      ]
     },
     "execution_count": 246,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transactions[transactions['customer_id']==60]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Feature Engineering"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Creating 'offer_recieved_times' is use it in the function later"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 247,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_activity.sort_values(by=['customer_id','offer_id'],inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 248,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_activity.head(20)\n",
    "offer_recieved_times=offer_activity[offer_activity['event']=='offer received'][['customer_id','offer_id','time']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>offer_id</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>201571</th>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>504</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150597</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>408</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150598</th>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>408</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53176</th>\n",
       "      <td>4</td>\n",
       "      <td>8</td>\n",
       "      <td>168</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>163372</th>\n",
       "      <td>16999</td>\n",
       "      <td>4</td>\n",
       "      <td>408</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>123538</th>\n",
       "      <td>17000</td>\n",
       "      <td>3</td>\n",
       "      <td>336</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>257886</th>\n",
       "      <td>17000</td>\n",
       "      <td>3</td>\n",
       "      <td>576</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12649</th>\n",
       "      <td>17000</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>163373</th>\n",
       "      <td>17000</td>\n",
       "      <td>9</td>\n",
       "      <td>408</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>66501 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        customer_id  offer_id  time\n",
       "201571            2         3   504\n",
       "150597            2         4   408\n",
       "150598            4         1   408\n",
       "0                 4         4     0\n",
       "53176             4         8   168\n",
       "...             ...       ...   ...\n",
       "163372        16999         4   408\n",
       "123538        17000         3   336\n",
       "257886        17000         3   576\n",
       "12649         17000         6     0\n",
       "163373        17000         9   408\n",
       "\n",
       "[66501 rows x 3 columns]"
      ]
     },
     "execution_count": 249,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_recieved_times"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Creating offer_’x’_received, offer_’x’_viewed,’ ‘offer_’x’_recievedtime’ columns,for x ranging in offer id’s from 1 to 10."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 250,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in range(1,11):\n",
    "    offer_activity['offer_{}_received'.format(i)]=np.where(((offer_activity['offer_id']==i) & (offer_activity['event']=='offer received')),1,0)\n",
    "    offer_activity['offer_{}_viewed'.format(i)]=np.where(((offer_activity['offer_id']==i) & (offer_activity['event']=='offer viewed')),1,0)\n",
    "    offer_activity['offer_{}_recievedtime'.format(i)]=np.where(((offer_activity['offer_id']==i) & (offer_activity['event']=='offer received')),offer_activity['time'],0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 251,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "148805"
      ]
     },
     "execution_count": 251,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity=offer_activity.reset_index(drop=True)\n",
    "offer_activity.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 252,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>offer_id</th>\n",
       "      <th>event</th>\n",
       "      <th>time</th>\n",
       "      <th>reward</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_1_recievedtime</th>\n",
       "      <th>offer_2_received</th>\n",
       "      <th>offer_2_viewed</th>\n",
       "      <th>offer_2_recievedtime</th>\n",
       "      <th>offer_3_received</th>\n",
       "      <th>offer_3_viewed</th>\n",
       "      <th>offer_3_recievedtime</th>\n",
       "      <th>offer_4_received</th>\n",
       "      <th>offer_4_viewed</th>\n",
       "      <th>offer_4_recievedtime</th>\n",
       "      <th>offer_5_received</th>\n",
       "      <th>offer_5_viewed</th>\n",
       "      <th>offer_5_recievedtime</th>\n",
       "      <th>offer_6_received</th>\n",
       "      <th>offer_6_viewed</th>\n",
       "      <th>offer_6_recievedtime</th>\n",
       "      <th>offer_7_received</th>\n",
       "      <th>offer_7_viewed</th>\n",
       "      <th>offer_7_recievedtime</th>\n",
       "      <th>offer_8_received</th>\n",
       "      <th>offer_8_viewed</th>\n",
       "      <th>offer_8_recievedtime</th>\n",
       "      <th>offer_9_received</th>\n",
       "      <th>offer_9_viewed</th>\n",
       "      <th>offer_9_recievedtime</th>\n",
       "      <th>offer_10_received</th>\n",
       "      <th>offer_10_viewed</th>\n",
       "      <th>offer_10_recievedtime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>offer received</td>\n",
       "      <td>504</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>504</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>offer received</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>offer completed</td>\n",
       "      <td>528</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>offer received</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>offer viewed</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148800</th>\n",
       "      <td>17000</td>\n",
       "      <td>6</td>\n",
       "      <td>offer viewed</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148801</th>\n",
       "      <td>17000</td>\n",
       "      <td>6</td>\n",
       "      <td>offer completed</td>\n",
       "      <td>54</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148802</th>\n",
       "      <td>17000</td>\n",
       "      <td>9</td>\n",
       "      <td>offer received</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148803</th>\n",
       "      <td>17000</td>\n",
       "      <td>9</td>\n",
       "      <td>offer completed</td>\n",
       "      <td>480</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>148804</th>\n",
       "      <td>17000</td>\n",
       "      <td>9</td>\n",
       "      <td>offer viewed</td>\n",
       "      <td>546</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>148805 rows × 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        customer_id  offer_id            event  time  reward  \\\n",
       "0                 2         3   offer received   504       0   \n",
       "1                 2         4   offer received   408       0   \n",
       "2                 2         4  offer completed   528       5   \n",
       "3                 4         1   offer received   408       0   \n",
       "4                 4         1     offer viewed   408       0   \n",
       "...             ...       ...              ...   ...     ...   \n",
       "148800        17000         6     offer viewed     6       0   \n",
       "148801        17000         6  offer completed    54       3   \n",
       "148802        17000         9   offer received   408       0   \n",
       "148803        17000         9  offer completed   480       5   \n",
       "148804        17000         9     offer viewed   546       0   \n",
       "\n",
       "        offer_1_received  offer_1_viewed  offer_1_recievedtime  \\\n",
       "0                      0               0                     0   \n",
       "1                      0               0                     0   \n",
       "2                      0               0                     0   \n",
       "3                      1               0                   408   \n",
       "4                      0               1                     0   \n",
       "...                  ...             ...                   ...   \n",
       "148800                 0               0                     0   \n",
       "148801                 0               0                     0   \n",
       "148802                 0               0                     0   \n",
       "148803                 0               0                     0   \n",
       "148804                 0               0                     0   \n",
       "\n",
       "        offer_2_received  offer_2_viewed  offer_2_recievedtime  \\\n",
       "0                      0               0                     0   \n",
       "1                      0               0                     0   \n",
       "2                      0               0                     0   \n",
       "3                      0               0                     0   \n",
       "4                      0               0                     0   \n",
       "...                  ...             ...                   ...   \n",
       "148800                 0               0                     0   \n",
       "148801                 0               0                     0   \n",
       "148802                 0               0                     0   \n",
       "148803                 0               0                     0   \n",
       "148804                 0               0                     0   \n",
       "\n",
       "        offer_3_received  offer_3_viewed  offer_3_recievedtime  \\\n",
       "0                      1               0                   504   \n",
       "1                      0               0                     0   \n",
       "2                      0               0                     0   \n",
       "3                      0               0                     0   \n",
       "4                      0               0                     0   \n",
       "...                  ...             ...                   ...   \n",
       "148800                 0               0                     0   \n",
       "148801                 0               0                     0   \n",
       "148802                 0               0                     0   \n",
       "148803                 0               0                     0   \n",
       "148804                 0               0                     0   \n",
       "\n",
       "        offer_4_received  offer_4_viewed  offer_4_recievedtime  \\\n",
       "0                      0               0                     0   \n",
       "1                      1               0                   408   \n",
       "2                      0               0                     0   \n",
       "3                      0               0                     0   \n",
       "4                      0               0                     0   \n",
       "...                  ...             ...                   ...   \n",
       "148800                 0               0                     0   \n",
       "148801                 0               0                     0   \n",
       "148802                 0               0                     0   \n",
       "148803                 0               0                     0   \n",
       "148804                 0               0                     0   \n",
       "\n",
       "        offer_5_received  offer_5_viewed  offer_5_recievedtime  \\\n",
       "0                      0               0                     0   \n",
       "1                      0               0                     0   \n",
       "2                      0               0                     0   \n",
       "3                      0               0                     0   \n",
       "4                      0               0                     0   \n",
       "...                  ...             ...                   ...   \n",
       "148800                 0               0                     0   \n",
       "148801                 0               0                     0   \n",
       "148802                 0               0                     0   \n",
       "148803                 0               0                     0   \n",
       "148804                 0               0                     0   \n",
       "\n",
       "        offer_6_received  offer_6_viewed  offer_6_recievedtime  \\\n",
       "0                      0               0                     0   \n",
       "1                      0               0                     0   \n",
       "2                      0               0                     0   \n",
       "3                      0               0                     0   \n",
       "4                      0               0                     0   \n",
       "...                  ...             ...                   ...   \n",
       "148800                 0               1                     0   \n",
       "148801                 0               0                     0   \n",
       "148802                 0               0                     0   \n",
       "148803                 0               0                     0   \n",
       "148804                 0               0                     0   \n",
       "\n",
       "        offer_7_received  offer_7_viewed  offer_7_recievedtime  \\\n",
       "0                      0               0                     0   \n",
       "1                      0               0                     0   \n",
       "2                      0               0                     0   \n",
       "3                      0               0                     0   \n",
       "4                      0               0                     0   \n",
       "...                  ...             ...                   ...   \n",
       "148800                 0               0                     0   \n",
       "148801                 0               0                     0   \n",
       "148802                 0               0                     0   \n",
       "148803                 0               0                     0   \n",
       "148804                 0               0                     0   \n",
       "\n",
       "        offer_8_received  offer_8_viewed  offer_8_recievedtime  \\\n",
       "0                      0               0                     0   \n",
       "1                      0               0                     0   \n",
       "2                      0               0                     0   \n",
       "3                      0               0                     0   \n",
       "4                      0               0                     0   \n",
       "...                  ...             ...                   ...   \n",
       "148800                 0               0                     0   \n",
       "148801                 0               0                     0   \n",
       "148802                 0               0                     0   \n",
       "148803                 0               0                     0   \n",
       "148804                 0               0                     0   \n",
       "\n",
       "        offer_9_received  offer_9_viewed  offer_9_recievedtime  \\\n",
       "0                      0               0                     0   \n",
       "1                      0               0                     0   \n",
       "2                      0               0                     0   \n",
       "3                      0               0                     0   \n",
       "4                      0               0                     0   \n",
       "...                  ...             ...                   ...   \n",
       "148800                 0               0                     0   \n",
       "148801                 0               0                     0   \n",
       "148802                 1               0                   408   \n",
       "148803                 0               0                     0   \n",
       "148804                 0               1                     0   \n",
       "\n",
       "        offer_10_received  offer_10_viewed  offer_10_recievedtime  \n",
       "0                       0                0                      0  \n",
       "1                       0                0                      0  \n",
       "2                       0                0                      0  \n",
       "3                       0                0                      0  \n",
       "4                       0                0                      0  \n",
       "...                   ...              ...                    ...  \n",
       "148800                  0                0                      0  \n",
       "148801                  0                0                      0  \n",
       "148802                  0                0                      0  \n",
       "148803                  0                0                      0  \n",
       "148804                  0                0                      0  \n",
       "\n",
       "[148805 rows x 35 columns]"
      ]
     },
     "execution_count": 252,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 253,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_activity.drop({'offer_id','event','time'},axis=1,inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 254,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_col=offer_activity.columns.tolist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 255,
   "metadata": {},
   "outputs": [],
   "source": [
    "col=dict()\n",
    "for i in offer_col:\n",
    "    col[i]='sum'\n",
    "del col['customer_id']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Grouping the rows together based on customer id and aggregating all the columns to get all the details about the offers for each customer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 256,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_activity=offer_activity.groupby(['customer_id'],as_index=False).agg(col)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 257,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>reward</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_1_recievedtime</th>\n",
       "      <th>offer_2_received</th>\n",
       "      <th>offer_2_viewed</th>\n",
       "      <th>offer_2_recievedtime</th>\n",
       "      <th>offer_3_received</th>\n",
       "      <th>offer_3_viewed</th>\n",
       "      <th>offer_3_recievedtime</th>\n",
       "      <th>offer_4_received</th>\n",
       "      <th>offer_4_viewed</th>\n",
       "      <th>offer_4_recievedtime</th>\n",
       "      <th>offer_5_received</th>\n",
       "      <th>offer_5_viewed</th>\n",
       "      <th>offer_5_recievedtime</th>\n",
       "      <th>offer_6_received</th>\n",
       "      <th>offer_6_viewed</th>\n",
       "      <th>offer_6_recievedtime</th>\n",
       "      <th>offer_7_received</th>\n",
       "      <th>offer_7_viewed</th>\n",
       "      <th>offer_7_recievedtime</th>\n",
       "      <th>offer_8_received</th>\n",
       "      <th>offer_8_viewed</th>\n",
       "      <th>offer_8_recievedtime</th>\n",
       "      <th>offer_9_received</th>\n",
       "      <th>offer_9_viewed</th>\n",
       "      <th>offer_9_recievedtime</th>\n",
       "      <th>offer_10_received</th>\n",
       "      <th>offer_10_viewed</th>\n",
       "      <th>offer_10_recievedtime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>504</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>504</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>336</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>408</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>504</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>576</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>576</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>504</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>336</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>336</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   customer_id  reward  offer_1_received  offer_1_viewed  \\\n",
       "0            2       5                 0               0   \n",
       "1            4      20                 1               1   \n",
       "2            6       7                 0               0   \n",
       "3            9      19                 0               0   \n",
       "4           13       2                 0               0   \n",
       "\n",
       "   offer_1_recievedtime  offer_2_received  offer_2_viewed  \\\n",
       "0                     0                 0               0   \n",
       "1                   408                 0               0   \n",
       "2                     0                 0               0   \n",
       "3                     0                 0               0   \n",
       "4                     0                 0               0   \n",
       "\n",
       "   offer_2_recievedtime  offer_3_received  offer_3_viewed  \\\n",
       "0                     0                 1               0   \n",
       "1                     0                 0               0   \n",
       "2                     0                 1               0   \n",
       "3                     0                 0               0   \n",
       "4                     0                 1               0   \n",
       "\n",
       "   offer_3_recievedtime  offer_4_received  offer_4_viewed  \\\n",
       "0                   504                 1               0   \n",
       "1                     0                 1               1   \n",
       "2                   336                 1               1   \n",
       "3                     0                 2               2   \n",
       "4                     0                 0               0   \n",
       "\n",
       "   offer_4_recievedtime  offer_5_received  offer_5_viewed  \\\n",
       "0                   408                 0               0   \n",
       "1                     0                 0               0   \n",
       "2                   408                 0               0   \n",
       "3                   576                 0               0   \n",
       "4                     0                 0               0   \n",
       "\n",
       "   offer_5_recievedtime  offer_6_received  offer_6_viewed  \\\n",
       "0                     0                 0               0   \n",
       "1                     0                 0               0   \n",
       "2                     0                 0               0   \n",
       "3                     0                 0               0   \n",
       "4                     0                 1               1   \n",
       "\n",
       "   offer_6_recievedtime  offer_7_received  offer_7_viewed  \\\n",
       "0                     0                 0               0   \n",
       "1                     0                 0               0   \n",
       "2                     0                 1               1   \n",
       "3                     0                 1               1   \n",
       "4                   168                 1               1   \n",
       "\n",
       "   offer_7_recievedtime  offer_8_received  offer_8_viewed  \\\n",
       "0                     0                 0               0   \n",
       "1                     0                 1               1   \n",
       "2                   504                 0               0   \n",
       "3                   576                 0               0   \n",
       "4                   336                 0               0   \n",
       "\n",
       "   offer_8_recievedtime  offer_9_received  offer_9_viewed  \\\n",
       "0                     0                 0               0   \n",
       "1                   168                 1               1   \n",
       "2                     0                 0               0   \n",
       "3                     0                 2               2   \n",
       "4                     0                 0               0   \n",
       "\n",
       "   offer_9_recievedtime  offer_10_received  offer_10_viewed  \\\n",
       "0                     0                  0                0   \n",
       "1                   504                  0                0   \n",
       "2                     0                  1                1   \n",
       "3                   504                  1                1   \n",
       "4                     0                  0                0   \n",
       "\n",
       "   offer_10_recievedtime  \n",
       "0                      0  \n",
       "1                      0  \n",
       "2                      0  \n",
       "3                    336  \n",
       "4                      0  "
      ]
     },
     "execution_count": 257,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.set_option(\"display.max_columns\", None)\n",
    "offer_activity.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 258,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_recieved_time(cust_id,offer_id,offer_recieved_times,count):\n",
    "    \"\"\"\n",
    "    Returns a list that contains only recieved times\n",
    "    Args:\n",
    "    cust_id:  customer id for which recieved time is to be returned\n",
    "    offer_id: offer id for which recieved time is to be returned\n",
    "    offer_recieved_times: a dataframe with recieved times\n",
    "    count: number of the times the customer has recieved the offer\n",
    "    Return: \n",
    "    recieved_times_list: list that contains the recieved times\n",
    "    \"\"\"\n",
    "    df_recieve_time=offer_recieved_times[(offer_recieved_times['customer_id']==cust_id) & (offer_recieved_times['offer_id']==offer_id)].reset_index()\n",
    "    recieved_times_list=[]\n",
    "    for i in range(0,count):\n",
    "        recieved_times_list.append(df_recieve_time['time'][i])\n",
    "    return recieved_times_list\n",
    "        "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 259,
   "metadata": {},
   "outputs": [],
   "source": [
    "# print(\"This is initial case\",cases)\n",
    "# print(\"This is customer_id\",cust_id)\n",
    "# print(\"This is offer_id\",offer_id)\n",
    "# print(\"This is offer_recieved\",offer_recieved)\n",
    "# print(\"This is offer_recieved_time\",offer_recieved_time)\n",
    "# print(\"This is offer_viewed\",cust_id)\n",
    "# print(\"This is offer_duration\",offer_duration)\n",
    "# print(\"This is amount_to_be_spent\",amount_to_be_spent)\n",
    "# print(\"This is transcation log\",t_df)\n",
    "# print(\"This is amount_spent\",amount_spent)\n",
    "# print(\"This is amount_to_be_spent\",amount_to_be_spent)\n",
    "# print(\"This is case0\",cases[0])\n",
    "# print(\"This is case1\",cases[1])\n",
    "# print(\"This is case2\",cases[2])\n",
    "# print(\"This is case3\",cases[3])\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 260,
   "metadata": {},
   "outputs": [],
   "source": [
    "def mainfunction(data,offer_id,portfolio,transactions,offer_recieved_times):\n",
    "    \"\"\"\n",
    "    Returns a list with four values representing whether the customer has completed,accidentally completed,ignored or didnotcomplete the offer\n",
    "    Args:\n",
    "    data:  data from the dataframe the function is being applied to\n",
    "    offer_id: offer id for the factors are to be checked for\n",
    "    portfolio: a dataframe with information regarding the offers(duration,difficulty)\n",
    "    transactions: a dataframe with information regarding the transactions done by the customer\n",
    "    offer_recieved_times:a dataframe with recieved times\n",
    "    Return: \n",
    "    list: values representing whether the customer has completed,accidentally completed,ignored or didnotcomplete the offer\n",
    "    \"\"\"\n",
    "    \n",
    "    cases=[0,0,0,0]\n",
    "    cust_id=data['customer_id']\n",
    "    offer_id=offer_id\n",
    "    offer_recieved=data[1]\n",
    "    if offer_recieved>0:\n",
    "        if offer_recieved>1:\n",
    "            count=offer_recieved\n",
    "            offer_viewed=data[3]\n",
    "            offer_recieved_time=get_recieved_time(cust_id,offer_id,offer_recieved_times,count)\n",
    "            offer_duration=int(portfolio[portfolio['offer_id']==offer_id]['duration'])\n",
    "            amount_to_be_spent=float(portfolio[portfolio['offer_id']==offer_id]['difficulty'])\n",
    "            for i in range(0,count):\n",
    "                t_df=transactions[(transactions['customer_id']==cust_id) & (transactions['time']>=offer_recieved_time[i]) & (transactions['time']<=offer_recieved_time[i]+offer_duration)]\n",
    "                if(t_df.shape[0]!=0):\n",
    "\n",
    "                    amount_spent=float(t_df.groupby('customer_id').agg({'amount':'sum'})['amount'])\n",
    "                    if (offer_recieved>=1) & (offer_viewed>=1) & (amount_spent>amount_to_be_spent): #Completed\n",
    "                        cases[0]=cases[0]+1\n",
    "\n",
    "                    elif (offer_recieved>=1) & (offer_viewed==0) & (amount_spent>amount_to_be_spent): #accidentally completed\n",
    "                        cases[1]=cases[1]+1\n",
    "\n",
    "                    elif (offer_recieved>=1) & (offer_viewed>=1) & (amount_spent<amount_to_be_spent): #ignored\n",
    "                        cases[2]=cases[2]+1\n",
    "                elif (offer_recieved>=1) & (offer_viewed>=1) & (t_df.shape[0]==0): #saw the offer but didnot make any transcation during the offer period\n",
    "                    cases[2]=cases[2]+1\n",
    "                else:\n",
    "                    cases[3]=cases[3]+1\n",
    "\n",
    "                offer_recieved=offer_recieved-1\n",
    "                offer_viewed=offer_viewed-1\n",
    "\n",
    "\n",
    "        else:\n",
    "            #offer_recieved_time=offer_recieved_times[(offer_recieved_times['customer_id']==cust_id) & (offer_recieved_times['offer_id']==offer_id)]\n",
    "            offer_recieved_time=data[2]\n",
    "            offer_viewed=data[3]\n",
    "            offer_duration=int(portfolio[portfolio['offer_id']==offer_id]['duration'])\n",
    "            amount_to_be_spent=float(portfolio[portfolio['offer_id']==offer_id]['difficulty'])\n",
    "\n",
    "            t_df=transactions[(transactions['customer_id']==cust_id) & (transactions['time']>=offer_recieved_time) & (transactions['time']<=offer_recieved_time+offer_duration)]\n",
    "           \n",
    "            if(t_df.shape[0]!=0):\n",
    "                amount_spent=float(t_df.groupby('customer_id').agg({'amount':'sum'})['amount'])\n",
    "                \n",
    "                if (offer_recieved==1) & (offer_viewed==1) & (amount_spent>amount_to_be_spent): #completed\n",
    "                    cases[0]=cases[0]+1\n",
    "                   \n",
    "                elif (offer_recieved==1) & (offer_viewed==0) & (amount_spent>amount_to_be_spent):#accidentaly completed\n",
    "                    cases[1]=cases[1]+1\n",
    "                    \n",
    "                elif (offer_recieved==1) & (offer_viewed==1) & (amount_spent<amount_to_be_spent): #igonred\n",
    "                    cases[2]=cases[2]+1\n",
    "                    \n",
    "\n",
    "            elif (offer_recieved==1) & (offer_viewed==1) & (t_df.shape[0]==0): #saw the offer but didnot make any transcation during the offer period\n",
    "                cases[2]=cases[2]+1\n",
    "            else:\n",
    "                cases[3]=cases[3]+1\n",
    "        return cases[0],cases[1],cases[2],data[1]-(cases[0]+cases[1]+cases[2])\n",
    "    else:\n",
    "        return cases[0],cases[1],cases[2],cases[3]\n",
    "    \n",
    "        \n",
    "        \n",
    "    \n",
    "    \n",
    "    "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Creating ‘offer_x_completed’, ‘offer_x_accidentally_completed’, ‘offer_x_ignored’  , ‘offer_x_ didnotcomplete’ column for each customer where x ranging in offer id’s from 1 to 10."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 261,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in range(1,11):\n",
    "    offer_activity['offer_{}_completed'.format(i)],offer_activity['offer_{}_accidentallycompleted'.format(i)],offer_activity['offer_{}_ignored'.format(i)],offer_activity['offer_{}_didnotcomplete'.format(i)]=zip(*offer_activity[['customer_id','offer_{}_received'.format(i),'offer_{}_recievedtime'.format(i),'offer_{}_viewed'.format(i)]].apply(mainfunction,axis = 1,args=(i,portfolio,transactions,offer_recieved_times,)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 262,
   "metadata": {},
   "outputs": [],
   "source": [
    "#We dont want revieve time any more so dropping it\n",
    "for i in range(1,11):\n",
    "    offer_activity.drop({'offer_{}_recievedtime'.format(i)},axis=1,inplace=True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 263,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>reward</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_2_received</th>\n",
       "      <th>offer_2_viewed</th>\n",
       "      <th>offer_3_received</th>\n",
       "      <th>offer_3_viewed</th>\n",
       "      <th>offer_4_received</th>\n",
       "      <th>offer_4_viewed</th>\n",
       "      <th>offer_5_received</th>\n",
       "      <th>offer_5_viewed</th>\n",
       "      <th>offer_6_received</th>\n",
       "      <th>offer_6_viewed</th>\n",
       "      <th>offer_7_received</th>\n",
       "      <th>offer_7_viewed</th>\n",
       "      <th>offer_8_received</th>\n",
       "      <th>offer_8_viewed</th>\n",
       "      <th>offer_9_received</th>\n",
       "      <th>offer_9_viewed</th>\n",
       "      <th>offer_10_received</th>\n",
       "      <th>offer_10_viewed</th>\n",
       "      <th>offer_1_completed</th>\n",
       "      <th>offer_1_accidentallycompleted</th>\n",
       "      <th>offer_1_ignored</th>\n",
       "      <th>offer_1_didnotcomplete</th>\n",
       "      <th>offer_2_completed</th>\n",
       "      <th>offer_2_accidentallycompleted</th>\n",
       "      <th>offer_2_ignored</th>\n",
       "      <th>offer_2_didnotcomplete</th>\n",
       "      <th>offer_3_completed</th>\n",
       "      <th>offer_3_accidentallycompleted</th>\n",
       "      <th>offer_3_ignored</th>\n",
       "      <th>offer_3_didnotcomplete</th>\n",
       "      <th>offer_4_completed</th>\n",
       "      <th>offer_4_accidentallycompleted</th>\n",
       "      <th>offer_4_ignored</th>\n",
       "      <th>offer_4_didnotcomplete</th>\n",
       "      <th>offer_5_completed</th>\n",
       "      <th>offer_5_accidentallycompleted</th>\n",
       "      <th>offer_5_ignored</th>\n",
       "      <th>offer_5_didnotcomplete</th>\n",
       "      <th>offer_6_completed</th>\n",
       "      <th>offer_6_accidentallycompleted</th>\n",
       "      <th>offer_6_ignored</th>\n",
       "      <th>offer_6_didnotcomplete</th>\n",
       "      <th>offer_7_completed</th>\n",
       "      <th>offer_7_accidentallycompleted</th>\n",
       "      <th>offer_7_ignored</th>\n",
       "      <th>offer_7_didnotcomplete</th>\n",
       "      <th>offer_8_completed</th>\n",
       "      <th>offer_8_accidentallycompleted</th>\n",
       "      <th>offer_8_ignored</th>\n",
       "      <th>offer_8_didnotcomplete</th>\n",
       "      <th>offer_9_completed</th>\n",
       "      <th>offer_9_accidentallycompleted</th>\n",
       "      <th>offer_9_ignored</th>\n",
       "      <th>offer_9_didnotcomplete</th>\n",
       "      <th>offer_10_completed</th>\n",
       "      <th>offer_10_accidentallycompleted</th>\n",
       "      <th>offer_10_ignored</th>\n",
       "      <th>offer_10_didnotcomplete</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14815</th>\n",
       "      <td>16996</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14816</th>\n",
       "      <td>16997</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14817</th>\n",
       "      <td>16998</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14818</th>\n",
       "      <td>16999</td>\n",
       "      <td>25</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14819</th>\n",
       "      <td>17000</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14820 rows × 62 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       customer_id  reward  offer_1_received  offer_1_viewed  \\\n",
       "0                2       5                 0               0   \n",
       "1                4      20                 1               1   \n",
       "2                6       7                 0               0   \n",
       "3                9      19                 0               0   \n",
       "4               13       2                 0               0   \n",
       "...            ...     ...               ...             ...   \n",
       "14815        16996       0                 0               0   \n",
       "14816        16997       5                 0               0   \n",
       "14817        16998       0                 0               0   \n",
       "14818        16999      25                 1               1   \n",
       "14819        17000       8                 0               0   \n",
       "\n",
       "       offer_2_received  offer_2_viewed  offer_3_received  offer_3_viewed  \\\n",
       "0                     0               0                 1               0   \n",
       "1                     0               0                 0               0   \n",
       "2                     0               0                 1               0   \n",
       "3                     0               0                 0               0   \n",
       "4                     0               0                 1               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 1               1                 0               0   \n",
       "14816                 0               0                 1               0   \n",
       "14817                 0               0                 1               0   \n",
       "14818                 1               1                 0               0   \n",
       "14819                 0               0                 2               0   \n",
       "\n",
       "       offer_4_received  offer_4_viewed  offer_5_received  offer_5_viewed  \\\n",
       "0                     1               0                 0               0   \n",
       "1                     1               1                 0               0   \n",
       "2                     1               1                 0               0   \n",
       "3                     2               2                 0               0   \n",
       "4                     0               0                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 0               0   \n",
       "14816                 1               0                 0               0   \n",
       "14817                 0               0                 1               0   \n",
       "14818                 1               1                 0               0   \n",
       "14819                 0               0                 0               0   \n",
       "\n",
       "       offer_6_received  offer_6_viewed  offer_7_received  offer_7_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     0               0                 0               0   \n",
       "2                     0               0                 1               1   \n",
       "3                     0               0                 1               1   \n",
       "4                     1               1                 1               1   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 1               1                 0               0   \n",
       "14816                 0               0                 0               0   \n",
       "14817                 0               0                 0               0   \n",
       "14818                 0               0                 0               0   \n",
       "14819                 1               1                 0               0   \n",
       "\n",
       "       offer_8_received  offer_8_viewed  offer_9_received  offer_9_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     1               1                 1               1   \n",
       "2                     0               0                 0               0   \n",
       "3                     0               0                 2               2   \n",
       "4                     0               0                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 1               1                 0               0   \n",
       "14816                 1               1                 0               0   \n",
       "14817                 1               1                 0               0   \n",
       "14818                 0               0                 0               0   \n",
       "14819                 0               0                 1               1   \n",
       "\n",
       "       offer_10_received  offer_10_viewed  offer_1_completed  \\\n",
       "0                      0                0                  0   \n",
       "1                      0                0                  1   \n",
       "2                      1                1                  0   \n",
       "3                      1                1                  0   \n",
       "4                      0                0                  0   \n",
       "...                  ...              ...                ...   \n",
       "14815                  0                0                  0   \n",
       "14816                  0                0                  0   \n",
       "14817                  0                0                  0   \n",
       "14818                  0                0                  1   \n",
       "14819                  0                0                  0   \n",
       "\n",
       "       offer_1_accidentallycompleted  offer_1_ignored  offer_1_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_2_completed  offer_2_accidentallycompleted  offer_2_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      0                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                1   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  1                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_2_didnotcomplete  offer_3_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_3_accidentallycompleted  offer_3_ignored  offer_3_didnotcomplete  \\\n",
       "0                                  1                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       1   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       1   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       1   \n",
       "14817                              1                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       2   \n",
       "\n",
       "       offer_4_completed  offer_4_accidentallycompleted  offer_4_ignored  \\\n",
       "0                      0                              1                0   \n",
       "1                      1                              0                0   \n",
       "2                      1                              0                0   \n",
       "3                      1                              0                1   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              1                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  1                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_4_didnotcomplete  offer_5_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_5_accidentallycompleted  offer_5_ignored  offer_5_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       1   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_6_completed  offer_6_accidentallycompleted  offer_6_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      0                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                1   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                1   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  1                              0                0   \n",
       "\n",
       "       offer_6_didnotcomplete  offer_7_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  1   \n",
       "3                           0                  1   \n",
       "4                           0                  1   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_7_accidentallycompleted  offer_7_ignored  offer_7_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_8_completed  offer_8_accidentallycompleted  offer_8_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      1                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                1   \n",
       "14816                  0                              0                1   \n",
       "14817                  1                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_8_didnotcomplete  offer_9_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  1   \n",
       "2                           0                  0   \n",
       "3                           0                  2   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  1   \n",
       "\n",
       "       offer_9_accidentallycompleted  offer_9_ignored  offer_9_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_10_completed  offer_10_accidentallycompleted  offer_10_ignored  \\\n",
       "0                       0                               0                 0   \n",
       "1                       0                               0                 0   \n",
       "2                       0                               0                 1   \n",
       "3                       1                               0                 0   \n",
       "4                       0                               0                 0   \n",
       "...                   ...                             ...               ...   \n",
       "14815                   0                               0                 0   \n",
       "14816                   0                               0                 0   \n",
       "14817                   0                               0                 0   \n",
       "14818                   0                               0                 0   \n",
       "14819                   0                               0                 0   \n",
       "\n",
       "       offer_10_didnotcomplete  \n",
       "0                            0  \n",
       "1                            0  \n",
       "2                            0  \n",
       "3                            0  \n",
       "4                            0  \n",
       "...                        ...  \n",
       "14815                        0  \n",
       "14816                        0  \n",
       "14817                        0  \n",
       "14818                        0  \n",
       "14819                        0  \n",
       "\n",
       "[14820 rows x 62 columns]"
      ]
     },
     "execution_count": 263,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 264,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_1_completed</th>\n",
       "      <th>offer_1_ignored</th>\n",
       "      <th>offer_1_didnotcomplete</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14815</th>\n",
       "      <td>16996</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14816</th>\n",
       "      <td>16997</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14817</th>\n",
       "      <td>16998</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14818</th>\n",
       "      <td>16999</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14819</th>\n",
       "      <td>17000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14820 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       customer_id  offer_1_received  offer_1_viewed  offer_1_completed  \\\n",
       "0                2                 0               0                  0   \n",
       "1                4                 1               1                  1   \n",
       "2                6                 0               0                  0   \n",
       "3                9                 0               0                  0   \n",
       "4               13                 0               0                  0   \n",
       "...            ...               ...             ...                ...   \n",
       "14815        16996                 0               0                  0   \n",
       "14816        16997                 0               0                  0   \n",
       "14817        16998                 0               0                  0   \n",
       "14818        16999                 1               1                  1   \n",
       "14819        17000                 0               0                  0   \n",
       "\n",
       "       offer_1_ignored  offer_1_didnotcomplete  \n",
       "0                    0                       0  \n",
       "1                    0                       0  \n",
       "2                    0                       0  \n",
       "3                    0                       0  \n",
       "4                    0                       0  \n",
       "...                ...                     ...  \n",
       "14815                0                       0  \n",
       "14816                0                       0  \n",
       "14817                0                       0  \n",
       "14818                0                       0  \n",
       "14819                0                       0  \n",
       "\n",
       "[14820 rows x 6 columns]"
      ]
     },
     "execution_count": 264,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity[['customer_id','offer_1_received','offer_1_viewed','offer_1_completed','offer_1_ignored','offer_1_didnotcomplete']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 265,
   "metadata": {},
   "outputs": [],
   "source": [
    "filename = 'data/transactions_cleaned.csv'\n",
    "\n",
    "transactions.to_csv(filename, index=False,mode='w+')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 266,
   "metadata": {},
   "outputs": [],
   "source": [
    "filename = 'data/offer_activity_cleaned.csv'\n",
    "\n",
    "offer_activity.to_csv(filename, index=False,mode='w+')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "After merging offer activity with transactions on 'customer_id' there were NaN values because some of the customers didnot make any transactions during this experiment time and,so their ID's were missing in transactions dataframe.But they recieved the offers and even viewed them but didnt make any transactions.So adding them to the transactions list with amount spent a '0'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 267,
   "metadata": {},
   "outputs": [],
   "source": [
    "transactions=transactions.groupby('customer_id',as_index=False).agg({'amount':'sum'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 268,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No of customers that didn't make any transactions during the experiment : 333\n"
     ]
    }
   ],
   "source": [
    "customer_ids_in_transactions=list(transactions['customer_id'])\n",
    "print(\"No of customers that didn't make any transactions during the experiment :\",len(customer_ids)-len(customer_ids_in_transactions)) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 269,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_activity_ids=list(offer_activity['customer_id'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 270,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "333"
      ]
     },
     "execution_count": 270,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Customers_with_no_transactions=list(set(offer_activity_ids)-set(customer_ids_in_transactions))\n",
    "len(Customers_with_no_transactions)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 271,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in Customers_with_no_transactions:\n",
    "    transactions = transactions.append({'customer_id': i}, ignore_index=True)\n",
    "transactions['amount'].fillna(0,inplace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Some of the customers didnt recieve any offer from starbucks."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 272,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No of customers that didn't recieve any offers during the experiment : 5\n"
     ]
    }
   ],
   "source": [
    "offer_activity_ids=list(offer_activity['customer_id'])\n",
    "print(\"No of customers that didn't recieve any offers during the experiment :\",len(customer_ids)-len(offer_activity_ids))\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We need to remove these 6 customers as they are technically not part of the experiment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 273,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[15392, 6790, 5640, 873, 14764]"
      ]
     },
     "execution_count": 273,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Customers_with_no_offers=list(set(customer_ids)-set(offer_activity_ids))\n",
    "Customers_with_no_offers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 274,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_activity=offer_activity[~offer_activity['customer_id'].isin(Customers_with_no_offers)]\n",
    "transactions=transactions[~transactions['customer_id'].isin(Customers_with_no_offers)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 275,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "14820\n"
     ]
    }
   ],
   "source": [
    "sum(offer_activity.isna().sum())\n",
    "print(offer_activity.shape[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 276,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "14820\n"
     ]
    }
   ],
   "source": [
    "sum(transactions.isna().sum())\n",
    "print(transactions.shape[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 277,
   "metadata": {},
   "outputs": [],
   "source": [
    "offer_1_activity,offer_2_activity,offer_3_activity,offer_4_activity,offer_5_activity,offer_6_activity,offer_7_activity,offer_8_activity,offer_9_activity,offer_10_activity=[offer_activity[['customer_id','offer_{}_received'.format(i),'offer_{}_viewed'.format(i),'offer_{}_completed'.format(i),'offer_{}_accidentallycompleted'.format(i),'offer_{}_ignored'.format(i),'offer_{}_didnotcomplete'.format(i)]] for i in range(1,11)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 278,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_1_completed</th>\n",
       "      <th>offer_1_accidentallycompleted</th>\n",
       "      <th>offer_1_ignored</th>\n",
       "      <th>offer_1_didnotcomplete</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   customer_id  offer_1_received  offer_1_viewed  offer_1_completed  \\\n",
       "0            2                 0               0                  0   \n",
       "1            4                 1               1                  1   \n",
       "2            6                 0               0                  0   \n",
       "3            9                 0               0                  0   \n",
       "4           13                 0               0                  0   \n",
       "\n",
       "   offer_1_accidentallycompleted  offer_1_ignored  offer_1_didnotcomplete  \n",
       "0                              0                0                       0  \n",
       "1                              0                0                       0  \n",
       "2                              0                0                       0  \n",
       "3                              0                0                       0  \n",
       "4                              0                0                       0  "
      ]
     },
     "execution_count": 278,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_1_activity.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 279,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>offer_5_received</th>\n",
       "      <th>offer_5_viewed</th>\n",
       "      <th>offer_5_completed</th>\n",
       "      <th>offer_5_accidentallycompleted</th>\n",
       "      <th>offer_5_ignored</th>\n",
       "      <th>offer_5_didnotcomplete</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   customer_id  offer_5_received  offer_5_viewed  offer_5_completed  \\\n",
       "0            2                 0               0                  0   \n",
       "1            4                 0               0                  0   \n",
       "2            6                 0               0                  0   \n",
       "3            9                 0               0                  0   \n",
       "4           13                 0               0                  0   \n",
       "\n",
       "   offer_5_accidentallycompleted  offer_5_ignored  offer_5_didnotcomplete  \n",
       "0                              0                0                       0  \n",
       "1                              0                0                       0  \n",
       "2                              0                0                       0  \n",
       "3                              0                0                       0  \n",
       "4                              0                0                       0  "
      ]
     },
     "execution_count": 279,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_5_activity.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 280,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>offer_10_received</th>\n",
       "      <th>offer_10_viewed</th>\n",
       "      <th>offer_10_completed</th>\n",
       "      <th>offer_10_accidentallycompleted</th>\n",
       "      <th>offer_10_ignored</th>\n",
       "      <th>offer_10_didnotcomplete</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   customer_id  offer_10_received  offer_10_viewed  offer_10_completed  \\\n",
       "0            2                  0                0                   0   \n",
       "1            4                  0                0                   0   \n",
       "2            6                  1                1                   0   \n",
       "3            9                  1                1                   1   \n",
       "4           13                  0                0                   0   \n",
       "\n",
       "   offer_10_accidentallycompleted  offer_10_ignored  offer_10_didnotcomplete  \n",
       "0                               0                 0                        0  \n",
       "1                               0                 0                        0  \n",
       "2                               0                 1                        0  \n",
       "3                               0                 0                        0  \n",
       "4                               0                 0                        0  "
      ]
     },
     "execution_count": 280,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_10_activity.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 281,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>reward</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_2_received</th>\n",
       "      <th>offer_2_viewed</th>\n",
       "      <th>offer_3_received</th>\n",
       "      <th>offer_3_viewed</th>\n",
       "      <th>offer_4_received</th>\n",
       "      <th>offer_4_viewed</th>\n",
       "      <th>offer_5_received</th>\n",
       "      <th>offer_5_viewed</th>\n",
       "      <th>offer_6_received</th>\n",
       "      <th>offer_6_viewed</th>\n",
       "      <th>offer_7_received</th>\n",
       "      <th>offer_7_viewed</th>\n",
       "      <th>offer_8_received</th>\n",
       "      <th>offer_8_viewed</th>\n",
       "      <th>offer_9_received</th>\n",
       "      <th>offer_9_viewed</th>\n",
       "      <th>offer_10_received</th>\n",
       "      <th>offer_10_viewed</th>\n",
       "      <th>offer_1_completed</th>\n",
       "      <th>offer_1_accidentallycompleted</th>\n",
       "      <th>offer_1_ignored</th>\n",
       "      <th>offer_1_didnotcomplete</th>\n",
       "      <th>offer_2_completed</th>\n",
       "      <th>offer_2_accidentallycompleted</th>\n",
       "      <th>offer_2_ignored</th>\n",
       "      <th>offer_2_didnotcomplete</th>\n",
       "      <th>offer_3_completed</th>\n",
       "      <th>offer_3_accidentallycompleted</th>\n",
       "      <th>offer_3_ignored</th>\n",
       "      <th>offer_3_didnotcomplete</th>\n",
       "      <th>offer_4_completed</th>\n",
       "      <th>offer_4_accidentallycompleted</th>\n",
       "      <th>offer_4_ignored</th>\n",
       "      <th>offer_4_didnotcomplete</th>\n",
       "      <th>offer_5_completed</th>\n",
       "      <th>offer_5_accidentallycompleted</th>\n",
       "      <th>offer_5_ignored</th>\n",
       "      <th>offer_5_didnotcomplete</th>\n",
       "      <th>offer_6_completed</th>\n",
       "      <th>offer_6_accidentallycompleted</th>\n",
       "      <th>offer_6_ignored</th>\n",
       "      <th>offer_6_didnotcomplete</th>\n",
       "      <th>offer_7_completed</th>\n",
       "      <th>offer_7_accidentallycompleted</th>\n",
       "      <th>offer_7_ignored</th>\n",
       "      <th>offer_7_didnotcomplete</th>\n",
       "      <th>offer_8_completed</th>\n",
       "      <th>offer_8_accidentallycompleted</th>\n",
       "      <th>offer_8_ignored</th>\n",
       "      <th>offer_8_didnotcomplete</th>\n",
       "      <th>offer_9_completed</th>\n",
       "      <th>offer_9_accidentallycompleted</th>\n",
       "      <th>offer_9_ignored</th>\n",
       "      <th>offer_9_didnotcomplete</th>\n",
       "      <th>offer_10_completed</th>\n",
       "      <th>offer_10_accidentallycompleted</th>\n",
       "      <th>offer_10_ignored</th>\n",
       "      <th>offer_10_didnotcomplete</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>77.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>159.27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>57.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>36.43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>15.62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14815</th>\n",
       "      <td>16996</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>20.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14816</th>\n",
       "      <td>16997</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>25.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14817</th>\n",
       "      <td>16998</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>39.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14818</th>\n",
       "      <td>16999</td>\n",
       "      <td>25</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>189.67</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14819</th>\n",
       "      <td>17000</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>143.02</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14820 rows × 63 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       customer_id  reward  offer_1_received  offer_1_viewed  \\\n",
       "0                2       5                 0               0   \n",
       "1                4      20                 1               1   \n",
       "2                6       7                 0               0   \n",
       "3                9      19                 0               0   \n",
       "4               13       2                 0               0   \n",
       "...            ...     ...               ...             ...   \n",
       "14815        16996       0                 0               0   \n",
       "14816        16997       5                 0               0   \n",
       "14817        16998       0                 0               0   \n",
       "14818        16999      25                 1               1   \n",
       "14819        17000       8                 0               0   \n",
       "\n",
       "       offer_2_received  offer_2_viewed  offer_3_received  offer_3_viewed  \\\n",
       "0                     0               0                 1               0   \n",
       "1                     0               0                 0               0   \n",
       "2                     0               0                 1               0   \n",
       "3                     0               0                 0               0   \n",
       "4                     0               0                 1               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 1               1                 0               0   \n",
       "14816                 0               0                 1               0   \n",
       "14817                 0               0                 1               0   \n",
       "14818                 1               1                 0               0   \n",
       "14819                 0               0                 2               0   \n",
       "\n",
       "       offer_4_received  offer_4_viewed  offer_5_received  offer_5_viewed  \\\n",
       "0                     1               0                 0               0   \n",
       "1                     1               1                 0               0   \n",
       "2                     1               1                 0               0   \n",
       "3                     2               2                 0               0   \n",
       "4                     0               0                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 0               0   \n",
       "14816                 1               0                 0               0   \n",
       "14817                 0               0                 1               0   \n",
       "14818                 1               1                 0               0   \n",
       "14819                 0               0                 0               0   \n",
       "\n",
       "       offer_6_received  offer_6_viewed  offer_7_received  offer_7_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     0               0                 0               0   \n",
       "2                     0               0                 1               1   \n",
       "3                     0               0                 1               1   \n",
       "4                     1               1                 1               1   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 1               1                 0               0   \n",
       "14816                 0               0                 0               0   \n",
       "14817                 0               0                 0               0   \n",
       "14818                 0               0                 0               0   \n",
       "14819                 1               1                 0               0   \n",
       "\n",
       "       offer_8_received  offer_8_viewed  offer_9_received  offer_9_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     1               1                 1               1   \n",
       "2                     0               0                 0               0   \n",
       "3                     0               0                 2               2   \n",
       "4                     0               0                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 1               1                 0               0   \n",
       "14816                 1               1                 0               0   \n",
       "14817                 1               1                 0               0   \n",
       "14818                 0               0                 0               0   \n",
       "14819                 0               0                 1               1   \n",
       "\n",
       "       offer_10_received  offer_10_viewed  offer_1_completed  \\\n",
       "0                      0                0                  0   \n",
       "1                      0                0                  1   \n",
       "2                      1                1                  0   \n",
       "3                      1                1                  0   \n",
       "4                      0                0                  0   \n",
       "...                  ...              ...                ...   \n",
       "14815                  0                0                  0   \n",
       "14816                  0                0                  0   \n",
       "14817                  0                0                  0   \n",
       "14818                  0                0                  1   \n",
       "14819                  0                0                  0   \n",
       "\n",
       "       offer_1_accidentallycompleted  offer_1_ignored  offer_1_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_2_completed  offer_2_accidentallycompleted  offer_2_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      0                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                1   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  1                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_2_didnotcomplete  offer_3_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_3_accidentallycompleted  offer_3_ignored  offer_3_didnotcomplete  \\\n",
       "0                                  1                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       1   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       1   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       1   \n",
       "14817                              1                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       2   \n",
       "\n",
       "       offer_4_completed  offer_4_accidentallycompleted  offer_4_ignored  \\\n",
       "0                      0                              1                0   \n",
       "1                      1                              0                0   \n",
       "2                      1                              0                0   \n",
       "3                      1                              0                1   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              1                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  1                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_4_didnotcomplete  offer_5_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_5_accidentallycompleted  offer_5_ignored  offer_5_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       1   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_6_completed  offer_6_accidentallycompleted  offer_6_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      0                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                1   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                1   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  1                              0                0   \n",
       "\n",
       "       offer_6_didnotcomplete  offer_7_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  1   \n",
       "3                           0                  1   \n",
       "4                           0                  1   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_7_accidentallycompleted  offer_7_ignored  offer_7_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_8_completed  offer_8_accidentallycompleted  offer_8_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      1                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                1   \n",
       "14816                  0                              0                1   \n",
       "14817                  1                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_8_didnotcomplete  offer_9_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  1   \n",
       "2                           0                  0   \n",
       "3                           0                  2   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  1   \n",
       "\n",
       "       offer_9_accidentallycompleted  offer_9_ignored  offer_9_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_10_completed  offer_10_accidentallycompleted  offer_10_ignored  \\\n",
       "0                       0                               0                 0   \n",
       "1                       0                               0                 0   \n",
       "2                       0                               0                 1   \n",
       "3                       1                               0                 0   \n",
       "4                       0                               0                 0   \n",
       "...                   ...                             ...               ...   \n",
       "14815                   0                               0                 0   \n",
       "14816                   0                               0                 0   \n",
       "14817                   0                               0                 0   \n",
       "14818                   0                               0                 0   \n",
       "14819                   0                               0                 0   \n",
       "\n",
       "       offer_10_didnotcomplete  amount  \n",
       "0                            0   77.01  \n",
       "1                            0  159.27  \n",
       "2                            0   57.73  \n",
       "3                            0   36.43  \n",
       "4                            0   15.62  \n",
       "...                        ...     ...  \n",
       "14815                        0   20.03  \n",
       "14816                        0   25.97  \n",
       "14817                        0   39.74  \n",
       "14818                        0  189.67  \n",
       "14819                        0  143.02  \n",
       "\n",
       "[14820 rows x 63 columns]"
      ]
     },
     "execution_count": 281,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_activity_n_amount=pd.merge(offer_activity,transactions, on='customer_id', how='outer')\n",
    "offer_activity_n_amount"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 282,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 282,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sum(offer_activity_n_amount.isna().sum())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 283,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "14820\n"
     ]
    }
   ],
   "source": [
    "profile=profile[~profile['customer_id'].isin(Customers_with_no_offers)]\n",
    "print(profile.shape[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 284,
   "metadata": {},
   "outputs": [],
   "source": [
    "#merging profile and offer_activity and amount\n",
    "final_profile=pd.merge(profile,offer_activity_n_amount,on='customer_id',how='outer') "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 285,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>income</th>\n",
       "      <th>year_joined</th>\n",
       "      <th>reward</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_2_received</th>\n",
       "      <th>offer_2_viewed</th>\n",
       "      <th>offer_3_received</th>\n",
       "      <th>offer_3_viewed</th>\n",
       "      <th>offer_4_received</th>\n",
       "      <th>offer_4_viewed</th>\n",
       "      <th>offer_5_received</th>\n",
       "      <th>offer_5_viewed</th>\n",
       "      <th>offer_6_received</th>\n",
       "      <th>offer_6_viewed</th>\n",
       "      <th>offer_7_received</th>\n",
       "      <th>offer_7_viewed</th>\n",
       "      <th>offer_8_received</th>\n",
       "      <th>offer_8_viewed</th>\n",
       "      <th>offer_9_received</th>\n",
       "      <th>offer_9_viewed</th>\n",
       "      <th>offer_10_received</th>\n",
       "      <th>offer_10_viewed</th>\n",
       "      <th>offer_1_completed</th>\n",
       "      <th>offer_1_accidentallycompleted</th>\n",
       "      <th>offer_1_ignored</th>\n",
       "      <th>offer_1_didnotcomplete</th>\n",
       "      <th>offer_2_completed</th>\n",
       "      <th>offer_2_accidentallycompleted</th>\n",
       "      <th>offer_2_ignored</th>\n",
       "      <th>offer_2_didnotcomplete</th>\n",
       "      <th>offer_3_completed</th>\n",
       "      <th>offer_3_accidentallycompleted</th>\n",
       "      <th>offer_3_ignored</th>\n",
       "      <th>offer_3_didnotcomplete</th>\n",
       "      <th>offer_4_completed</th>\n",
       "      <th>offer_4_accidentallycompleted</th>\n",
       "      <th>offer_4_ignored</th>\n",
       "      <th>offer_4_didnotcomplete</th>\n",
       "      <th>offer_5_completed</th>\n",
       "      <th>offer_5_accidentallycompleted</th>\n",
       "      <th>offer_5_ignored</th>\n",
       "      <th>offer_5_didnotcomplete</th>\n",
       "      <th>offer_6_completed</th>\n",
       "      <th>offer_6_accidentallycompleted</th>\n",
       "      <th>offer_6_ignored</th>\n",
       "      <th>offer_6_didnotcomplete</th>\n",
       "      <th>offer_7_completed</th>\n",
       "      <th>offer_7_accidentallycompleted</th>\n",
       "      <th>offer_7_ignored</th>\n",
       "      <th>offer_7_didnotcomplete</th>\n",
       "      <th>offer_8_completed</th>\n",
       "      <th>offer_8_accidentallycompleted</th>\n",
       "      <th>offer_8_ignored</th>\n",
       "      <th>offer_8_didnotcomplete</th>\n",
       "      <th>offer_9_completed</th>\n",
       "      <th>offer_9_accidentallycompleted</th>\n",
       "      <th>offer_9_ignored</th>\n",
       "      <th>offer_9_didnotcomplete</th>\n",
       "      <th>offer_10_completed</th>\n",
       "      <th>offer_10_accidentallycompleted</th>\n",
       "      <th>offer_10_ignored</th>\n",
       "      <th>offer_10_didnotcomplete</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>F</td>\n",
       "      <td>112000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>77.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>100000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>159.27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>68</td>\n",
       "      <td>M</td>\n",
       "      <td>70000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>57.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>65</td>\n",
       "      <td>M</td>\n",
       "      <td>53000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>36.43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>58</td>\n",
       "      <td>M</td>\n",
       "      <td>51000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>15.62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14815</th>\n",
       "      <td>16996</td>\n",
       "      <td>45</td>\n",
       "      <td>F</td>\n",
       "      <td>54000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>20.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14816</th>\n",
       "      <td>16997</td>\n",
       "      <td>61</td>\n",
       "      <td>M</td>\n",
       "      <td>72000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>25.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14817</th>\n",
       "      <td>16998</td>\n",
       "      <td>49</td>\n",
       "      <td>M</td>\n",
       "      <td>73000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>39.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14818</th>\n",
       "      <td>16999</td>\n",
       "      <td>83</td>\n",
       "      <td>F</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>2016</td>\n",
       "      <td>25</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>189.67</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14819</th>\n",
       "      <td>17000</td>\n",
       "      <td>62</td>\n",
       "      <td>F</td>\n",
       "      <td>82000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>143.02</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14820 rows × 67 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       customer_id  age gender    income  year_joined  reward  \\\n",
       "0                2   55      F  112000.0         2017       5   \n",
       "1                4   75      F  100000.0         2017      20   \n",
       "2                6   68      M   70000.0         2018       7   \n",
       "3                9   65      M   53000.0         2018      19   \n",
       "4               13   58      M   51000.0         2017       2   \n",
       "...            ...  ...    ...       ...          ...     ...   \n",
       "14815        16996   45      F   54000.0         2018       0   \n",
       "14816        16997   61      M   72000.0         2018       5   \n",
       "14817        16998   49      M   73000.0         2017       0   \n",
       "14818        16999   83      F   50000.0         2016      25   \n",
       "14819        17000   62      F   82000.0         2017       8   \n",
       "\n",
       "       offer_1_received  offer_1_viewed  offer_2_received  offer_2_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     1               1                 0               0   \n",
       "2                     0               0                 0               0   \n",
       "3                     0               0                 0               0   \n",
       "4                     0               0                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 1               1   \n",
       "14816                 0               0                 0               0   \n",
       "14817                 0               0                 0               0   \n",
       "14818                 1               1                 1               1   \n",
       "14819                 0               0                 0               0   \n",
       "\n",
       "       offer_3_received  offer_3_viewed  offer_4_received  offer_4_viewed  \\\n",
       "0                     1               0                 1               0   \n",
       "1                     0               0                 1               1   \n",
       "2                     1               0                 1               1   \n",
       "3                     0               0                 2               2   \n",
       "4                     1               0                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 0               0   \n",
       "14816                 1               0                 1               0   \n",
       "14817                 1               0                 0               0   \n",
       "14818                 0               0                 1               1   \n",
       "14819                 2               0                 0               0   \n",
       "\n",
       "       offer_5_received  offer_5_viewed  offer_6_received  offer_6_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     0               0                 0               0   \n",
       "2                     0               0                 0               0   \n",
       "3                     0               0                 0               0   \n",
       "4                     0               0                 1               1   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 1               1   \n",
       "14816                 0               0                 0               0   \n",
       "14817                 1               0                 0               0   \n",
       "14818                 0               0                 0               0   \n",
       "14819                 0               0                 1               1   \n",
       "\n",
       "       offer_7_received  offer_7_viewed  offer_8_received  offer_8_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     0               0                 1               1   \n",
       "2                     1               1                 0               0   \n",
       "3                     1               1                 0               0   \n",
       "4                     1               1                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 1               1   \n",
       "14816                 0               0                 1               1   \n",
       "14817                 0               0                 1               1   \n",
       "14818                 0               0                 0               0   \n",
       "14819                 0               0                 0               0   \n",
       "\n",
       "       offer_9_received  offer_9_viewed  offer_10_received  offer_10_viewed  \\\n",
       "0                     0               0                  0                0   \n",
       "1                     1               1                  0                0   \n",
       "2                     0               0                  1                1   \n",
       "3                     2               2                  1                1   \n",
       "4                     0               0                  0                0   \n",
       "...                 ...             ...                ...              ...   \n",
       "14815                 0               0                  0                0   \n",
       "14816                 0               0                  0                0   \n",
       "14817                 0               0                  0                0   \n",
       "14818                 0               0                  0                0   \n",
       "14819                 1               1                  0                0   \n",
       "\n",
       "       offer_1_completed  offer_1_accidentallycompleted  offer_1_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      1                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  1                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_1_didnotcomplete  offer_2_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  1   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_2_accidentallycompleted  offer_2_ignored  offer_2_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                1                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_3_completed  offer_3_accidentallycompleted  offer_3_ignored  \\\n",
       "0                      0                              1                0   \n",
       "1                      0                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              1                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_3_didnotcomplete  offer_4_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  1   \n",
       "2                           1                  1   \n",
       "3                           0                  1   \n",
       "4                           1                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       1                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  1   \n",
       "14819                       2                  0   \n",
       "\n",
       "       offer_4_accidentallycompleted  offer_4_ignored  offer_4_didnotcomplete  \\\n",
       "0                                  1                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                1                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              1                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_5_completed  offer_5_accidentallycompleted  offer_5_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      0                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_5_didnotcomplete  offer_6_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       1                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  1   \n",
       "\n",
       "       offer_6_accidentallycompleted  offer_6_ignored  offer_6_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                1                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                1                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_7_completed  offer_7_accidentallycompleted  offer_7_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      0                              0                0   \n",
       "2                      1                              0                0   \n",
       "3                      1                              0                0   \n",
       "4                      1                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_7_didnotcomplete  offer_8_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  1   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  1   \n",
       "14818                       0                  0   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_8_accidentallycompleted  offer_8_ignored  offer_8_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                1                       0   \n",
       "14816                              0                1                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_9_completed  offer_9_accidentallycompleted  offer_9_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      1                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      2                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  1                              0                0   \n",
       "\n",
       "       offer_9_didnotcomplete  offer_10_completed  \\\n",
       "0                           0                   0   \n",
       "1                           0                   0   \n",
       "2                           0                   0   \n",
       "3                           0                   1   \n",
       "4                           0                   0   \n",
       "...                       ...                 ...   \n",
       "14815                       0                   0   \n",
       "14816                       0                   0   \n",
       "14817                       0                   0   \n",
       "14818                       0                   0   \n",
       "14819                       0                   0   \n",
       "\n",
       "       offer_10_accidentallycompleted  offer_10_ignored  \\\n",
       "0                                   0                 0   \n",
       "1                                   0                 0   \n",
       "2                                   0                 1   \n",
       "3                                   0                 0   \n",
       "4                                   0                 0   \n",
       "...                               ...               ...   \n",
       "14815                               0                 0   \n",
       "14816                               0                 0   \n",
       "14817                               0                 0   \n",
       "14818                               0                 0   \n",
       "14819                               0                 0   \n",
       "\n",
       "       offer_10_didnotcomplete  amount  \n",
       "0                            0   77.01  \n",
       "1                            0  159.27  \n",
       "2                            0   57.73  \n",
       "3                            0   36.43  \n",
       "4                            0   15.62  \n",
       "...                        ...     ...  \n",
       "14815                        0   20.03  \n",
       "14816                        0   25.97  \n",
       "14817                        0   39.74  \n",
       "14818                        0  189.67  \n",
       "14819                        0  143.02  \n",
       "\n",
       "[14820 rows x 67 columns]"
      ]
     },
     "execution_count": 285,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_profile=final_profile[~final_profile.isin(Customers_with_no_offers)]\n",
    "final_profile"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 286,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "False"
      ]
     },
     "execution_count": 286,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_profile.isnull().values.any()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 287,
   "metadata": {},
   "outputs": [],
   "source": [
    "filename = 'data/final_profile.csv'\n",
    "\n",
    "final_profile.to_csv(filename, index=False,mode='w+')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Data Visualization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 288,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>income</th>\n",
       "      <th>year_joined</th>\n",
       "      <th>reward</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_2_received</th>\n",
       "      <th>offer_2_viewed</th>\n",
       "      <th>offer_3_received</th>\n",
       "      <th>offer_3_viewed</th>\n",
       "      <th>offer_4_received</th>\n",
       "      <th>offer_4_viewed</th>\n",
       "      <th>offer_5_received</th>\n",
       "      <th>offer_5_viewed</th>\n",
       "      <th>offer_6_received</th>\n",
       "      <th>offer_6_viewed</th>\n",
       "      <th>offer_7_received</th>\n",
       "      <th>offer_7_viewed</th>\n",
       "      <th>offer_8_received</th>\n",
       "      <th>offer_8_viewed</th>\n",
       "      <th>offer_9_received</th>\n",
       "      <th>offer_9_viewed</th>\n",
       "      <th>offer_10_received</th>\n",
       "      <th>offer_10_viewed</th>\n",
       "      <th>offer_1_completed</th>\n",
       "      <th>offer_1_accidentallycompleted</th>\n",
       "      <th>offer_1_ignored</th>\n",
       "      <th>offer_1_didnotcomplete</th>\n",
       "      <th>offer_2_completed</th>\n",
       "      <th>offer_2_accidentallycompleted</th>\n",
       "      <th>offer_2_ignored</th>\n",
       "      <th>offer_2_didnotcomplete</th>\n",
       "      <th>offer_3_completed</th>\n",
       "      <th>offer_3_accidentallycompleted</th>\n",
       "      <th>offer_3_ignored</th>\n",
       "      <th>offer_3_didnotcomplete</th>\n",
       "      <th>offer_4_completed</th>\n",
       "      <th>offer_4_accidentallycompleted</th>\n",
       "      <th>offer_4_ignored</th>\n",
       "      <th>offer_4_didnotcomplete</th>\n",
       "      <th>offer_5_completed</th>\n",
       "      <th>offer_5_accidentallycompleted</th>\n",
       "      <th>offer_5_ignored</th>\n",
       "      <th>offer_5_didnotcomplete</th>\n",
       "      <th>offer_6_completed</th>\n",
       "      <th>offer_6_accidentallycompleted</th>\n",
       "      <th>offer_6_ignored</th>\n",
       "      <th>offer_6_didnotcomplete</th>\n",
       "      <th>offer_7_completed</th>\n",
       "      <th>offer_7_accidentallycompleted</th>\n",
       "      <th>offer_7_ignored</th>\n",
       "      <th>offer_7_didnotcomplete</th>\n",
       "      <th>offer_8_completed</th>\n",
       "      <th>offer_8_accidentallycompleted</th>\n",
       "      <th>offer_8_ignored</th>\n",
       "      <th>offer_8_didnotcomplete</th>\n",
       "      <th>offer_9_completed</th>\n",
       "      <th>offer_9_accidentallycompleted</th>\n",
       "      <th>offer_9_ignored</th>\n",
       "      <th>offer_9_didnotcomplete</th>\n",
       "      <th>offer_10_completed</th>\n",
       "      <th>offer_10_accidentallycompleted</th>\n",
       "      <th>offer_10_ignored</th>\n",
       "      <th>offer_10_didnotcomplete</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>F</td>\n",
       "      <td>112000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>77.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>100000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>159.27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>68</td>\n",
       "      <td>M</td>\n",
       "      <td>70000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>57.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>65</td>\n",
       "      <td>M</td>\n",
       "      <td>53000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>36.43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>58</td>\n",
       "      <td>M</td>\n",
       "      <td>51000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>15.62</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   customer_id  age gender    income  year_joined  reward  offer_1_received  \\\n",
       "0            2   55      F  112000.0         2017       5                 0   \n",
       "1            4   75      F  100000.0         2017      20                 1   \n",
       "2            6   68      M   70000.0         2018       7                 0   \n",
       "3            9   65      M   53000.0         2018      19                 0   \n",
       "4           13   58      M   51000.0         2017       2                 0   \n",
       "\n",
       "   offer_1_viewed  offer_2_received  offer_2_viewed  offer_3_received  \\\n",
       "0               0                 0               0                 1   \n",
       "1               1                 0               0                 0   \n",
       "2               0                 0               0                 1   \n",
       "3               0                 0               0                 0   \n",
       "4               0                 0               0                 1   \n",
       "\n",
       "   offer_3_viewed  offer_4_received  offer_4_viewed  offer_5_received  \\\n",
       "0               0                 1               0                 0   \n",
       "1               0                 1               1                 0   \n",
       "2               0                 1               1                 0   \n",
       "3               0                 2               2                 0   \n",
       "4               0                 0               0                 0   \n",
       "\n",
       "   offer_5_viewed  offer_6_received  offer_6_viewed  offer_7_received  \\\n",
       "0               0                 0               0                 0   \n",
       "1               0                 0               0                 0   \n",
       "2               0                 0               0                 1   \n",
       "3               0                 0               0                 1   \n",
       "4               0                 1               1                 1   \n",
       "\n",
       "   offer_7_viewed  offer_8_received  offer_8_viewed  offer_9_received  \\\n",
       "0               0                 0               0                 0   \n",
       "1               0                 1               1                 1   \n",
       "2               1                 0               0                 0   \n",
       "3               1                 0               0                 2   \n",
       "4               1                 0               0                 0   \n",
       "\n",
       "   offer_9_viewed  offer_10_received  offer_10_viewed  offer_1_completed  \\\n",
       "0               0                  0                0                  0   \n",
       "1               1                  0                0                  1   \n",
       "2               0                  1                1                  0   \n",
       "3               2                  1                1                  0   \n",
       "4               0                  0                0                  0   \n",
       "\n",
       "   offer_1_accidentallycompleted  offer_1_ignored  offer_1_didnotcomplete  \\\n",
       "0                              0                0                       0   \n",
       "1                              0                0                       0   \n",
       "2                              0                0                       0   \n",
       "3                              0                0                       0   \n",
       "4                              0                0                       0   \n",
       "\n",
       "   offer_2_completed  offer_2_accidentallycompleted  offer_2_ignored  \\\n",
       "0                  0                              0                0   \n",
       "1                  0                              0                0   \n",
       "2                  0                              0                0   \n",
       "3                  0                              0                0   \n",
       "4                  0                              0                0   \n",
       "\n",
       "   offer_2_didnotcomplete  offer_3_completed  offer_3_accidentallycompleted  \\\n",
       "0                       0                  0                              1   \n",
       "1                       0                  0                              0   \n",
       "2                       0                  0                              0   \n",
       "3                       0                  0                              0   \n",
       "4                       0                  0                              0   \n",
       "\n",
       "   offer_3_ignored  offer_3_didnotcomplete  offer_4_completed  \\\n",
       "0                0                       0                  0   \n",
       "1                0                       0                  1   \n",
       "2                0                       1                  1   \n",
       "3                0                       0                  1   \n",
       "4                0                       1                  0   \n",
       "\n",
       "   offer_4_accidentallycompleted  offer_4_ignored  offer_4_didnotcomplete  \\\n",
       "0                              1                0                       0   \n",
       "1                              0                0                       0   \n",
       "2                              0                0                       0   \n",
       "3                              0                1                       0   \n",
       "4                              0                0                       0   \n",
       "\n",
       "   offer_5_completed  offer_5_accidentallycompleted  offer_5_ignored  \\\n",
       "0                  0                              0                0   \n",
       "1                  0                              0                0   \n",
       "2                  0                              0                0   \n",
       "3                  0                              0                0   \n",
       "4                  0                              0                0   \n",
       "\n",
       "   offer_5_didnotcomplete  offer_6_completed  offer_6_accidentallycompleted  \\\n",
       "0                       0                  0                              0   \n",
       "1                       0                  0                              0   \n",
       "2                       0                  0                              0   \n",
       "3                       0                  0                              0   \n",
       "4                       0                  0                              0   \n",
       "\n",
       "   offer_6_ignored  offer_6_didnotcomplete  offer_7_completed  \\\n",
       "0                0                       0                  0   \n",
       "1                0                       0                  0   \n",
       "2                0                       0                  1   \n",
       "3                0                       0                  1   \n",
       "4                1                       0                  1   \n",
       "\n",
       "   offer_7_accidentallycompleted  offer_7_ignored  offer_7_didnotcomplete  \\\n",
       "0                              0                0                       0   \n",
       "1                              0                0                       0   \n",
       "2                              0                0                       0   \n",
       "3                              0                0                       0   \n",
       "4                              0                0                       0   \n",
       "\n",
       "   offer_8_completed  offer_8_accidentallycompleted  offer_8_ignored  \\\n",
       "0                  0                              0                0   \n",
       "1                  1                              0                0   \n",
       "2                  0                              0                0   \n",
       "3                  0                              0                0   \n",
       "4                  0                              0                0   \n",
       "\n",
       "   offer_8_didnotcomplete  offer_9_completed  offer_9_accidentallycompleted  \\\n",
       "0                       0                  0                              0   \n",
       "1                       0                  1                              0   \n",
       "2                       0                  0                              0   \n",
       "3                       0                  2                              0   \n",
       "4                       0                  0                              0   \n",
       "\n",
       "   offer_9_ignored  offer_9_didnotcomplete  offer_10_completed  \\\n",
       "0                0                       0                   0   \n",
       "1                0                       0                   0   \n",
       "2                0                       0                   0   \n",
       "3                0                       0                   1   \n",
       "4                0                       0                   0   \n",
       "\n",
       "   offer_10_accidentallycompleted  offer_10_ignored  offer_10_didnotcomplete  \\\n",
       "0                               0                 0                        0   \n",
       "1                               0                 0                        0   \n",
       "2                               0                 1                        0   \n",
       "3                               0                 0                        0   \n",
       "4                               0                 0                        0   \n",
       "\n",
       "   amount  \n",
       "0   77.01  \n",
       "1  159.27  \n",
       "2   57.73  \n",
       "3   36.43  \n",
       "4   15.62  "
      ]
     },
     "execution_count": 288,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_profile.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 289,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "14820"
      ]
     },
     "execution_count": 289,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_profile.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 290,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "67"
      ]
     },
     "execution_count": 290,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_profile.shape[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 291,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 14820 entries, 0 to 14819\n",
      "Data columns (total 67 columns):\n",
      " #   Column                          Non-Null Count  Dtype  \n",
      "---  ------                          --------------  -----  \n",
      " 0   customer_id                     14820 non-null  int64  \n",
      " 1   age                             14820 non-null  int64  \n",
      " 2   gender                          14820 non-null  object \n",
      " 3   income                          14820 non-null  float64\n",
      " 4   year_joined                     14820 non-null  int64  \n",
      " 5   reward                          14820 non-null  int64  \n",
      " 6   offer_1_received                14820 non-null  int32  \n",
      " 7   offer_1_viewed                  14820 non-null  int32  \n",
      " 8   offer_2_received                14820 non-null  int32  \n",
      " 9   offer_2_viewed                  14820 non-null  int32  \n",
      " 10  offer_3_received                14820 non-null  int32  \n",
      " 11  offer_3_viewed                  14820 non-null  int32  \n",
      " 12  offer_4_received                14820 non-null  int32  \n",
      " 13  offer_4_viewed                  14820 non-null  int32  \n",
      " 14  offer_5_received                14820 non-null  int32  \n",
      " 15  offer_5_viewed                  14820 non-null  int32  \n",
      " 16  offer_6_received                14820 non-null  int32  \n",
      " 17  offer_6_viewed                  14820 non-null  int32  \n",
      " 18  offer_7_received                14820 non-null  int32  \n",
      " 19  offer_7_viewed                  14820 non-null  int32  \n",
      " 20  offer_8_received                14820 non-null  int32  \n",
      " 21  offer_8_viewed                  14820 non-null  int32  \n",
      " 22  offer_9_received                14820 non-null  int32  \n",
      " 23  offer_9_viewed                  14820 non-null  int32  \n",
      " 24  offer_10_received               14820 non-null  int32  \n",
      " 25  offer_10_viewed                 14820 non-null  int32  \n",
      " 26  offer_1_completed               14820 non-null  int64  \n",
      " 27  offer_1_accidentallycompleted   14820 non-null  int64  \n",
      " 28  offer_1_ignored                 14820 non-null  int64  \n",
      " 29  offer_1_didnotcomplete          14820 non-null  int64  \n",
      " 30  offer_2_completed               14820 non-null  int64  \n",
      " 31  offer_2_accidentallycompleted   14820 non-null  int64  \n",
      " 32  offer_2_ignored                 14820 non-null  int64  \n",
      " 33  offer_2_didnotcomplete          14820 non-null  int64  \n",
      " 34  offer_3_completed               14820 non-null  int64  \n",
      " 35  offer_3_accidentallycompleted   14820 non-null  int64  \n",
      " 36  offer_3_ignored                 14820 non-null  int64  \n",
      " 37  offer_3_didnotcomplete          14820 non-null  int64  \n",
      " 38  offer_4_completed               14820 non-null  int64  \n",
      " 39  offer_4_accidentallycompleted   14820 non-null  int64  \n",
      " 40  offer_4_ignored                 14820 non-null  int64  \n",
      " 41  offer_4_didnotcomplete          14820 non-null  int64  \n",
      " 42  offer_5_completed               14820 non-null  int64  \n",
      " 43  offer_5_accidentallycompleted   14820 non-null  int64  \n",
      " 44  offer_5_ignored                 14820 non-null  int64  \n",
      " 45  offer_5_didnotcomplete          14820 non-null  int64  \n",
      " 46  offer_6_completed               14820 non-null  int64  \n",
      " 47  offer_6_accidentallycompleted   14820 non-null  int64  \n",
      " 48  offer_6_ignored                 14820 non-null  int64  \n",
      " 49  offer_6_didnotcomplete          14820 non-null  int64  \n",
      " 50  offer_7_completed               14820 non-null  int64  \n",
      " 51  offer_7_accidentallycompleted   14820 non-null  int64  \n",
      " 52  offer_7_ignored                 14820 non-null  int64  \n",
      " 53  offer_7_didnotcomplete          14820 non-null  int64  \n",
      " 54  offer_8_completed               14820 non-null  int64  \n",
      " 55  offer_8_accidentallycompleted   14820 non-null  int64  \n",
      " 56  offer_8_ignored                 14820 non-null  int64  \n",
      " 57  offer_8_didnotcomplete          14820 non-null  int64  \n",
      " 58  offer_9_completed               14820 non-null  int64  \n",
      " 59  offer_9_accidentallycompleted   14820 non-null  int64  \n",
      " 60  offer_9_ignored                 14820 non-null  int64  \n",
      " 61  offer_9_didnotcomplete          14820 non-null  int64  \n",
      " 62  offer_10_completed              14820 non-null  int64  \n",
      " 63  offer_10_accidentallycompleted  14820 non-null  int64  \n",
      " 64  offer_10_ignored                14820 non-null  int64  \n",
      " 65  offer_10_didnotcomplete         14820 non-null  int64  \n",
      " 66  amount                          14820 non-null  float64\n",
      "dtypes: float64(2), int32(20), int64(44), object(1)\n",
      "memory usage: 6.6+ MB\n"
     ]
    }
   ],
   "source": [
    "final_profile.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 292,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>age</th>\n",
       "      <th>income</th>\n",
       "      <th>year_joined</th>\n",
       "      <th>reward</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_2_received</th>\n",
       "      <th>offer_2_viewed</th>\n",
       "      <th>offer_3_received</th>\n",
       "      <th>offer_3_viewed</th>\n",
       "      <th>offer_4_received</th>\n",
       "      <th>offer_4_viewed</th>\n",
       "      <th>offer_5_received</th>\n",
       "      <th>offer_5_viewed</th>\n",
       "      <th>offer_6_received</th>\n",
       "      <th>offer_6_viewed</th>\n",
       "      <th>offer_7_received</th>\n",
       "      <th>offer_7_viewed</th>\n",
       "      <th>offer_8_received</th>\n",
       "      <th>offer_8_viewed</th>\n",
       "      <th>offer_9_received</th>\n",
       "      <th>offer_9_viewed</th>\n",
       "      <th>offer_10_received</th>\n",
       "      <th>offer_10_viewed</th>\n",
       "      <th>offer_1_completed</th>\n",
       "      <th>offer_1_accidentallycompleted</th>\n",
       "      <th>offer_1_ignored</th>\n",
       "      <th>offer_1_didnotcomplete</th>\n",
       "      <th>offer_2_completed</th>\n",
       "      <th>offer_2_accidentallycompleted</th>\n",
       "      <th>offer_2_ignored</th>\n",
       "      <th>offer_2_didnotcomplete</th>\n",
       "      <th>offer_3_completed</th>\n",
       "      <th>offer_3_accidentallycompleted</th>\n",
       "      <th>offer_3_ignored</th>\n",
       "      <th>offer_3_didnotcomplete</th>\n",
       "      <th>offer_4_completed</th>\n",
       "      <th>offer_4_accidentallycompleted</th>\n",
       "      <th>offer_4_ignored</th>\n",
       "      <th>offer_4_didnotcomplete</th>\n",
       "      <th>offer_5_completed</th>\n",
       "      <th>offer_5_accidentallycompleted</th>\n",
       "      <th>offer_5_ignored</th>\n",
       "      <th>offer_5_didnotcomplete</th>\n",
       "      <th>offer_6_completed</th>\n",
       "      <th>offer_6_accidentallycompleted</th>\n",
       "      <th>offer_6_ignored</th>\n",
       "      <th>offer_6_didnotcomplete</th>\n",
       "      <th>offer_7_completed</th>\n",
       "      <th>offer_7_accidentallycompleted</th>\n",
       "      <th>offer_7_ignored</th>\n",
       "      <th>offer_7_didnotcomplete</th>\n",
       "      <th>offer_8_completed</th>\n",
       "      <th>offer_8_accidentallycompleted</th>\n",
       "      <th>offer_8_ignored</th>\n",
       "      <th>offer_8_didnotcomplete</th>\n",
       "      <th>offer_9_completed</th>\n",
       "      <th>offer_9_accidentallycompleted</th>\n",
       "      <th>offer_9_ignored</th>\n",
       "      <th>offer_9_didnotcomplete</th>\n",
       "      <th>offer_10_completed</th>\n",
       "      <th>offer_10_accidentallycompleted</th>\n",
       "      <th>offer_10_ignored</th>\n",
       "      <th>offer_10_didnotcomplete</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "      <td>14820.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>8497.895682</td>\n",
       "      <td>54.389069</td>\n",
       "      <td>65406.882591</td>\n",
       "      <td>2016.620243</td>\n",
       "      <td>10.832726</td>\n",
       "      <td>0.450945</td>\n",
       "      <td>0.398178</td>\n",
       "      <td>0.444872</td>\n",
       "      <td>0.427058</td>\n",
       "      <td>0.449190</td>\n",
       "      <td>0.235290</td>\n",
       "      <td>0.451080</td>\n",
       "      <td>0.236100</td>\n",
       "      <td>0.453846</td>\n",
       "      <td>0.149460</td>\n",
       "      <td>0.449055</td>\n",
       "      <td>0.430432</td>\n",
       "      <td>0.448853</td>\n",
       "      <td>0.432321</td>\n",
       "      <td>0.448246</td>\n",
       "      <td>0.396289</td>\n",
       "      <td>0.443725</td>\n",
       "      <td>0.425776</td>\n",
       "      <td>0.447436</td>\n",
       "      <td>0.233468</td>\n",
       "      <td>0.274157</td>\n",
       "      <td>0.030229</td>\n",
       "      <td>0.124022</td>\n",
       "      <td>0.022537</td>\n",
       "      <td>0.259919</td>\n",
       "      <td>0.007355</td>\n",
       "      <td>0.167004</td>\n",
       "      <td>0.010594</td>\n",
       "      <td>0.157152</td>\n",
       "      <td>0.110459</td>\n",
       "      <td>0.078138</td>\n",
       "      <td>0.103441</td>\n",
       "      <td>0.184413</td>\n",
       "      <td>0.108367</td>\n",
       "      <td>0.051552</td>\n",
       "      <td>0.106748</td>\n",
       "      <td>0.104521</td>\n",
       "      <td>0.109379</td>\n",
       "      <td>0.044939</td>\n",
       "      <td>0.195007</td>\n",
       "      <td>0.318758</td>\n",
       "      <td>0.010864</td>\n",
       "      <td>0.111606</td>\n",
       "      <td>0.007827</td>\n",
       "      <td>0.328138</td>\n",
       "      <td>0.009379</td>\n",
       "      <td>0.104116</td>\n",
       "      <td>0.007220</td>\n",
       "      <td>0.261404</td>\n",
       "      <td>0.022874</td>\n",
       "      <td>0.134885</td>\n",
       "      <td>0.029082</td>\n",
       "      <td>0.293657</td>\n",
       "      <td>0.009514</td>\n",
       "      <td>0.132051</td>\n",
       "      <td>0.008502</td>\n",
       "      <td>0.171727</td>\n",
       "      <td>0.082794</td>\n",
       "      <td>0.061741</td>\n",
       "      <td>0.131174</td>\n",
       "      <td>117.050752</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>4896.011929</td>\n",
       "      <td>17.383172</td>\n",
       "      <td>21598.059614</td>\n",
       "      <td>1.198350</td>\n",
       "      <td>9.279519</td>\n",
       "      <td>0.644595</td>\n",
       "      <td>0.611723</td>\n",
       "      <td>0.638633</td>\n",
       "      <td>0.626266</td>\n",
       "      <td>0.644983</td>\n",
       "      <td>0.493328</td>\n",
       "      <td>0.646278</td>\n",
       "      <td>0.490333</td>\n",
       "      <td>0.646064</td>\n",
       "      <td>0.396689</td>\n",
       "      <td>0.647270</td>\n",
       "      <td>0.634037</td>\n",
       "      <td>0.641178</td>\n",
       "      <td>0.629757</td>\n",
       "      <td>0.645012</td>\n",
       "      <td>0.609637</td>\n",
       "      <td>0.644319</td>\n",
       "      <td>0.631054</td>\n",
       "      <td>0.647661</td>\n",
       "      <td>0.488356</td>\n",
       "      <td>0.529391</td>\n",
       "      <td>0.171224</td>\n",
       "      <td>0.368110</td>\n",
       "      <td>0.155965</td>\n",
       "      <td>0.513453</td>\n",
       "      <td>0.085448</td>\n",
       "      <td>0.414305</td>\n",
       "      <td>0.103693</td>\n",
       "      <td>0.406356</td>\n",
       "      <td>0.313471</td>\n",
       "      <td>0.285455</td>\n",
       "      <td>0.347397</td>\n",
       "      <td>0.437234</td>\n",
       "      <td>0.310854</td>\n",
       "      <td>0.236465</td>\n",
       "      <td>0.350943</td>\n",
       "      <td>0.333388</td>\n",
       "      <td>0.312125</td>\n",
       "      <td>0.221045</td>\n",
       "      <td>0.470496</td>\n",
       "      <td>0.562462</td>\n",
       "      <td>0.103665</td>\n",
       "      <td>0.354604</td>\n",
       "      <td>0.089646</td>\n",
       "      <td>0.569679</td>\n",
       "      <td>0.096394</td>\n",
       "      <td>0.341512</td>\n",
       "      <td>0.085459</td>\n",
       "      <td>0.507141</td>\n",
       "      <td>0.149508</td>\n",
       "      <td>0.367680</td>\n",
       "      <td>0.174736</td>\n",
       "      <td>0.539549</td>\n",
       "      <td>0.097079</td>\n",
       "      <td>0.376675</td>\n",
       "      <td>0.092549</td>\n",
       "      <td>0.426527</td>\n",
       "      <td>0.275579</td>\n",
       "      <td>0.251925</td>\n",
       "      <td>0.389743</td>\n",
       "      <td>129.980014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>2.000000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>30000.000000</td>\n",
       "      <td>2013.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>4273.750000</td>\n",
       "      <td>42.000000</td>\n",
       "      <td>49000.000000</td>\n",
       "      <td>2016.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>31.457500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>8491.500000</td>\n",
       "      <td>55.000000</td>\n",
       "      <td>64000.000000</td>\n",
       "      <td>2017.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>87.075000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>12731.750000</td>\n",
       "      <td>66.000000</td>\n",
       "      <td>80000.000000</td>\n",
       "      <td>2017.000000</td>\n",
       "      <td>17.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>160.972500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>17000.000000</td>\n",
       "      <td>101.000000</td>\n",
       "      <td>120000.000000</td>\n",
       "      <td>2018.000000</td>\n",
       "      <td>55.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1608.690000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        customer_id           age         income   year_joined        reward  \\\n",
       "count  14820.000000  14820.000000   14820.000000  14820.000000  14820.000000   \n",
       "mean    8497.895682     54.389069   65406.882591   2016.620243     10.832726   \n",
       "std     4896.011929     17.383172   21598.059614      1.198350      9.279519   \n",
       "min        2.000000     18.000000   30000.000000   2013.000000      0.000000   \n",
       "25%     4273.750000     42.000000   49000.000000   2016.000000      3.000000   \n",
       "50%     8491.500000     55.000000   64000.000000   2017.000000     10.000000   \n",
       "75%    12731.750000     66.000000   80000.000000   2017.000000     17.000000   \n",
       "max    17000.000000    101.000000  120000.000000   2018.000000     55.000000   \n",
       "\n",
       "       offer_1_received  offer_1_viewed  offer_2_received  offer_2_viewed  \\\n",
       "count      14820.000000    14820.000000      14820.000000    14820.000000   \n",
       "mean           0.450945        0.398178          0.444872        0.427058   \n",
       "std            0.644595        0.611723          0.638633        0.626266   \n",
       "min            0.000000        0.000000          0.000000        0.000000   \n",
       "25%            0.000000        0.000000          0.000000        0.000000   \n",
       "50%            0.000000        0.000000          0.000000        0.000000   \n",
       "75%            1.000000        1.000000          1.000000        1.000000   \n",
       "max            4.000000        4.000000          4.000000        4.000000   \n",
       "\n",
       "       offer_3_received  offer_3_viewed  offer_4_received  offer_4_viewed  \\\n",
       "count      14820.000000    14820.000000      14820.000000    14820.000000   \n",
       "mean           0.449190        0.235290          0.451080        0.236100   \n",
       "std            0.644983        0.493328          0.646278        0.490333   \n",
       "min            0.000000        0.000000          0.000000        0.000000   \n",
       "25%            0.000000        0.000000          0.000000        0.000000   \n",
       "50%            0.000000        0.000000          0.000000        0.000000   \n",
       "75%            1.000000        0.000000          1.000000        0.000000   \n",
       "max            4.000000        4.000000          4.000000        4.000000   \n",
       "\n",
       "       offer_5_received  offer_5_viewed  offer_6_received  offer_6_viewed  \\\n",
       "count      14820.000000    14820.000000      14820.000000    14820.000000   \n",
       "mean           0.453846        0.149460          0.449055        0.430432   \n",
       "std            0.646064        0.396689          0.647270        0.634037   \n",
       "min            0.000000        0.000000          0.000000        0.000000   \n",
       "25%            0.000000        0.000000          0.000000        0.000000   \n",
       "50%            0.000000        0.000000          0.000000        0.000000   \n",
       "75%            1.000000        0.000000          1.000000        1.000000   \n",
       "max            5.000000        3.000000          4.000000        4.000000   \n",
       "\n",
       "       offer_7_received  offer_7_viewed  offer_8_received  offer_8_viewed  \\\n",
       "count      14820.000000    14820.000000      14820.000000    14820.000000   \n",
       "mean           0.448853        0.432321          0.448246        0.396289   \n",
       "std            0.641178        0.629757          0.645012        0.609637   \n",
       "min            0.000000        0.000000          0.000000        0.000000   \n",
       "25%            0.000000        0.000000          0.000000        0.000000   \n",
       "50%            0.000000        0.000000          0.000000        0.000000   \n",
       "75%            1.000000        1.000000          1.000000        1.000000   \n",
       "max            4.000000        4.000000          5.000000        5.000000   \n",
       "\n",
       "       offer_9_received  offer_9_viewed  offer_10_received  offer_10_viewed  \\\n",
       "count      14820.000000    14820.000000       14820.000000     14820.000000   \n",
       "mean           0.443725        0.425776           0.447436         0.233468   \n",
       "std            0.644319        0.631054           0.647661         0.488356   \n",
       "min            0.000000        0.000000           0.000000         0.000000   \n",
       "25%            0.000000        0.000000           0.000000         0.000000   \n",
       "50%            0.000000        0.000000           0.000000         0.000000   \n",
       "75%            1.000000        1.000000           1.000000         0.000000   \n",
       "max            5.000000        5.000000           4.000000         4.000000   \n",
       "\n",
       "       offer_1_completed  offer_1_accidentallycompleted  offer_1_ignored  \\\n",
       "count       14820.000000                   14820.000000     14820.000000   \n",
       "mean            0.274157                       0.030229         0.124022   \n",
       "std             0.529391                       0.171224         0.368110   \n",
       "min             0.000000                       0.000000         0.000000   \n",
       "25%             0.000000                       0.000000         0.000000   \n",
       "50%             0.000000                       0.000000         0.000000   \n",
       "75%             0.000000                       0.000000         0.000000   \n",
       "max             4.000000                       1.000000         3.000000   \n",
       "\n",
       "       offer_1_didnotcomplete  offer_2_completed  \\\n",
       "count            14820.000000       14820.000000   \n",
       "mean                 0.022537           0.259919   \n",
       "std                  0.155965           0.513453   \n",
       "min                  0.000000           0.000000   \n",
       "25%                  0.000000           0.000000   \n",
       "50%                  0.000000           0.000000   \n",
       "75%                  0.000000           0.000000   \n",
       "max                  2.000000           4.000000   \n",
       "\n",
       "       offer_2_accidentallycompleted  offer_2_ignored  offer_2_didnotcomplete  \\\n",
       "count                   14820.000000     14820.000000            14820.000000   \n",
       "mean                        0.007355         0.167004                0.010594   \n",
       "std                         0.085448         0.414305                0.103693   \n",
       "min                         0.000000         0.000000                0.000000   \n",
       "25%                         0.000000         0.000000                0.000000   \n",
       "50%                         0.000000         0.000000                0.000000   \n",
       "75%                         0.000000         0.000000                0.000000   \n",
       "max                         1.000000         4.000000                2.000000   \n",
       "\n",
       "       offer_3_completed  offer_3_accidentallycompleted  offer_3_ignored  \\\n",
       "count       14820.000000                   14820.000000     14820.000000   \n",
       "mean            0.157152                       0.110459         0.078138   \n",
       "std             0.406356                       0.313471         0.285455   \n",
       "min             0.000000                       0.000000         0.000000   \n",
       "25%             0.000000                       0.000000         0.000000   \n",
       "50%             0.000000                       0.000000         0.000000   \n",
       "75%             0.000000                       0.000000         0.000000   \n",
       "max             4.000000                       1.000000         3.000000   \n",
       "\n",
       "       offer_3_didnotcomplete  offer_4_completed  \\\n",
       "count            14820.000000       14820.000000   \n",
       "mean                 0.103441           0.184413   \n",
       "std                  0.347397           0.437234   \n",
       "min                  0.000000           0.000000   \n",
       "25%                  0.000000           0.000000   \n",
       "50%                  0.000000           0.000000   \n",
       "75%                  0.000000           0.000000   \n",
       "max                  4.000000           4.000000   \n",
       "\n",
       "       offer_4_accidentallycompleted  offer_4_ignored  offer_4_didnotcomplete  \\\n",
       "count                   14820.000000     14820.000000            14820.000000   \n",
       "mean                        0.108367         0.051552                0.106748   \n",
       "std                         0.310854         0.236465                0.350943   \n",
       "min                         0.000000         0.000000                0.000000   \n",
       "25%                         0.000000         0.000000                0.000000   \n",
       "50%                         0.000000         0.000000                0.000000   \n",
       "75%                         0.000000         0.000000                0.000000   \n",
       "max                         1.000000         3.000000                3.000000   \n",
       "\n",
       "       offer_5_completed  offer_5_accidentallycompleted  offer_5_ignored  \\\n",
       "count       14820.000000                   14820.000000     14820.000000   \n",
       "mean            0.104521                       0.109379         0.044939   \n",
       "std             0.333388                       0.312125         0.221045   \n",
       "min             0.000000                       0.000000         0.000000   \n",
       "25%             0.000000                       0.000000         0.000000   \n",
       "50%             0.000000                       0.000000         0.000000   \n",
       "75%             0.000000                       0.000000         0.000000   \n",
       "max             3.000000                       1.000000         3.000000   \n",
       "\n",
       "       offer_5_didnotcomplete  offer_6_completed  \\\n",
       "count            14820.000000       14820.000000   \n",
       "mean                 0.195007           0.318758   \n",
       "std                  0.470496           0.562462   \n",
       "min                  0.000000           0.000000   \n",
       "25%                  0.000000           0.000000   \n",
       "50%                  0.000000           0.000000   \n",
       "75%                  0.000000           1.000000   \n",
       "max                  4.000000           4.000000   \n",
       "\n",
       "       offer_6_accidentallycompleted  offer_6_ignored  offer_6_didnotcomplete  \\\n",
       "count                   14820.000000     14820.000000            14820.000000   \n",
       "mean                        0.010864         0.111606                0.007827   \n",
       "std                         0.103665         0.354604                0.089646   \n",
       "min                         0.000000         0.000000                0.000000   \n",
       "25%                         0.000000         0.000000                0.000000   \n",
       "50%                         0.000000         0.000000                0.000000   \n",
       "75%                         0.000000         0.000000                0.000000   \n",
       "max                         1.000000         3.000000                2.000000   \n",
       "\n",
       "       offer_7_completed  offer_7_accidentallycompleted  offer_7_ignored  \\\n",
       "count       14820.000000                   14820.000000     14820.000000   \n",
       "mean            0.328138                       0.009379         0.104116   \n",
       "std             0.569679                       0.096394         0.341512   \n",
       "min             0.000000                       0.000000         0.000000   \n",
       "25%             0.000000                       0.000000         0.000000   \n",
       "50%             0.000000                       0.000000         0.000000   \n",
       "75%             1.000000                       0.000000         0.000000   \n",
       "max             3.000000                       1.000000         3.000000   \n",
       "\n",
       "       offer_7_didnotcomplete  offer_8_completed  \\\n",
       "count            14820.000000       14820.000000   \n",
       "mean                 0.007220           0.261404   \n",
       "std                  0.085459           0.507141   \n",
       "min                  0.000000           0.000000   \n",
       "25%                  0.000000           0.000000   \n",
       "50%                  0.000000           0.000000   \n",
       "75%                  0.000000           0.000000   \n",
       "max                  2.000000           4.000000   \n",
       "\n",
       "       offer_8_accidentallycompleted  offer_8_ignored  offer_8_didnotcomplete  \\\n",
       "count                   14820.000000     14820.000000            14820.000000   \n",
       "mean                        0.022874         0.134885                0.029082   \n",
       "std                         0.149508         0.367680                0.174736   \n",
       "min                         0.000000         0.000000                0.000000   \n",
       "25%                         0.000000         0.000000                0.000000   \n",
       "50%                         0.000000         0.000000                0.000000   \n",
       "75%                         0.000000         0.000000                0.000000   \n",
       "max                         1.000000         3.000000                2.000000   \n",
       "\n",
       "       offer_9_completed  offer_9_accidentallycompleted  offer_9_ignored  \\\n",
       "count       14820.000000                   14820.000000     14820.000000   \n",
       "mean            0.293657                       0.009514         0.132051   \n",
       "std             0.539549                       0.097079         0.376675   \n",
       "min             0.000000                       0.000000         0.000000   \n",
       "25%             0.000000                       0.000000         0.000000   \n",
       "50%             0.000000                       0.000000         0.000000   \n",
       "75%             1.000000                       0.000000         0.000000   \n",
       "max             3.000000                       1.000000         3.000000   \n",
       "\n",
       "       offer_9_didnotcomplete  offer_10_completed  \\\n",
       "count            14820.000000        14820.000000   \n",
       "mean                 0.008502            0.171727   \n",
       "std                  0.092549            0.426527   \n",
       "min                  0.000000            0.000000   \n",
       "25%                  0.000000            0.000000   \n",
       "50%                  0.000000            0.000000   \n",
       "75%                  0.000000            0.000000   \n",
       "max                  2.000000            4.000000   \n",
       "\n",
       "       offer_10_accidentallycompleted  offer_10_ignored  \\\n",
       "count                    14820.000000      14820.000000   \n",
       "mean                         0.082794          0.061741   \n",
       "std                          0.275579          0.251925   \n",
       "min                          0.000000          0.000000   \n",
       "25%                          0.000000          0.000000   \n",
       "50%                          0.000000          0.000000   \n",
       "75%                          0.000000          0.000000   \n",
       "max                          1.000000          3.000000   \n",
       "\n",
       "       offer_10_didnotcomplete        amount  \n",
       "count             14820.000000  14820.000000  \n",
       "mean                  0.131174    117.050752  \n",
       "std                   0.389743    129.980014  \n",
       "min                   0.000000      0.000000  \n",
       "25%                   0.000000     31.457500  \n",
       "50%                   0.000000     87.075000  \n",
       "75%                   0.000000    160.972500  \n",
       "max                   4.000000   1608.690000  "
      ]
     },
     "execution_count": 292,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_profile.describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 1. Every year, how many new customers sign up for an account at Starbucks?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 293,
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 294,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Text(0.5, 0, 'year'), Text(0, 0.5, 'Count')]"
      ]
     },
     "execution_count": 294,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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1i5Lcllv+Z4kc3/PdicnOXk99aVJdh+6DgEAALphOH5PIAAAAJsIIRAAAKBDhEAAAIAOEQIBAAA6RAgEAADoECEQAACgQ4RAAACADhECAQAAOkQIBAAA6BAhEAAAoEOEQAAAgA4RAgEAADpECAQAADYpDz74YObMmZMZM2Zk+vTpOfHEE9d9duqpp+YFL3hBpk+fng9+8IPr6tdee2323XffTJ8+PXvssUcefPDBJMmXv/zl7Lnnno/bvsvGjHQDAAAAA40dOzZLlizJNttsk4cffjgvetGLctBBB+W3v/1tFi1alGuvvTZjx47NqlWrkiR9fX15y1veknPOOSczZszIPffck6c85Sm555578oEPfCDXXHNNxo8fnwULFmTx4sWZO3fuCB/hyHIlEAAA2KRUVbbZZpskycMPP5yHH344VZXTTz89J5xwQsaOHZskmTBhQpLkoosuyp577pkZM2YkSZ797Gdn9OjRufXWW7PLLrtk/PjxSZJXvOIVOe+880bgiDYtQiAAALDJWbt2bWbOnJkJEybkgAMOyD777JObb745l19+efbZZ5+85CUvydVXX50kufnmm1NVmTdvXvbee+/8/d//fZLkT//0T3PTTTfltttuS19fX77xjW/kjjvuGMnD2iSYDgoAAGxyRo8eneXLl2f16tU55JBDcv3116evry/33ntvfvCDH+Tqq6/O4YcfnltvvTV9fX353ve+l6uvvjpbb7115s6dm1mzZmXu3Lk5/fTT88Y3vjGjRo3Kfvvtl1tvvXWkD23EuRIIAABssrbffvu89KUvzYUXXpjJkyfn0EMPTVVlzpw5GTVqVO6+++5Mnjw5L3nJSzJu3LhsvfXWedWrXpVly5YlSV772tfmyiuvzBVXXJEXvOAFmTp16ggf0cgTAgEAgE3KXXfdldWrVydJfvvb3+aSSy7JrrvumoMPPjhLlixJ0j8FdM2aNRk3blzmzZuXa6+9Ng888ED6+vryne98J9OmTUuSdQ+Puffee/OZz3wm73jHO0bkmDYlpoMCAMAW7uS3HDbSLWyU/3Pv/815V1ydR1pLa8nufzI5P/rSF9K39pGc/4OlOePT/5zRo0blwL33yP86cn6S5PlPG5Pn7ficJJVddnxOln/xrCz/4ln58veuzP+59/8mSV62x275yt/99Qge2R/mb/73Vwd1f0IgAACw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vPe9782BBx6Yr371q1mzZk0eeOCBXHrppVm0aFGuvfbajB07NqtWrUqSjBs3Lt/85jez44475vrrr8+8efPyi1/8YoSPAACAP4QQCB3061//Ot/97nfzhS98IUmy1VZbZauttsrpp5+eE044IWPHjk2STJgwIUmy1157rRs7ffr0PPjgg3nooYfWbQcAwObDdFDooFtvvTXjx4/P2972tuy11155xzvekfvvvz8333xzLr/88uyzzz55yUtekquvvvpxY88777zstddeAiAAwGZKCIQO6uvry7Jly3LMMcfkhz/8YZ7+9KfnlFNOSV9fX+6999784Ac/yD/8wz/k8MMPT2tt3bgbbrghH/rQh3LGGWeMYPcAAPwxhEDooMmTJ2fy5MnZZ599kiSHHXZYli1blsmTJ+fQQw9NVWXOnDkZNWpU7r777iTJihUrcsghh+Tss8/O85///JFsHwCAP4IQCB30nOc8J8997nPzk5/8JEmyePHiTJs2LQcffPC6J3/efPPNWbNmTcaNG5fVq1fn1a9+dT72sY9l//33H8nWAQD4I3kwDHTUqaeemje/+c1Zs2ZNdt5555x11ll5+tOfnqOOOiq77757ttpqqyxcuDBVldNOOy233HJLTjrppJx00klJkosuumjdg2MAANh8CIHwB7r97/YY6Rb+KM9K8rXX/W7tZ7nv1BfnviT/a5cku1SSh5PvvTe3fy95a5K3fmjnJGvXjX/wX+fm9mHueTDt9D+vG+kWAABGhOmgAAAAHSIEAgAAdIgQCAAA0CFCIAAAQIcIgQAAAB0iBAIAAHSIEAgAANAhQiAAAECHCIEAAAAdIgQCAAB0iBAIAADQIUIgAABAhwiBAAAAHSIEAgAAdIgQCAAA0CFCIAAAQIcIgQAAAB0iBAIAAHSIEAgAANAhQiAAAECHCIFbkDvuuCMve9nLsttuu2X69On553/+5yTJG9/4xsycOTMzZ87MlClTMnPmzEeNu/3227PNNtvkE5/4xAh0DQAADKcxI90Ag2fMmDH5x3/8x+y999657777MmvWrBxwwAH58pe/vG6b448/Ps94xjMeNe64447LQQcdNNztAgAAI0AI3IJMnDgxEydOTJJsu+222W233fKLX/wi06ZNS5K01nLuuedmyZIl68Z84xvfyM4775ynP/3pI9IzAAAwvEwH3ULddttt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\n",
      "text/plain": [
       "<Figure size 1080x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "labels=profile['year_joined'].value_counts().index.values.tolist()\n",
    "values=profile['year_joined'].value_counts().values.tolist()\n",
    "\n",
    "\n",
    "plt.figure(figsize = (15, 8))\n",
    "ax = sns.barplot(x=labels, y=values)\n",
    "labels, values = zip(*sorted(zip(labels, values)))\n",
    "for i, p in enumerate(ax.patches):\n",
    "    height = p.get_height()\n",
    "    ax.text(p.get_x()+p.get_width()/2., height + 0.1,values[i],ha=\"center\")\n",
    "ax.set(xlabel='year', ylabel='Count')\n",
    "    \n",
    "#code_reference : https://stackoverflow.com/questions/55104819/display-count-on-top-of-seaborn-barplot"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The Starbucks app has experienced consistent growth of over 100% from 2013 to 2016.In 2017, 6465 customers signed up and created an account in Starbucks  app, an increase of 83.4% over 2016. 2018 saw a dip 35% from 2017 with only 4198 customers creating an account in the app."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 295,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>income</th>\n",
       "      <th>year_joined</th>\n",
       "      <th>reward</th>\n",
       "      <th>offer_1_received</th>\n",
       "      <th>offer_1_viewed</th>\n",
       "      <th>offer_2_received</th>\n",
       "      <th>offer_2_viewed</th>\n",
       "      <th>offer_3_received</th>\n",
       "      <th>offer_3_viewed</th>\n",
       "      <th>offer_4_received</th>\n",
       "      <th>offer_4_viewed</th>\n",
       "      <th>offer_5_received</th>\n",
       "      <th>offer_5_viewed</th>\n",
       "      <th>offer_6_received</th>\n",
       "      <th>offer_6_viewed</th>\n",
       "      <th>offer_7_received</th>\n",
       "      <th>offer_7_viewed</th>\n",
       "      <th>offer_8_received</th>\n",
       "      <th>offer_8_viewed</th>\n",
       "      <th>offer_9_received</th>\n",
       "      <th>offer_9_viewed</th>\n",
       "      <th>offer_10_received</th>\n",
       "      <th>offer_10_viewed</th>\n",
       "      <th>offer_1_completed</th>\n",
       "      <th>offer_1_accidentallycompleted</th>\n",
       "      <th>offer_1_ignored</th>\n",
       "      <th>offer_1_didnotcomplete</th>\n",
       "      <th>offer_2_completed</th>\n",
       "      <th>offer_2_accidentallycompleted</th>\n",
       "      <th>offer_2_ignored</th>\n",
       "      <th>offer_2_didnotcomplete</th>\n",
       "      <th>offer_3_completed</th>\n",
       "      <th>offer_3_accidentallycompleted</th>\n",
       "      <th>offer_3_ignored</th>\n",
       "      <th>offer_3_didnotcomplete</th>\n",
       "      <th>offer_4_completed</th>\n",
       "      <th>offer_4_accidentallycompleted</th>\n",
       "      <th>offer_4_ignored</th>\n",
       "      <th>offer_4_didnotcomplete</th>\n",
       "      <th>offer_5_completed</th>\n",
       "      <th>offer_5_accidentallycompleted</th>\n",
       "      <th>offer_5_ignored</th>\n",
       "      <th>offer_5_didnotcomplete</th>\n",
       "      <th>offer_6_completed</th>\n",
       "      <th>offer_6_accidentallycompleted</th>\n",
       "      <th>offer_6_ignored</th>\n",
       "      <th>offer_6_didnotcomplete</th>\n",
       "      <th>offer_7_completed</th>\n",
       "      <th>offer_7_accidentallycompleted</th>\n",
       "      <th>offer_7_ignored</th>\n",
       "      <th>offer_7_didnotcomplete</th>\n",
       "      <th>offer_8_completed</th>\n",
       "      <th>offer_8_accidentallycompleted</th>\n",
       "      <th>offer_8_ignored</th>\n",
       "      <th>offer_8_didnotcomplete</th>\n",
       "      <th>offer_9_completed</th>\n",
       "      <th>offer_9_accidentallycompleted</th>\n",
       "      <th>offer_9_ignored</th>\n",
       "      <th>offer_9_didnotcomplete</th>\n",
       "      <th>offer_10_completed</th>\n",
       "      <th>offer_10_accidentallycompleted</th>\n",
       "      <th>offer_10_ignored</th>\n",
       "      <th>offer_10_didnotcomplete</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>F</td>\n",
       "      <td>112000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>77.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>100000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>159.27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>6</td>\n",
       "      <td>68</td>\n",
       "      <td>M</td>\n",
       "      <td>70000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>57.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>9</td>\n",
       "      <td>65</td>\n",
       "      <td>M</td>\n",
       "      <td>53000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>36.43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13</td>\n",
       "      <td>58</td>\n",
       "      <td>M</td>\n",
       "      <td>51000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>15.62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14815</th>\n",
       "      <td>16996</td>\n",
       "      <td>45</td>\n",
       "      <td>F</td>\n",
       "      <td>54000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>20.03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14816</th>\n",
       "      <td>16997</td>\n",
       "      <td>61</td>\n",
       "      <td>M</td>\n",
       "      <td>72000.0</td>\n",
       "      <td>2018</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>25.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14817</th>\n",
       "      <td>16998</td>\n",
       "      <td>49</td>\n",
       "      <td>M</td>\n",
       "      <td>73000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>39.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14818</th>\n",
       "      <td>16999</td>\n",
       "      <td>83</td>\n",
       "      <td>F</td>\n",
       "      <td>50000.0</td>\n",
       "      <td>2016</td>\n",
       "      <td>25</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>189.67</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14819</th>\n",
       "      <td>17000</td>\n",
       "      <td>62</td>\n",
       "      <td>F</td>\n",
       "      <td>82000.0</td>\n",
       "      <td>2017</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>143.02</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>14820 rows × 67 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       customer_id  age gender    income  year_joined  reward  \\\n",
       "0                2   55      F  112000.0         2017       5   \n",
       "1                4   75      F  100000.0         2017      20   \n",
       "2                6   68      M   70000.0         2018       7   \n",
       "3                9   65      M   53000.0         2018      19   \n",
       "4               13   58      M   51000.0         2017       2   \n",
       "...            ...  ...    ...       ...          ...     ...   \n",
       "14815        16996   45      F   54000.0         2018       0   \n",
       "14816        16997   61      M   72000.0         2018       5   \n",
       "14817        16998   49      M   73000.0         2017       0   \n",
       "14818        16999   83      F   50000.0         2016      25   \n",
       "14819        17000   62      F   82000.0         2017       8   \n",
       "\n",
       "       offer_1_received  offer_1_viewed  offer_2_received  offer_2_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     1               1                 0               0   \n",
       "2                     0               0                 0               0   \n",
       "3                     0               0                 0               0   \n",
       "4                     0               0                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 1               1   \n",
       "14816                 0               0                 0               0   \n",
       "14817                 0               0                 0               0   \n",
       "14818                 1               1                 1               1   \n",
       "14819                 0               0                 0               0   \n",
       "\n",
       "       offer_3_received  offer_3_viewed  offer_4_received  offer_4_viewed  \\\n",
       "0                     1               0                 1               0   \n",
       "1                     0               0                 1               1   \n",
       "2                     1               0                 1               1   \n",
       "3                     0               0                 2               2   \n",
       "4                     1               0                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 0               0   \n",
       "14816                 1               0                 1               0   \n",
       "14817                 1               0                 0               0   \n",
       "14818                 0               0                 1               1   \n",
       "14819                 2               0                 0               0   \n",
       "\n",
       "       offer_5_received  offer_5_viewed  offer_6_received  offer_6_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     0               0                 0               0   \n",
       "2                     0               0                 0               0   \n",
       "3                     0               0                 0               0   \n",
       "4                     0               0                 1               1   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 1               1   \n",
       "14816                 0               0                 0               0   \n",
       "14817                 1               0                 0               0   \n",
       "14818                 0               0                 0               0   \n",
       "14819                 0               0                 1               1   \n",
       "\n",
       "       offer_7_received  offer_7_viewed  offer_8_received  offer_8_viewed  \\\n",
       "0                     0               0                 0               0   \n",
       "1                     0               0                 1               1   \n",
       "2                     1               1                 0               0   \n",
       "3                     1               1                 0               0   \n",
       "4                     1               1                 0               0   \n",
       "...                 ...             ...               ...             ...   \n",
       "14815                 0               0                 1               1   \n",
       "14816                 0               0                 1               1   \n",
       "14817                 0               0                 1               1   \n",
       "14818                 0               0                 0               0   \n",
       "14819                 0               0                 0               0   \n",
       "\n",
       "       offer_9_received  offer_9_viewed  offer_10_received  offer_10_viewed  \\\n",
       "0                     0               0                  0                0   \n",
       "1                     1               1                  0                0   \n",
       "2                     0               0                  1                1   \n",
       "3                     2               2                  1                1   \n",
       "4                     0               0                  0                0   \n",
       "...                 ...             ...                ...              ...   \n",
       "14815                 0               0                  0                0   \n",
       "14816                 0               0                  0                0   \n",
       "14817                 0               0                  0                0   \n",
       "14818                 0               0                  0                0   \n",
       "14819                 1               1                  0                0   \n",
       "\n",
       "       offer_1_completed  offer_1_accidentallycompleted  offer_1_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      1                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  1                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_1_didnotcomplete  offer_2_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  1   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_2_accidentallycompleted  offer_2_ignored  offer_2_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                1                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_3_completed  offer_3_accidentallycompleted  offer_3_ignored  \\\n",
       "0                      0                              1                0   \n",
       "1                      0                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              1                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_3_didnotcomplete  offer_4_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  1   \n",
       "2                           1                  1   \n",
       "3                           0                  1   \n",
       "4                           1                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       1                  0   \n",
       "14817                       0                  0   \n",
       "14818                       0                  1   \n",
       "14819                       2                  0   \n",
       "\n",
       "       offer_4_accidentallycompleted  offer_4_ignored  offer_4_didnotcomplete  \\\n",
       "0                                  1                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                1                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                0                       0   \n",
       "14816                              1                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_5_completed  offer_5_accidentallycompleted  offer_5_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      0                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      0                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_5_didnotcomplete  offer_6_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  0   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       1                  0   \n",
       "14818                       0                  0   \n",
       "14819                       0                  1   \n",
       "\n",
       "       offer_6_accidentallycompleted  offer_6_ignored  offer_6_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                1                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                1                       0   \n",
       "14816                              0                0                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_7_completed  offer_7_accidentallycompleted  offer_7_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      0                              0                0   \n",
       "2                      1                              0                0   \n",
       "3                      1                              0                0   \n",
       "4                      1                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  0                              0                0   \n",
       "\n",
       "       offer_7_didnotcomplete  offer_8_completed  \\\n",
       "0                           0                  0   \n",
       "1                           0                  1   \n",
       "2                           0                  0   \n",
       "3                           0                  0   \n",
       "4                           0                  0   \n",
       "...                       ...                ...   \n",
       "14815                       0                  0   \n",
       "14816                       0                  0   \n",
       "14817                       0                  1   \n",
       "14818                       0                  0   \n",
       "14819                       0                  0   \n",
       "\n",
       "       offer_8_accidentallycompleted  offer_8_ignored  offer_8_didnotcomplete  \\\n",
       "0                                  0                0                       0   \n",
       "1                                  0                0                       0   \n",
       "2                                  0                0                       0   \n",
       "3                                  0                0                       0   \n",
       "4                                  0                0                       0   \n",
       "...                              ...              ...                     ...   \n",
       "14815                              0                1                       0   \n",
       "14816                              0                1                       0   \n",
       "14817                              0                0                       0   \n",
       "14818                              0                0                       0   \n",
       "14819                              0                0                       0   \n",
       "\n",
       "       offer_9_completed  offer_9_accidentallycompleted  offer_9_ignored  \\\n",
       "0                      0                              0                0   \n",
       "1                      1                              0                0   \n",
       "2                      0                              0                0   \n",
       "3                      2                              0                0   \n",
       "4                      0                              0                0   \n",
       "...                  ...                            ...              ...   \n",
       "14815                  0                              0                0   \n",
       "14816                  0                              0                0   \n",
       "14817                  0                              0                0   \n",
       "14818                  0                              0                0   \n",
       "14819                  1                              0                0   \n",
       "\n",
       "       offer_9_didnotcomplete  offer_10_completed  \\\n",
       "0                           0                   0   \n",
       "1                           0                   0   \n",
       "2                           0                   0   \n",
       "3                           0                   1   \n",
       "4                           0                   0   \n",
       "...                       ...                 ...   \n",
       "14815                       0                   0   \n",
       "14816                       0                   0   \n",
       "14817                       0                   0   \n",
       "14818                       0                   0   \n",
       "14819                       0                   0   \n",
       "\n",
       "       offer_10_accidentallycompleted  offer_10_ignored  \\\n",
       "0                                   0                 0   \n",
       "1                                   0                 0   \n",
       "2                                   0                 1   \n",
       "3                                   0                 0   \n",
       "4                                   0                 0   \n",
       "...                               ...               ...   \n",
       "14815                               0                 0   \n",
       "14816                               0                 0   \n",
       "14817                               0                 0   \n",
       "14818                               0                 0   \n",
       "14819                               0                 0   \n",
       "\n",
       "       offer_10_didnotcomplete  amount  \n",
       "0                            0   77.01  \n",
       "1                            0  159.27  \n",
       "2                            0   57.73  \n",
       "3                            0   36.43  \n",
       "4                            0   15.62  \n",
       "...                        ...     ...  \n",
       "14815                        0   20.03  \n",
       "14816                        0   25.97  \n",
       "14817                        0   39.74  \n",
       "14818                        0  189.67  \n",
       "14819                        0  143.02  \n",
       "\n",
       "[14820 rows x 67 columns]"
      ]
     },
     "execution_count": 295,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_profile"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "scrolled": false
   },
   "source": [
    "#### 2. What is the most and least completed offer among all the offers?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 296,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA4EAAAHhCAYAAADQwbu/AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAA2AElEQVR4nO3de5hWdb3//+cbxkRCPMFwjWBNEsY4HAaG1LaVChqoiCmaKKSVh43f3HmE7JuKW7+EuUuhbZ527R0qW8QzKnkIQoHcEMiIkgdISUbmB1Siohtkps/vj7mbBkQEnHtuZtbzcV33da/1Xof7vdYFA69Zn7XuSCkhSZIkScqGNoVuQJIkSZLUfAyBkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJkiRJGVJU6AbypVOnTqm0tLTQbUiSJElSQSxatOjPKaXOW9ZbbQgsLS1l4cKFhW5DkiRJkgoiIv60tbrDQSVJkiQpQwyBkiRJkpQhhkBJkiRJypC8hsCIWBERL0REVUQszNX2jYinImJZ7n2fRuv/ICKWR8QrETG4Ub0yt5/lEfGziIh89i1JkiRJrVVzXAk8KqVUkVIakJu/HJiZUuoBzMzNExEHAyOAcmAIcHNEtM1tcwtwHtAj9xrSDH1LkiRJUqtTiOGgJwKTc9OTga83qk9NKW1MKb0OLAcOiYgSoGNK6dmUUgLuaLSNJEmSJGkH5DsEJuDJiFgUEeflal1SSjUAuffiXL0rsLLRttW5Wtfc9JZ1SZIkSdIOyvf3BB6eUloVEcXAUxHx8jbW3dp9fmkb9Q/voD5ongfwmc98Zkd7lSRJkqRWL69XAlNKq3Lva4AHgUOA1bkhnuTe1+RWrwYOaLR5N2BVrt5tK/Wtfd7tKaUBKaUBnTt3bspDkSRJkqRWIW8hMCI+HRF7/n0a+BrwIjAdOCu32lnAw7np6cCIiNg9Ij5H/QNgFuSGjL4bEYflngp6ZqNtJEmSJEk7IJ/DQbsAD+a+zaEI+O+U0uMR8XtgWkScDbwBnAqQUloaEdOAPwC1wHdTSnW5fZ0P/ArYA/h17iVJkiRJ2kFR/8DN1mfAgAFp4cKFBfnsuro6BgwYQNeuXXn00Uepqqpi9OjRbNiwgaKiIm6++WYOOeQQAJYsWcI///M/884779CmTRt+//vf065dO4YMGUJNTQ21tbV85Stf4ec//zlt27b9mE+WJEmSpHoRsajRV/U1KMRXRLR6kyZNoqysrGF+7NixjBs3jqqqKq655hrGjh0LQG1tLaNGjeLWW29l6dKlzJ49m9122w2AadOm8fzzz/Piiy+ydu1a7r333oIciyRJkqTWxRDYxKqrq3nsscc455xzGmoRwTvvvAPA22+/zf777w/Ak08+SZ8+fejbty8A++23X8PVvo4dOwL1QfGDDz4gN6xWkiRJkj4RQ2ATu+iii7j++utp0+Yfp3bixImMGTOGAw44gMsuu4wJEyYA8OqrrxIRDB48mP79+3P99ddvtq/BgwdTXFzMnnvuySmnnNKsxyFJkiSpdTIENqFHH32U4uJiKisrN6vfcsst3HjjjaxcuZIbb7yRs88+G6i/yjd37lymTJnC3LlzefDBB5k5c2bDdk888QQ1NTVs3LiRWbNmNeuxSJIkSWqdDIFNaN68eUyfPp3S0lJGjBjBrFmzGDVqFJMnT+bkk08G4NRTT2XBggUAdOvWjSOOOIJOnTrRvn17jjvuOJ577rnN9tmuXTuGDRvGww/7rRiSJEmSPjlDYBOaMGEC1dXVrFixgqlTpzJw4EDuuusu9t9/f55++mkAZs2aRY8ePYD64Z5Llizh/fffp7a2lqeffpqDDz6Y9evXU1NTA9RfLZwxYwY9e/Ys2HFJkiRJaj3y+T2ByvmP//gPLrzwQmpra2nXrh233347APvssw+XXHIJX/ziF4kIjjvuOI4//nhWr17NsGHD2LhxI3V1dQwcOJDRo0cX+CgkSZIktQaZ/Z7AyjF3NGM3u7ZF/3ZmoVuQJEmS1MT8nkBJkiRJkiFQkiRJkrLEEChJkiRJGWII1C6vrq6Ofv36MXToUABOO+00KioqqKiooLS0lIqKCgCeeuopKisr6d27N5WVlVv9bsVhw4bRq1ev5mxfkiRJ2qX4dFDt8iZNmkRZWRnvvPMOAPfcc0/DsksvvZS99toLgE6dOvHII4+w//778+KLLzJ48GDefPPNhnUfeOABOnTo0LzNS5IkSbsYrwRql1ZdXc1jjz3GOeec86FlKSWmTZvG6aefDkC/fv3Yf//9ASgvL2fDhg1s3LgRgPXr13PDDTdwxRVXNF/zkiRJ0i7IEKhd2kUXXcT1119PmzYf/qM6Z84cunTpQo8ePT607P7776dfv37svvvuAFx55ZVceumltG/fPu89S5IkSbsyQ6B2WY8++ijFxcVUVlZudfndd9/dcBWwsaVLl/L973+f2267DYCqqiqWL1/OSSedlNd+JUmSpJbAewK1y5o3bx7Tp09nxowZbNiwgXfeeYdRo0Zx1113UVtbywMPPMCiRYs226a6upqTTjqJO+64g+7duwPw7LPPsmjRIkpLS6mtrWXNmjUceeSRzJ49uwBHJUmSJBWWVwK1y5owYQLV1dWsWLGCqVOnMnDgQO666y4AfvOb39CzZ0+6devWsP66des4/vjjmTBhAocffnhD/fzzz2fVqlWsWLGCuXPnctBBBxkAJUmSlFmGQLVIU6dO/dBQ0Jtuuonly5dz7bXXNnyFxJo1awrUoSRJkrRripRSoXvIiwEDBqSFCxd+5PLKMXc0Yze7tkX/duYn3scb1/Rugk5ah89c9UKhW5AkSZKIiEUppQFb1r0SKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOglDF1dXX069ePoUOHAnDllVfSp08fKioq+NrXvsaqVasAWLFiBXvssQcVFRVUVFQwevRoAN5//32OP/54evbsSXl5OZdffnnBjkWSJEk7zhAoZcykSZMoKytrmB8zZgxLliyhqqqKoUOHcs011zQs6969O1VVVVRVVXHrrbc21C+77DJefvllFi9ezLx58/j1r3/drMcgSZKknWcIlDKkurqaxx57jHPOOaeh1rFjx4bp9957j4jY5j7at2/PUUcdBcCnPvUp+vfvT3V1dX4aliRJUpMzBEoZctFFF3H99dfTps3mf/V/+MMfcsABBzBlypTNrgS+/vrr9OvXjyOOOII5c+Z8aH/r1q3jkUceYdCgQXnvXZIkSU3DEChlxKOPPkpxcTGVlZUfWjZ+/HhWrlzJyJEjuemmmwAoKSnhjTfeYPHixdxwww2cccYZvPPOOw3b1NbWcvrpp/O9732PAw88sNmOQ5IkSZ+MIVDKiHnz5jF9+nRKS0sZMWIEs2bNYtSoUZutc8YZZ3D//fcDsPvuu7PffvsBUFlZSffu3Xn11Vcb1j3vvPPo0aMHF110UbMdgyRJkj45Q6CUERMmTKC6upoVK1YwdepUBg4cyF133cWyZcsa1pk+fTo9e/YEYO3atdTV1QHw2muvsWzZsoYrfldccQVvv/02EydObPbjkCRJ0idTVOgGJBXW5ZdfziuvvEKbNm347Gc/2/AU0GeeeYarrrqKoqIi2rZty6233sq+++5LdXU148ePp2fPnvTv3x+ACy64YLOHzUiSJGnXFSmlQveQFwMGDEgLFy78yOWVY+5oxm52bYv+7cxPvI83rundBJ20Dp+56oVPtP3h/354E3XS8s37l3mFbkGSJKnFiohFKaUBW9YdDipJkiRJGWIIlCRJkqQMMQRKkiRJUoYYAiVJkiQpQwyBkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJkiRJGWIIlCRJkqQMMQRKkiRJUoYYAiVJkiQpQwyBkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJO6muro5+/foxdOhQAP76179yzDHH0KNHD4455hjeeuuthnWXLFnCl770JcrLy+nduzcbNmwAYMiQIfTt25fy8nJGjx5NXV1dQY5FkiRlhyFQknbSpEmTKCsra5i/7rrrGDRoEMuWLWPQoEFcd911ANTW1jJq1ChuvfVWli5dyuzZs9ltt90AmDZtGs8//zwvvvgia9eu5d577y3IsUiSpOwwBErSTqiuruaxxx7jnHPOaag9/PDDnHXWWQCcddZZPPTQQwA8+eST9OnTh759+wKw33770bZtWwA6duwI1AfFDz74gIhoxqOQJElZZAiUpJ1w0UUXcf3119OmzT9+jK5evZqSkhIASkpKWLNmDQCvvvoqEcHgwYPp378/119//Wb7Gjx4MMXFxey5556ccsopzXcQkiQpkwyBkrSDHn30UYqLi6msrNyu9Wtra5k7dy5Tpkxh7ty5PPjgg8ycObNh+RNPPEFNTQ0bN25k1qxZ+WpbkiQJMARK0g6bN28e06dPp7S0lBEjRjBr1ixGjRpFly5dqKmpAaCmpobi4mIAunXrxhFHHEGnTp1o3749xx13HM8999xm+2zXrh3Dhg3j4YcfbvbjkSRJ2WIIlKQdNGHCBKqrq1mxYgVTp05l4MCB3HXXXQwbNozJkycDMHnyZE488USgfrjnkiVLeP/996mtreXpp5/m4IMPZv369Q2hsba2lhkzZtCzZ8+CHZckScqGokI3IEmtxeWXX843vvENfvnLX/KZz3ym4Umf++yzD5dccglf/OIXiQiOO+44jj/+eFavXs2wYcPYuHEjdXV1DBw4kNGjRxf4KCRJUmtnCJTUqj391SPyuv8AxjT6nKsASvaHTbW88PWTGtY7ALh5v071M/8zv2H9n+zRHvZoX19/fgnzBg7KW69HPPN03vYtSZJajrwPB42IthGxOCIezc3vGxFPRcSy3Ps+jdb9QUQsj4hXImJwo3plRLyQW/az8BnqkiRJkrRTmuOewAuBlxrNXw7MTCn1AGbm5omIg4ERQDkwBLg5ItrmtrkFOA/okXsNaYa+JUmSJKnVyWsIjIhuwPHALxqVTwQm56YnA19vVJ+aUtqYUnodWA4cEhElQMeU0rMppQTc0WgbSZIkSdIOyPeVwInAWOBvjWpdUko1ALn34ly9K7Cy0XrVuVrX3PSWdUmSJEnSDspbCIyIocCalNKi7d1kK7W0jfrWPvO8iFgYEQvXrl27nR8rSZIkSdmRzyuBhwPDImIFMBUYGBF3AatzQzzJva/JrV9N/QP0/q4bsCpX77aV+oeklG5PKQ1IKQ3o3LlzUx6LJEmSJLUKeQuBKaUfpJS6pZRKqX/gy6yU0ihgOnBWbrWzgIdz09OBERGxe0R8jvoHwCzIDRl9NyIOyz0V9MxG20iSJEmSdkBzPB10S9cBx0TEMuCY3DwppaXANOAPwOPAd1NKdbltzqf+4TLLgT8Cv27upiVJ+bFhwwYOOeQQ+vbtS3l5OePGjQOgqqqKww47jIqKCgYMGMCCBQsAmDJlChUVFQ2vNm3aUFVVtdk+hw0bRq9evZr7UCRJahGa5cviU0qzgdm56b8AW/025JTSeGD8VuoLAf81l6RWaPfdd2fWrFl06NCBTZs28eUvf5ljjz2Wq666inHjxnHssccyY8YMxo4dy+zZsxk5ciQjR44E4IUXXuDEE0+koqKiYX8PPPAAHTp0KNDRSJK06yvElUBJkhpERENo27RpE5s2bSIiiAjeeecdAN5++23233//D2179913c/rppzfMr1+/nhtuuIErrriieZrfBe3oldUVK1awxx57NFxZHT16NADvv/8+xx9/PD179qS8vJzLL7+8YMckSWpazXIlUJKkbamrq6OyspLly5fz3e9+l0MPPZSJEycyePBgLrvsMv72t7/xu9/97kPb3XPPPTz88D9uE7/yyiu59NJLad++fXO2v0vZ0SurAN27d//QkFqAyy67jKOOOooPPviAQYMG8etf/5pjjz22eQ9IktTkvBIoSSq4tm3bUlVVRXV1NQsWLODFF1/klltu4cYbb2TlypXceOONnH322ZttM3/+fNq3b99w719VVRXLly/npJNOKsQh7DI+yZXVxtq3b89RRx0FwKc+9Sn69+9PdXX1NreRJLUMhkBJ0i5j77335sgjj+Txxx9n8uTJnHzyyQCceuqpDcMX/27q1KmbDQV99tlnWbRoEaWlpXz5y1/m1Vdf5cgjj2zO9ncZdXV1VFRUUFxczDHHHNNwZXXMmDEccMABXHbZZUyYMKFh/ddff51+/fpxxBFHMGfOnA/tb926dTzyyCMMGrTVW/olSS2MIVCSVFBr165l3bp1APzv//4vv/nNb+jZsyf7778/Tz/9NACzZs2iR48eDdv87W9/495772XEiBENtfPPP59Vq1axYsUK5s6dy0EHHdQw3DFrduTKaklJCW+88QaLFy/mhhtu4Iwzzmi4YghQW1vL6aefzve+9z0OPPDAQh2SJKkJeU+gJKmgampqOOuss6irq+Nvf/sb3/jGNxg6dCh77703F154IbW1tbRr147bb7+9YZtnnnmGbt26GUo+xpZXVidNmgTUX1k955xzgPp7CHfffXcAKisr6d69O6+++ioDBgwA4LzzzqNHjx5cdNFFBTkGSVLTMwRKkrbbTZc+kpf9nj3wmn/MvP2Pz/n2kVc3lJ/971U8+9+rGuZHHf7DbfYzevCEvPULcMFPT8jbvj+JtWvXsttuu7H33ns3XFn9/ve/33Bl9cgjj9zsyuratWvZd999adu2La+99hrLli1rCNdXXHEFb7/9Nr/4xS8KeUiSpCZmCJQkqRXZ0SurzzzzDFdddRVFRUW0bduWW2+9lX333Zfq6mrGjx9Pz5496d+/PwAXXHBBwxVESVLLZQiUJKlAxo86JS/7PaW8+z9mXl3S8Dknl32uofz4jRN4PDd9Rr+yhvqSeyaz5J7JAPy/kcM32+/q2Y8zfvbj5MMP77ovL/uVJH2YD4aRJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCF5C4ER0S4iFkTE8xGxNCL+NVffNyKeiohlufd9Gm3zg4hYHhGvRMTgRvXKiHght+xnERH56luSJEmSWrN8XgncCAxMKfUFKoAhEXEYcDkwM6XUA5iZmyciDgZGAOXAEODmiGib29ctwHlAj9xrSB77liRJkqRWK28hMNVbn5vdLfdKwInA5Fx9MvD13PSJwNSU0saU0uvAcuCQiCgBOqaUnk0pJeCORttIkiRJknZAXu8JjIi2EVEFrAGeSinNB7qklGoAcu/FudW7AisbbV6dq3XNTW9Z39rnnRcRCyNi4dq1a5v0WCRJkiSpNchrCEwp1aWUKoBu1F/V67WN1bd2n1/aRn1rn3d7SmlASmlA586dd7hfSZIkSWrtmuXpoCmldcBs6u/lW50b4knufU1utWrggEabdQNW5erdtlKXJEmSJO2gfD4dtHNE7J2b3gM4GngZmA6clVvtLODh3PR0YERE7B4Rn6P+ATALckNG342Iw3JPBT2z0TaSJEmSpB1QlMd9lwCTc0/4bANMSyk9GhHPAtMi4mzgDeBUgJTS0oiYBvwBqAW+m1Kqy+3rfOBXwB7Ar3MvSZIkSdIOylsITCktAfptpf4XYNBHbDMeGL+V+kJgW/cTSpIkSZK2Q7PcEyhJkiRJ2jUYAiVJkiQpQwyBkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJkiRJGWIIlCRJkqQMMQRKkiRJUoYYAiVJkj7CypUrOeqooygrK6O8vJxJkyYBcNppp1FRUUFFRQWlpaVUVFQAsGDBgoZ63759efDBBxv2NWTIEPr27Ut5eTmjR4+mrq6uEIckSRQVugFJkqRdVVFRET/96U/p378/7777LpWVlRxzzDHcc889Detceuml7LXXXgD06tWLhQsXUlRURE1NDX379uWEE06gqKiIadOm0bFjR1JKnHLKKdx7772MGDGiUIcmKcMMgZIkSR+hpKSEkpISAPbcc0/Kysp48803OfjggwFIKTFt2jRmzZoFQPv27Ru23bBhAxHRMN+xY0cAamtr+eCDDzZbJknNyeGgkiRJ22HFihUsXryYQw89tKE2Z84cunTpQo8ePRpq8+fPp7y8nN69e3PrrbdSVPSP37kPHjyY4uJi9txzT0455ZRm7V+S/s4QKEmS9DHWr1/P8OHDmThxYsMVPYC7776b008/fbN1Dz30UJYuXcrvf/97JkyYwIYNGxqWPfHEE9TU1LBx48aGq4eS1NwMgZIkSduwadMmhg8fzsiRIzn55JMb6rW1tTzwwAOcdtppW92urKyMT3/607z44oub1du1a8ewYcN4+OGH89q3JH0UQ6AkSdJHSClx9tlnU1ZWxiWXXLLZst/85jf07NmTbt26NdRef/11amtrAfjTn/7EK6+8QmlpKevXr6empgaoD48zZsygZ8+ezXcgktSID4aRJEn6CPPmzePOO++kd+/eDV8D8aMf/YjjjjuOqVOnfmgo6Ny5c7nuuuvYbbfdaNOmDTfffDOdOnVi9erVDBs2jI0bN1JXV8fAgQMZPXp0AY5IkgyBkiSpFXhpfH7ur9sP+MP/m7l5cTG8tHgW3+9xJvxl888eQFfuO+Pf/7HuUnhpaf3yO77+4812s+zHz+Sl57IfDszLfiW1Hg4HlSRJkqQM2a4QGBGHb09NkiRJkrRr294rgf++nTVJkiRJ0i5sm/cERsSXgH8COkdE40didQTa5rMxSZIkSVLT+7gHw3wK6JBbb89G9XeAU/LVlCRJkiQpP7YZAlNKTwNPR8SvUkp/aqaeJEmSJEl5sr1fEbF7RNwOlDbeJqXkM4glSZIkqQXZ3gfD3AssBq4AxjR6SZIkSR9r5cqVHHXUUZSVlVFeXs6kSZMAuPrqq+natSsVFRVUVFQwY8aMzbZ744036NChAz/5yU8aakceeSRf+MIXGrZZs2ZNsx6L1NJt75XA2pTSLXntRJIkSa1WUVERP/3pT+nfvz/vvvsulZWVHHPMMQBcfPHFXHbZZVvd7uKLL+bYY4/9UH3KlCkMGDAgrz1LrdX2hsBHIuL/AA8CG/9eTCn9NS9dSZIkqVUpKSmhpKQEgD333JOysjLefPPNbW7z0EMPceCBB/LpT3+6OVqUMmN7h4OeRf3wz98Bi3KvhflqSpIkSa3XihUrWLx4MYceeigAN910E3369OE73/kOb731FgDvvfceP/7xjxk3btxW9/Htb3+biooKrr32WlJKzda71BpsVwhMKX1uK68D892cJEmSWpf169czfPhwJk6cSMeOHTn//PP54x//SFVVFSUlJVx66aUAjBs3josvvpgOHTp8aB9TpkzhhRdeYM6cOcyZM4c777yzuQ9DatG2azhoRJy5tXpK6Y6mbUeSJEmt1aZNmxg+fDgjR47k5JNPBqBLly4Ny88991yGDh0KwPz587nvvvsYO3Ys69ato02bNrRr144LLriArl27AvXDSs844wwWLFjAmWdu9b+rkrZie+8J/GKj6XbAIOA5wBAoSZKkj5VS4uyzz6asrIxLLrmkoV5TU9Nwr+CDDz5Ir169AJgzZ07DOldffTUdOnTgggsuoLa2lnXr1tGpUyc2bdrEo48+ytFHH928ByO1cNsVAlNK/9J4PiL2ArzuLkmSpO0yb9487rzzTnr37k1FRQUAP/rRj7j77rupqqoiIigtLeW2227b5n42btzI4MGD2bRpE3V1dRx99NGce+65zXAEUuuxvVcCt/Q+0KMpG5EkSdKu4eqrr87Lfrd8yMuCBQvo3r073bt3b6h9VAhcv359Q18nnHDCZsuuvfbapm20kXydC6mQtveewEeAvz92qS1QBkzLV1OSJEmSpPzY3iuBP2k0XQv8KaVUnYd+JEmSJEl5tL1fEfE08DKwJ7AP8EE+m5IkSZIk5cd2hcCI+AawADgV+AYwPyJOyWdjkiRJkqSmt73DQX8IfDGltAYgIjoDvwHuy1djkiRJkqSmt11XAoE2fw+AOX/ZgW0lSZIkSbuI7b0S+HhEPAHcnZs/DZiRn5YkSZIkSfmyzRAYEZ8HuqSUxkTEycCXgQCeBaY0Q3+SJEmSpCb0cUM6JwLvAqSUHkgpXZJSupj6q4AT89uaJEmSJKmpfVwILE0pLdmymFJaCJTmpSNJkiRJUt58XAhst41lezRlI5IkSZK2z8qVKznqqKMoKyujvLycSZMmAXDllVfSp08fKioq+NrXvsaqVasAeOqpp6isrKR3795UVlYya9ashn3dc8899OnTh/LycsaOHVuQ41Hz+rgQ+PuIOHfLYkScDSzKT0uSJEmStqWoqIif/vSnvPTSS/zP//wPP//5z/nDH/7AmDFjWLJkCVVVVQwdOpRrrrkGgE6dOvHII4/wwgsvMHnyZL75zW8C8Je//IUxY8Ywc+ZMli5dyurVq5k5c2YhD03N4OOeDnoR8GBEjOQfoW8A8CngpDz2JUmSJOkjlJSUUFJSAsCee+5JWVkZb775JgcffHDDOu+99x4RAUC/fv0a6uXl5WzYsIGNGzfy2muvcdBBB9G5c2cAjj76aO6//34GDRrUjEej5rbNEJhSWg38U0QcBfTKlR9LKc3axmaSJEmSmsmKFStYvHgxhx56KAA//OEPueOOO9hrr7347W9/+6H177//fvr168fuu+/O5z//eV5++WVWrFhBt27deOihh/jggw+a+xDUzLbrC99TSr9NKf177mUAlCRJknYB69evZ/jw4UycOJGOHTsCMH78eFauXMnIkSO56aabNlt/6dKlfP/73+e2224DYJ999uGWW27htNNO4ytf+QqlpaUUFW3vV4mrpdquEChJkiRp17Jp0yaGDx/OyJEjOfnkkz+0/IwzzuD+++9vmK+uruakk07ijjvuoHv37g31E044gfnz5/Pss8/yhS98gR49ejRL/yocQ6AkSZLUwqSUOPvssykrK+OSSy5pqC9btqxhevr06fTs2ROAdevWcfzxxzNhwgQOP/zwzfa1Zs0aAN566y1uvvlmzjnnnGY4AhWS13olSZKkFmbevHnceeed9O7dm4qKCgB+9KMf8ctf/pJXXnmFNm3a8NnPfpZbb70VgJtuuonly5dz7bXXcu211wLw5JNPUlxczIUXXsjzzz8PwFVXXcVBBx1UkGNS8zEESpIkSXk07d5D8rLfe6Z9cbP59e9dzWkjANrnKquZ97v6B/of9AX4r1+Vb7b+7KeHAnDSyXDSyR1y1RuYdu8NeekX4BunLsjbvrX9HA4qSZIkSRliCJQkSZKkDDEESpIkSVKGGAIlSZIkKUMMgZIkSZKUIYZASZIkScoQQ6AkSZIkZYghUJIkSZIyxBAoSZIkSRliCJQkSZKkDDEESpIkSVKGGAIlSZIkKUMMgZIkSZKUIYZASZIkScoQQ6AkSZIkZYghUJIkSZIyxBAoSZIkSRliCJQkSZKkDDEESpIkSVKGGAIlSZIkKUMMgZIkSZKUIYZASZIkScoQQ6AkSZIkZUjeQmBEHBARv42IlyJiaURcmKvvGxFPRcSy3Ps+jbb5QUQsj4hXImJwo3plRLyQW/aziIh89S1JkiRJrVk+rwTWApemlMqAw4DvRsTBwOXAzJRSD2Bmbp7cshFAOTAEuDki2ub2dQtwHtAj9xqSx74lSZIkqdXKWwhMKdWklJ7LTb8LvAR0BU4EJudWmwx8PTd9IjA1pbQxpfQ6sBw4JCJKgI4ppWdTSgm4o9E2kiRJkqQd0Cz3BEZEKdAPmA90SSnVQH1QBIpzq3UFVjbarDpX65qb3rIuSZIkSdpBeQ+BEdEBuB+4KKX0zrZW3UotbaO+tc86LyIWRsTCtWvX7nizkiRJktTK5TUERsRu1AfAKSmlB3Ll1bkhnuTe1+Tq1cABjTbvBqzK1bttpf4hKaXbU0oDUkoDOnfu3HQHIkmSJEmtRD6fDhrAL4GXUko3NFo0HTgrN30W8HCj+oiI2D0iPkf9A2AW5IaMvhsRh+X2eWajbSRJkiRJO6Aoj/s+HPgm8EJEVOVq/xe4DpgWEWcDbwCnAqSUlkbENOAP1D9Z9LsppbrcducDvwL2AH6de0mSJEmSdlDeQmBKaS5bv58PYNBHbDMeGL+V+kKgV9N1J0mSJEnZ1CxPB5UkSZIk7RoMgZIkSZKUIYZASZIkScoQQ6AkSZIkZYghUJIkSZIyxBAoSZIkSRliCJQkSZKkDDEESpIkSVKGGAIlSZIkKUMMgZIkSZKUIYZASZIkScoQQ6AkSZIkZYghUJIkSZIyxBAoSZIkSRliCJQkSZKkDDEESpIkSVKGGAIlSZIkKUMMgZIkSZKUIYZASZIkScoQQ6AkSZIkZYghUJIkSZIyxBAoSZIkSRliCJQkSZKkDDEESpIkSVKGGAIlSZIkKUMMgZIkSZIy7Tvf+Q7FxcX06tWroXb11VfTtWtXKioqqKioYMaMGZtt88Ybb9ChQwd+8pOfNNTuuece+vTpQ3l5OWPHjm22/neUIVCSJElSpn3rW9/i8ccf/1D94osvpqqqiqqqKo477rgPLTv22GMb5v/yl78wZswYZs6cydKlS1m9ejUzZ87Me+87wxAoSZIkKdO++tWvsu+++273+g899BAHHngg5eXlDbXXXnuNgw46iM6dOwNw9NFHc//99zd5r03BEChJkiRJW3HTTTfRp08fvvOd7/DWW28B8N577/HjH/+YcePGbbbu5z//eV5++WVWrFhBbW0tDz30ECtXrixE2x/LEChJkiRJWzj//PP54x//SFVVFSUlJVx66aUAjBs3josvvpgOHTpstv4+++zDLbfcwmmnncZXvvIVSktLKSoqKkTrH2vX7EqSJEmSCqhLly4N0+eeey5Dhw4FYP78+dx3332MHTuWdevW0aZNG9q1a8cFF1zACSecwAknnADA7bffTtu2bQvS+8cxBEqSJEnSFmpqaigpKQHgwQcfbHhy6Jw5cxrWufrqq+nQoQMXXHABAGvWrKG4uJi33nqLm2++mWnTpjV/49vBEChJkiQp004//XRmz57Nn//8Z7p168a//uu/Mnv2bKqqqogISktLue222z52PxdeeCHPP/88AFdddRUHHXRQvlvfKYZASZIkSS1C3/ueyM+Oh3+L4uHfojg3+zOAE0fR5sRRAPwJGDJvCbBk8+16fQmAO//e1/Bvsdvw+skJwIR89Qs8f8rgnd7WB8NIkiRJUoYYAiVJkiQpQwyBkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJkiRJGWIIlCRJkqQMMQRKkiRJUoYYAiVJkiQpQwyBkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJkiRJGWIIlCRJkqQMMQRKkiRJUoYYAiVJkiQpQwyBkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJkiRJGWIIlCRJkqQMMQRKkiRJUoYYAiVJkiQpQwyBkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJkiRJGWIIlCRJkqQMMQRKkiRJUoYYAiVJkiQpQwyBkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJkiRJGWIIlCRJkqQMMQRKkiRJUoYYAiVJkiQpQ/IWAiPiPyNiTUS82Ki2b0Q8FRHLcu/7NFr2g4hYHhGvRMTgRvXKiHght+xnERH56lmSJEmSWrt8Xgn8FTBki9rlwMyUUg9gZm6eiDgYGAGU57a5OSLa5ra5BTgP6JF7bblPSZIkSdJ2ylsITCk9A/x1i/KJwOTc9GTg643qU1NKG1NKrwPLgUMiogTomFJ6NqWUgDsabSNJkiRJ2kHNfU9gl5RSDUDuvThX7wqsbLReda7WNTe9ZV2SJEmStBN2lQfDbO0+v7SN+tZ3EnFeRCyMiIVr165tsuYkSZIkqbVo7hC4OjfEk9z7mly9Gjig0XrdgFW5eret1LcqpXR7SmlASmlA586dm7RxSZIkSWoNmjsETgfOyk2fBTzcqD4iInaPiM9R/wCYBbkho+9GxGG5p4Ke2WgbSZIkSdIOKsrXjiPibuBIoFNEVAPjgOuAaRFxNvAGcCpASmlpREwD/gDUAt9NKdXldnU+9U8a3QP4de4lSZIkSdoJeQuBKaXTP2LRoI9Yfzwwfiv1hUCvJmxNkiRJkjJrV3kwjCRJkiSpGRgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKEEOgJEmSJGWIIVCSJEmSMsQQKEmSJEkZYgiUJEmSpAwxBEqSJElShhgCJUmSJClDDIGSJEmSlCGGQEmSJEnKkBYTAiNiSES8EhHLI+LyQvcjSZIkSS1RiwiBEdEW+DlwLHAwcHpEHFzYriRJkiSp5WkRIRA4BFieUnotpfQBMBU4scA9SZIkSVKL01JCYFdgZaP56lxNkiRJkrQDIqVU6B4+VkScCgxOKZ2Tm/8mcEhK6V+2WO884Lzc7BeAV5q10Z3TCfhzoZtoJTyXTcvz2bQ8n03Hc9m0PJ9Ny/PZdDyXTcvz2bRayvn8bEqp85bFokJ0shOqgQMazXcDVm25UkrpduD25mqqKUTEwpTSgEL30Rp4LpuW57NpeT6bjueyaXk+m5bns+l4LpuW57NptfTz2VKGg/4e6BERn4uITwEjgOkF7kmSJEmSWpwWcSUwpVQbERcATwBtgf9MKS0tcFuSJEmS1OK0iBAIkFKaAcwodB950KKGr+7iPJdNy/PZtDyfTcdz2bQ8n03L89l0PJdNy/PZtFr0+WwRD4aRJEmSJDWNlnJPoCRJkiSpCRgCCyAivhARVY1e70TERYXuqyWLiL0j4r6IeDkiXoqILxW6p5YqIi6MiBcjYql/Lj+5iPjPiFgTES8WupfWICIuzv3ZfDEi7o6IdoXuqaWKiAMi4re5n5lLI+LCQvfU0kVE24hYHBGPFrqXlmZrPysjYt+IeCoiluXe9ylkjy1VRLSLiAUR8Xzu7/q/FrqnliwiVkTEC7n/wy8sdD87yxBYACmlV1JKFSmlCqASeB94sLBdtXiTgMdTSj2BvsBLBe6nRYqIXsC5wCHUn8ehEdGjsF21eL8ChhS6idYgIroC3wMGpJR6Uf+gsBGF7apFqwUuTSmVAYcB342IgwvcU0t3If77s7N+xYd/Vl4OzEwp9QBm5ua14zYCA1NKfYEKYEhEHFbYllq8o3L/l/crIrTTBgF/TCn9qdCNtFQR0RH4KvBLgJTSBymldQVtquUqA/4npfR+SqkWeBo4qcA9tWgppWeAvxa6j1akCNgjIoqA9mzlO2O1fVJKNSml53LT71IfXroWtquWKyK6AccDvyh0Ly3RR/ysPBGYnJueDHy9OXtqLVK99bnZ3XIvHwqScYbAwhsB3F3oJlq4A4G1wH/lhuH8IiI+XeimWqgXga9GxH4R0R44DjigwD1JAKSU3gR+ArwB1ABvp5SeLGxXrUNElAL9gPkFbqUlmwiMBf5W4D5aky4ppRqo/6UFUFzgflqs3FDlKmAN8FRKyb/rOy8BT0bEoog4r9DN7CxDYAHlvvh+GHBvoXtp4YqA/sAtKaV+wHs4ZGSnpJReAn4MPAU8DjxP/ZAxqeBy9wOdCHwO2B/4dESMKmxXLV9EdADuBy5KKb1T6H5aoogYCqxJKS0qdC/S1qSU6nK3IXUDDsnd/qGdc3hKqT9wLPXD6L9a6IZ2hiGwsI4FnksprS50Iy1cNVDd6Lda91EfCrUTUkq/TCn1Tyl9lfqhOcsK3ZOUczTwekppbUppE/AA8E8F7qlFi4jdqA+AU1JKDxS6nxbscGBYRKwApgIDI+KuwrbUKqyOiBKA3PuaAvfT4uVul5mN96rvtJTSqtz7Guqf6XFIYTvaOYbAwjodh4J+Yiml/w9YGRFfyJUGAX8oYEstWkQU594/A5yMf0a163gDOCwi2kdEUP933Ydw7KTcOfwl8FJK6YZC99OSpZR+kFLqllIqpf42j1kpJa9Sf3LTgbNy02cBDxewlxYrIjpHxN656T2o/4XaywVtqoWKiE9HxJ5/nwa+Rv2tNC1OUaEbyKrc/VbHAP9c6F5aiX8BpuSG2L4GfLvA/bRk90fEfsAm4LsppbcK3VBLFhF3A0cCnSKiGhiXUvplYbtqmVJK8yPiPuA56ocpLwZuL2xXLdrhwDeBF3L3CgH835TSjMK1pKza2s9K4DpgWkScTf0vgU4tXIctWgkwOSLaUn8BaFpKya8x2TldgAfrf4dGEfDfKaXHC9vSzomUfDiQJEmSJGWFw0ElSZIkKUMMgZIkSZKUIYZASZIkScoQQ6AkSZIkZYghUJIkSZIyxBAoSZIkSRliCJQkaTtExPci4qWImBIRu0fEbyKiKiJO+4T7HR0RZ26lXhoRLfJLiCVJuza/LF6SpO3zf4BjU0qvR8RhwG4ppYrt3TgiilJKtVvWU0q3NmGPkiR9LEOgJElbiIhLgO/kZn8B9AQOBKZHxF3AuUDniKgChgN7AzcAHYA/A99KKdVExGzgd8DhwHTgp1v5rKuB9Smln0REJfCfwPvA3DwdniQp4wyBkiQ1kgti3wYOBQKYD4wChgBHpZT+HBHzgctSSkMjYjfgTuDElNLa3PDQ8fwjRO6dUjpiOz/+v4B/SSk9HRH/1oSHJUlSA0OgJEmb+zLwYErpPYCIeAD4yjbW/wLQC3gqIgDaAjWNlt+zPR8aEXtRHxifzpXuBI7dsdYlSfp4hkBJkjYXO7H+0pTSlz5i+Xs7sJ+0g58tSdIO8+mgkiRt7hng6xHRPiI+DZwEzNnG+q9Qf3/glwAiYreIKN/RD00prQPejogv50ojd3QfkiRtD68ESpLUSErpuYj4FbAgV/pFSmlxbqjn1tb/ICJOAX6WG9JZBEwElu7Ex38b+M+IeB94Yie2lyTpY0VKjjyRJEmSpKxwOKgkSZIkZYjDQSVJagYR8UPg1C3K96aUxheiH0lSdjkcVJIkSZIyxOGgkiRJkpQhhkBJkiRJyhBDoCRJkiRliCFQkiRJkjLEEChJkiRJGfL/Ay7f6BvcEwcVAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 1080x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "offers_completed_dict={}\n",
    "for i in range(1,11):\n",
    "    offers_completed_dict[i]=sum(final_profile['offer_{}_completed'.format(i)])\n",
    "\n",
    "    \n",
    "plt.figure(figsize = (15, 8))\n",
    "offers_completed_df = pd.DataFrame(list(offers_completed_dict.items()))\n",
    "offers_completed_df.columns =[\"offer_id\", \"Count\"]\n",
    "\n",
    "\n",
    "offers_completed_df = offers_completed_df.sort_values('Count',ascending=False).reset_index()\n",
    "\n",
    "ax=sns.barplot(x='offer_id', y='Count', data=offers_completed_df, order=offers_completed_df['offer_id'])\n",
    "values=[x for x in offers_completed_dict.values()]\n",
    "labels=[x for x in offers_completed_dict.keys()]\n",
    "\n",
    "\n",
    "values, labels= zip(*sorted(zip(values,labels)))\n",
    "values=list(values)\n",
    "values.reverse()\n",
    "for i, p in enumerate(ax.patches):\n",
    "    height = p.get_height()\n",
    "    ax.text(p.get_x()+p.get_width()/2., height + 0.1,values[i],ha=\"center\")\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Offering 7 was the most completed, beating offer 6 by a margin of 181, and is completed 5170 times. Offer 5 was the least completed, with a count of 1567.What accounts for these results?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 297,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style type=\"text/css\">\n",
       "</style>\n",
       "<table id=\"T_9a965_\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th class=\"col_heading level0 col0\" >offer_id</th>\n",
       "      <th class=\"col_heading level0 col1\" >reward</th>\n",
       "      <th class=\"col_heading level0 col2\" >difficulty</th>\n",
       "      <th class=\"col_heading level0 col3\" >duration</th>\n",
       "      <th class=\"col_heading level0 col4\" >email</th>\n",
       "      <th class=\"col_heading level0 col5\" >mobile</th>\n",
       "      <th class=\"col_heading level0 col6\" >social</th>\n",
       "      <th class=\"col_heading level0 col7\" >web</th>\n",
       "      <th class=\"col_heading level0 col8\" >bogo</th>\n",
       "      <th class=\"col_heading level0 col9\" >informational</th>\n",
       "      <th class=\"col_heading level0 col10\" >discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td id=\"T_9a965_row0_col0\" class=\"data row0 col0\" >5</td>\n",
       "      <td id=\"T_9a965_row0_col1\" class=\"data row0 col1\" >5</td>\n",
       "      <td id=\"T_9a965_row0_col2\" class=\"data row0 col2\" >20</td>\n",
       "      <td id=\"T_9a965_row0_col3\" class=\"data row0 col3\" >240</td>\n",
       "      <td id=\"T_9a965_row0_col4\" class=\"data row0 col4\" >1</td>\n",
       "      <td id=\"T_9a965_row0_col5\" class=\"data row0 col5\" >0</td>\n",
       "      <td id=\"T_9a965_row0_col6\" class=\"data row0 col6\" >0</td>\n",
       "      <td id=\"T_9a965_row0_col7\" class=\"data row0 col7\" >1</td>\n",
       "      <td id=\"T_9a965_row0_col8\" class=\"data row0 col8\" >0</td>\n",
       "      <td id=\"T_9a965_row0_col9\" class=\"data row0 col9\" >0</td>\n",
       "      <td id=\"T_9a965_row0_col10\" class=\"data row0 col10\" >1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_9a965_row1_col0\" class=\"data row1 col0\" >7</td>\n",
       "      <td id=\"T_9a965_row1_col1\" class=\"data row1 col1\" >2</td>\n",
       "      <td id=\"T_9a965_row1_col2\" class=\"data row1 col2\" >10</td>\n",
       "      <td id=\"T_9a965_row1_col3\" class=\"data row1 col3\" >240</td>\n",
       "      <td id=\"T_9a965_row1_col4\" class=\"data row1 col4\" >1</td>\n",
       "      <td id=\"T_9a965_row1_col5\" class=\"data row1 col5\" >1</td>\n",
       "      <td id=\"T_9a965_row1_col6\" class=\"data row1 col6\" >1</td>\n",
       "      <td id=\"T_9a965_row1_col7\" class=\"data row1 col7\" >1</td>\n",
       "      <td id=\"T_9a965_row1_col8\" class=\"data row1 col8\" >0</td>\n",
       "      <td id=\"T_9a965_row1_col9\" class=\"data row1 col9\" >0</td>\n",
       "      <td id=\"T_9a965_row1_col10\" class=\"data row1 col10\" >1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n"
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x1be9f95e310>"
      ]
     },
     "execution_count": 297,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio[(portfolio['offer_id']==7)| (portfolio['offer_id']==5)].style.hide_index()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Offer 7 is a discount type offer which has a difficulty of 10 with 240hr(10 days) duration and a reward of 2.Offer 5 is also a discount type offer which has a difficulty of 20 with 240hr(10 days) duration and a reward of 5.The reward did not lure customers in completing the offer, and an important point to note is that Offer 5 has the highest difficulty."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3. Among all of the offers, which has the most and least accidental completions?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 298,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA4EAAAHhCAYAAADQwbu/AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAyiElEQVR4nO3de7heZXkv6t+TRKOILKRJLDIJQUs5JJhAYkSpeKAKbpCTAqEKwdjS1SUusZ5gc1lPOxtU6rlqrVAjtbBRtInUUlMQD11iCDYCATmUoIkggSpVoRwC7/5jfqQzGCDEOeeXmXHf1zWvb3zPOD3faBV+jne8o1prAQAAoBvG9bsBAAAARo8QCAAA0CFCIAAAQIcIgQAAAB0iBAIAAHSIEAgAANAhE/rdwEiZNGlSmzZtWr/bAAAA6Isrr7zyztba5EfWt9oQOG3atCxfvrzfbQAAAPRFVf14Y3XDQQEAADpECAQAAOgQIRAAAKBDhEAAAIAOEQIBAAA6RAgEAADoECEQAACgQ4RAAACADhECAQAAOkQIBAAA6BAhEAAAoEOEwGG2YMGCTJkyJTNmzNig/olPfCK77757pk+fnne84x1JkmXLlmXWrFmZNWtWZs6cma9+9atJkl/96lfr67NmzcqkSZNyyimnjPZPAQAAtkIT+t3A1ubEE0/MySefnBNOOGF97Zvf/GYWL16cq666KhMnTszatWuTJDNmzMjy5cszYcKE3HbbbZk5c2Ze9apX5elPf3pWrFixfv/Zs2fnqKOOGu2fAgAAbIXcCRxmBxxwQHbYYYcNap/+9Kdz6qmnZuLEiUmSKVOmJEm22WabTJgwmMPvvffeVNVvHO/GG2/M2rVr86IXvWiEOwcAALpACBwFN9xwQ77zne/k+c9/fl784hfniiuuWL/u+9//fqZPn5699947n/nMZ9aHwoedd955OfbYYzcaEAEAAJ4oIXAUrFu3Lr/4xS9y+eWX50Mf+lCOOeaYtNaSJM9//vOzcuXKXHHFFTnjjDNy7733brDv+eefn+OOO64fbW8RnsgzlkuXLs3s2bOz9957Z/bs2bn00kvXb3/66adn5513zrbbbjuq/QMAwJZGCBwFAwMDOeqoo1JVmTt3bsaNG5c777xzg2323HPPPO1pT8s111yzvvbDH/4w69aty+zZs0e75S3GiSeemIsvvniD2tBnLFeuXJm3ve1tSZJJkybla1/7Wq6++uosWrQoxx9//Pp9XvWqV2XZsmWj2jsAAGyJhMBRcMQRR6y/K3XDDTfk/vvvz6RJk7Jq1aqsW7cuSfLjH/84119/faZNm7Z+v/POO6/TdwGTJ/aM5T777JNnPetZSZLp06fn3nvvzX333Zck2W+//bLjjjuOYucAALBlEgKH2XHHHZcXvOAFuf766zMwMJCzzz47CxYsyM0335wZM2Zk3rx5WbRoUaoq3/3udzNz5szMmjUrRx55ZD71qU9l0qRJ6491wQUXdD4EbsxjPWP5sAsvvDD77LPP+qAIAAAMqoefTdvazJkzpy1fvvxR189++xdGsZst25UfOuHxN+qjW265JYceeuj6obIzZszIy172snzsYx/LFVdckWOPPTY333zz+slzVq5cmcMOOyzf+MY38pznPGeDY2277bb59a9/Peq/YUuwYMGCXHTRRZkyZcoGw44/8YlP5JOf/GQmTJiQQw45JB/84AeTJGeccUbOPvvsjB8/Ph//+Mdz0EEHJUnuv//+nHzyybnssssybty4LFy4MK9+9av78psAAHh0VXVla23OI+veE8iY82jPWE6ePDlr1qzJkUcemS984Qu/EQC77om8w/Laa6/N+eefn5UrV+bWW2/NH/7hH+aGG27I+PHjs3DhwkyZMiU33HBDHnroofz85z/v108CAGAzGA7KmPNoz1jeddddOeSQQ3LGGWdk//3373OXW54n8nzl4sWLM2/evEycODG77rprfu/3fm/9xDrnnHNOTjvttCTJuHHjNhjCDADAlk8IZIv2RJ6x/OQnP5mbbrop73//+zNr1qzMmjVr/Z2td7zjHRkYGMg999yTgYGBvOc97+nvD9tCPNrzlT/96U+z8847r99uYGAgP/3pT3PXXXclSd71rndl3333zdFHH53bb7+9H60DALCZDAdlWPzkfXuPyHE/sGeSPScl6d1t+ulH87MzP5r/9/eT/H4leSD57pvzk+8mJyQ54Z3PTvLg+v3v/cyB+UmSk7dNTj7pGUme0VtzYX7yvgtHpOepf3H1iBx3JAx9h+UVV1yRY445JjfffHM29qxwVWXdunVZs2ZN9t9//3z4wx/Ohz/84bztbW/Lueee24fuAQDYHCN2J7CqzqmqtVV1zSPqb6qq66tqZVV9cEj9tKq6qbfuoCH1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\n",
      "text/plain": [
       "<Figure size 1080x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "offers_accidentaly_completed_dict={}\n",
    "for i in range(1,11):\n",
    "    offers_accidentaly_completed_dict[i]=sum(final_profile['offer_{}_accidentallycompleted'.format(i)])\n",
    "\n",
    "    \n",
    "plt.figure(figsize = (15, 8))\n",
    "offers_accidentaly_completed_df = pd.DataFrame(list(offers_accidentaly_completed_dict.items()))\n",
    "offers_accidentaly_completed_df.columns =[\"offer_id\", \"Count\"]\n",
    "\n",
    "\n",
    "offers_accidentaly_completed_df = offers_accidentaly_completed_df.sort_values('Count',ascending=False).reset_index()\n",
    "\n",
    "ax=sns.barplot(x='offer_id', y='Count', data=offers_accidentaly_completed_df, order=offers_accidentaly_completed_df['offer_id'])\n",
    "values=[x for x in offers_accidentaly_completed_dict.values()]\n",
    "labels=[x for x in offers_accidentaly_completed_dict.keys()]\n",
    "\n",
    "\n",
    "values, labels= zip(*sorted(zip(values,labels)))\n",
    "values=list(values)\n",
    "values.reverse()\n",
    "for i, p in enumerate(ax.patches):\n",
    "    height = p.get_height()\n",
    "    ax.text(p.get_x()+p.get_width()/2., height + 0.1,values[i],ha=\"center\")\n",
    "    "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Offer 3 is the most accidentally completed offer and offer 2 is the least accidentally completed offer.Offer 3,4,5 and 10 are completed accidentaly by a large margin when compared to other offers.What must be the reason? Less difficulty?\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 299,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style type=\"text/css\">\n",
       "</style>\n",
       "<table id=\"T_352d6_\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th class=\"col_heading level0 col0\" >offer_id</th>\n",
       "      <th class=\"col_heading level0 col1\" >reward</th>\n",
       "      <th class=\"col_heading level0 col2\" >difficulty</th>\n",
       "      <th class=\"col_heading level0 col3\" >duration</th>\n",
       "      <th class=\"col_heading level0 col4\" >email</th>\n",
       "      <th class=\"col_heading level0 col5\" >mobile</th>\n",
       "      <th class=\"col_heading level0 col6\" >social</th>\n",
       "      <th class=\"col_heading level0 col7\" >web</th>\n",
       "      <th class=\"col_heading level0 col8\" >bogo</th>\n",
       "      <th class=\"col_heading level0 col9\" >informational</th>\n",
       "      <th class=\"col_heading level0 col10\" >discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td id=\"T_352d6_row0_col0\" class=\"data row0 col0\" >3</td>\n",
       "      <td id=\"T_352d6_row0_col1\" class=\"data row0 col1\" >0</td>\n",
       "      <td id=\"T_352d6_row0_col2\" class=\"data row0 col2\" >0</td>\n",
       "      <td id=\"T_352d6_row0_col3\" class=\"data row0 col3\" >96</td>\n",
       "      <td id=\"T_352d6_row0_col4\" class=\"data row0 col4\" >1</td>\n",
       "      <td id=\"T_352d6_row0_col5\" class=\"data row0 col5\" >1</td>\n",
       "      <td id=\"T_352d6_row0_col6\" class=\"data row0 col6\" >0</td>\n",
       "      <td id=\"T_352d6_row0_col7\" class=\"data row0 col7\" >1</td>\n",
       "      <td id=\"T_352d6_row0_col8\" class=\"data row0 col8\" >0</td>\n",
       "      <td id=\"T_352d6_row0_col9\" class=\"data row0 col9\" >1</td>\n",
       "      <td id=\"T_352d6_row0_col10\" class=\"data row0 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_352d6_row1_col0\" class=\"data row1 col0\" >4</td>\n",
       "      <td id=\"T_352d6_row1_col1\" class=\"data row1 col1\" >5</td>\n",
       "      <td id=\"T_352d6_row1_col2\" class=\"data row1 col2\" >5</td>\n",
       "      <td id=\"T_352d6_row1_col3\" class=\"data row1 col3\" >168</td>\n",
       "      <td id=\"T_352d6_row1_col4\" class=\"data row1 col4\" >1</td>\n",
       "      <td id=\"T_352d6_row1_col5\" class=\"data row1 col5\" >1</td>\n",
       "      <td id=\"T_352d6_row1_col6\" class=\"data row1 col6\" >0</td>\n",
       "      <td id=\"T_352d6_row1_col7\" class=\"data row1 col7\" >1</td>\n",
       "      <td id=\"T_352d6_row1_col8\" class=\"data row1 col8\" >1</td>\n",
       "      <td id=\"T_352d6_row1_col9\" class=\"data row1 col9\" >0</td>\n",
       "      <td id=\"T_352d6_row1_col10\" class=\"data row1 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_352d6_row2_col0\" class=\"data row2 col0\" >5</td>\n",
       "      <td id=\"T_352d6_row2_col1\" class=\"data row2 col1\" >5</td>\n",
       "      <td id=\"T_352d6_row2_col2\" class=\"data row2 col2\" >20</td>\n",
       "      <td id=\"T_352d6_row2_col3\" class=\"data row2 col3\" >240</td>\n",
       "      <td id=\"T_352d6_row2_col4\" class=\"data row2 col4\" >1</td>\n",
       "      <td id=\"T_352d6_row2_col5\" class=\"data row2 col5\" >0</td>\n",
       "      <td id=\"T_352d6_row2_col6\" class=\"data row2 col6\" >0</td>\n",
       "      <td id=\"T_352d6_row2_col7\" class=\"data row2 col7\" >1</td>\n",
       "      <td id=\"T_352d6_row2_col8\" class=\"data row2 col8\" >0</td>\n",
       "      <td id=\"T_352d6_row2_col9\" class=\"data row2 col9\" >0</td>\n",
       "      <td id=\"T_352d6_row2_col10\" class=\"data row2 col10\" >1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_352d6_row3_col0\" class=\"data row3 col0\" >10</td>\n",
       "      <td id=\"T_352d6_row3_col1\" class=\"data row3 col1\" >2</td>\n",
       "      <td id=\"T_352d6_row3_col2\" class=\"data row3 col2\" >10</td>\n",
       "      <td id=\"T_352d6_row3_col3\" class=\"data row3 col3\" >168</td>\n",
       "      <td id=\"T_352d6_row3_col4\" class=\"data row3 col4\" >1</td>\n",
       "      <td id=\"T_352d6_row3_col5\" class=\"data row3 col5\" >1</td>\n",
       "      <td id=\"T_352d6_row3_col6\" class=\"data row3 col6\" >0</td>\n",
       "      <td id=\"T_352d6_row3_col7\" class=\"data row3 col7\" >1</td>\n",
       "      <td id=\"T_352d6_row3_col8\" class=\"data row3 col8\" >0</td>\n",
       "      <td id=\"T_352d6_row3_col9\" class=\"data row3 col9\" >0</td>\n",
       "      <td id=\"T_352d6_row3_col10\" class=\"data row3 col10\" >1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n"
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x1be87412ac0>"
      ]
     },
     "execution_count": 299,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio[(portfolio['offer_id']==3)| (portfolio['offer_id']==4) | (portfolio['offer_id']==5) | (portfolio['offer_id']==10)].style.hide_index()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "offer 3 is a informational type offer with a difficulty of 0, no wonder it topped the list.All these four offers have one thing in common,none of them are sent via social. Intresting, offer 5 was the least intentionally completed offer but it stands at three in accidentally completed list. Is the duration of 240 a reason for this? Better to do a seperate analysis on offer 5.offer 10 has a balanced duration time of 168hr and also is the 4th intentionally completed offer."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3. What is the most and least ignored offer among all the offers?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 300,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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EQIBAAAaRAgEAABoECEQAACgQYRAAACABhECAQAAGkQIBAAAaBAhEGANzJw5MyNGjMjEiRN7al1dXdl1113T2dmZqVOn5pZbbkmS3HLLLens7ExnZ2cmT56cyy67rGfMBRdckEmTJmWHHXbI3nvvnWXLlvX7vgAAzSIEAqyBQw89NFddddULascdd1xOPPHEdHV15Utf+lKOO+64JMnEiRMzd+7cdHV15aqrrsqnPvWpdHd3p7u7O8ccc0yuu+663HHHHdlhhx3yrW99qx27AwA0iBAIsAamTZuWzTbb7AW1Ukoef/zxJMm///u/Z6uttkqSbLjhhuno6EiS/OlPf0opJUlSa02tNU899VRqrXn88cd7xgAA9JWOdjcAMFicfvrp2WuvvfI3f/M3ef755/OLX/yiZ9nNN9+cmTNn5ne/+13OO++8nlA4a9asTJo0KRtttFG22267fPvb325X+wBAQzgTCNBLZs2aldNOOy0PPvhgTjvttBx22GE9y3bZZZfcfffdufXWW/PlL385f/rTn/Lcc89l1qxZuf322/Pwww9nhx12yJe//OU27gEA0ARCIEAvOffcc3PAAQckSQ488MCeG8OsbPz48dloo41y1113paurK0kyduzYlFJy0EEHveDsIQBAXxACAXrJVlttlRtuuCFJcu2112a77bZLkixcuDDd3d1Jkt/97ne57777MmbMmIwaNSr33HNPli5dmiSZPXt2xo8f357mAYDGcE0gwBqYMWNGrr/++ixbtiyjR4/OF7/4xXz3u9/NMccck+7u7qy//vo566yzkiQ33XRTvvKVr2TdddfNkCFD8p3vfCdbbLFFkuTEE0/MtGnTsu666+ZNb3pTzjnnnDbuFQDQBKXW2u4e+sTUqVPr3LlzX3b5lC/8oB+7WbvNO+WQ172NxV+a1AudDA7bnHDn6xq/2xm79VInA9/Pj/75697GDdOm90Ing8P0G29odwsAQD8qpcyrtU59cd10UAAAgAYRAgEAABpECAQAAGgQIRAAAKBBhEAAAIAGEQIBAAAaRAgEAABoECEQAACgQYRAAACABhECAQAAGkQIBAAAaBAhEAAAoEGEQAAAgAYRAgEAABpECAQAAGgQIRAAAKBBhEAAAIAGEQIBAAAaRAgEAABoECEQAACgQYRAAACABhECAQAAGkQIBKDtZs6cmREjRmTixIkvqJ9xxhkZN25cJkyYkOOOOy5JsmjRomywwQbp7OxMZ2dnjjjiiJdsb999933JtgCAFTra3QAAHHrooTnqqKNyyCGH9NSuu+66XH755bnjjjsydOjQLFmypGfZ2LFj09XVtcptXXrppRk2bFhftwwAA5YzgQC03bRp07LZZpu9oDZr1qwcf/zxGTp0aJJkxIgRr7qdJ598Mt/4xjfy3/7bf+uTPgFgMBACAVgrzZ8/P3PmzMkuu+yS6dOn59Zbb+1ZtnDhwuy4446ZPn165syZ01P/7//9v+fzn/98Ntxww3a0DAADgumgAKyVuru789hjj+VXv/pVbr311hx00EFZsGBBRo4cmcWLF2fzzTfPvHnzsv/+++fuu+/OggUL8sADD+S0007LokWL2t0+AKy1hEAA1kqjR4/OAQcckFJKdt555wwZMiTLli3L8OHDe6aITpkyJWPHjs38+fNz6623Zt68eRkzZky6u7uzZMmS7L777rn++uvbuyMAsJYxHRSAtdL++++fa6+9NsmKqaHPPvtstthiiyxdujTLly9PkixYsCD3339/tt122xx55JF5+OGHs2jRotx00015y1veIgACwCo4EwhA282YMSPXX399li1bltGjR+eLX/xiZs6cmZkzZ2bixIlZb731cu6556aUkhtvvDEnnHBCOjo6ss466+TMM898yU1lAICXV2qt7e6hT0ydOrXOnTv3ZZdP+cIP+rGbtdu8Uw559ZVexeIvTeqFTgaHbU6483WN3+2M3Xqpk4Hv50f//HVv44Zp03uhk8Fh+o03vO5tfOvz/68XOhkcjvr6+9rdAgC8olLKvFrr1BfXTQcFAABoECEQAACgQYRAAACABhECAQAAGkQIBAAAaBAhEAAAoEGEQAAAgAYRAgEAABpECAQAAGgQIRAAAKBBhEAAGERmzpyZESNGZOLEiT21k046KaNGjUpnZ2c6Oztz5ZVXvmDM4sWLM2zYsJx66qk9tb333juTJ0/OhAkTcsQRR2T58uX9tg8A9C0hEAAGkUMPPTRXXXXVS+rHHntsurq60tXVlX322ecly97znve8oHbRRRfl17/+de66664sXbo0F198cZ/2DUD/6Wh3AwBA75k2bVoWLVq02uv/+Mc/zrbbbpuNNtroBfVNNtkkSdLd3Z1nn302pZTebBOANnImEAAa4Fvf+lZ2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PUm6k3y61rq8takjs+JOoxsk+WnrBQAAwBrosxBYa53xMov2eJn1T05y8irqc5NM7MXWAAAAGmttuTEMAAAA/UAIBACgLb75zW9m4sSJmTBhQk4//fQkycUXX5wJEyZkyJAhmTt3bs+6ixYtygYbbJDOzs50dnbmiCOOaFPXMPD12XRQAAB4OXfddVe++93v5pZbbsl6662XvffeO+9973szceLEXHrppfnUpz71kjFjx45NV1dX/zcLg4wzgQAA9Lt77703u+66azbccMN0dHRk+vTpueyyyzJ+/PiMGzeu3e3BoCYEAgDQ7yZOnJgbb7wxjz76aJ5++ulceeWVefDBB19xzMKFC7Pjjjtm+vTpmTNnTj91CoOP6aAAAPS78ePH52//9m+z5557ZtiwYZk8eXI6Ol7+X01HjhyZxYsXZ/PNN8+8efOy//775+67784mm2zSj13D4OBMIAAAbXHYYYfltttuy4033pjNNtss22233cuuO3To0Gy++eZJkilTpmTs2LGZP39+f7UKg4oQCABAWyxZsiRJsnjx4lx66aWZMePlHjOdLF26NMuXL0+SLFiwIPfff3+23XbbfukTBhvTQQEAaIsPfOADefTRR7Puuuvm29/+djbddNNcdtllOfroo7N06dK8973vTWdnZ66++urceOONOeGEE9LR0ZF11lknZ555ZjbbbLN27wIMSEIgAAAvcNJJJ/XL7+yxxx49n+fMmdNzs5fDDz98lf0ceOCBPbV58+Zl3rx5fd5jfx0L6E+mgwIAADSIEAgAANAgQiAAAECDCIEAAAANIgQCAAA0iBAIAADQIEIgAABAgwiBAAAADSIEAgAANIgQCAAA0CBCIAAAQIMIgQAAAA0iBAIAADSIEAgAANAgQiAAAECDCIEAAAANIgQCAMAAdt9996Wzs7Pntckmm+T0009PkpxxxhkZN25cJkyYkOOOO+4F4xYvXpxhw4bl1FNPbUPXtFNHuxsAAADW3Lhx49LV1ZUkWb58eUaNGpX3v//9ue6663L55ZfnjjvuyNChQ7NkyZIXjDv22GPznve8pw0d025CIAAADBLXXHNNxo4dmze96U35whe+kOOPPz5Dhw5NkowYMaJnvR//+MfZdttts9FGG7WrVdrIdFAAABgkLrzwwsyYMSNJMn/+/MyZMye77LJLpk+fnltvvTVJ8tRTT+WrX/1qTjzxxHa2ShsJgQAAMAg8++yzueKKK3LggQcmSbq7u/PYY4/lV7/6VU455ZQcdNBBqbXmxBNPzLHHHpthw4a1uWPaxXRQAAAYBH76059mp512ypZbbpkkGT16dA444ICUUrLzzjtnyJAhWbZsWW6++eZccsklOe644/LHP/4xQ4YMyfrrr5+jjjqqzXtAfxECAQBgELjgggt6poImyf77759rr702u+++e+bPn59nn302W2yxRebMmdOzzkknnZRhw4YJgA1jOigAAAxwTz/9dGbPnp0DDjigpzZz5swsWLAgEydOzMEHH5xzzz03pZQ2dsnawplAAADoQxddvHO//M6sM8fm6p/t+YLavvsl++63YZJk2aPH56KLXzhm+wkr3i+6+KL+aDEHHXhLv/wOr8yZQAAAgAYRAgEAABpECAQAAGgQIRAAAKBBhEAAAIAGEQIBAAAaRAgEAABoECEQAACgQYRAAACAlfzxj3/MBz/4wbz1rW/N+PHj88tf/jJJcsYZZ2TcuHGZMGFCjjvuuJ7177jjjrztbW/LhAkTMmnSpPzpT39qV+urpaPdDQAAAKxNjjnmmOy999655JJL8uyzz+bpp5/Oddddl8svvzx33HFHhg4dmiVLliRJuru789GPfjTnnXdeJk+enEcffTTrrrtum/fglQmBAAAALY8//nhuvPHGnHPOOUmS9dZbL+utt15mzZqV448/PkOHDk2SjBgxIknys5/9LDvssEMmT56cJNl8883b0vdrYTooAABAy4IFCzJ8+PB8/OMfz4477pjDDz88Tz31VObPn585c+Zkl112yfTp03PrrbcmSebPn59SSvbaa6/stNNO+drXvtbmPXh1QiAAAEBLd3d3brvtthx55JG5/fbbs9FGG+UrX/lKuru789hjj+VXv/pVTjnllBx00EGptaa7uzs33XRTzj///Nx000257LLLcs0117R7N16REAgAANAyevTojB49OrvsskuS5IMf/GBuu+22jB49OgcccEBKKdl5550zZMiQLFu2LKNHj8706dOzxRZbZMMNN8w+++yT2267rc178cqEQAAAgJY3vvGN2XrrrXPfffclSa655ppsv/322X///XPttdcmWTEF9Nlnn80WW2yRvfbaK3fccUeefvrpdHd354Ybbsj222/fzl14VW4MAwAADAiTL7m6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\n",
      "text/plain": [
       "<Figure size 1080x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "offers_ignored_dict={}\n",
    "for i in range(1,11):\n",
    "    offers_ignored_dict[i]=sum(final_profile['offer_{}_ignored'.format(i)])\n",
    "\n",
    "    \n",
    "plt.figure(figsize = (15, 8))\n",
    "offers_ignored_dict_df = pd.DataFrame(list(offers_ignored_dict.items()))\n",
    "offers_ignored_dict_df.columns =[\"offer_id\", \"Count\"]\n",
    "\n",
    "\n",
    "offers_ignored_dict_df  = offers_ignored_dict_df.sort_values('Count',ascending=False).reset_index()\n",
    "\n",
    "ax=sns.barplot(x='offer_id', y='Count', data=offers_ignored_dict_df , order=offers_ignored_dict_df ['offer_id'])\n",
    "values=[x for x in offers_ignored_dict.values()]\n",
    "labels=[x for x in offers_ignored_dict.keys()]\n",
    "\n",
    "\n",
    "values, labels= zip(*sorted(zip(values,labels)))\n",
    "values=list(values)\n",
    "values.reverse()\n",
    "for i, p in enumerate(ax.patches):\n",
    "    height = p.get_height()\n",
    "    ax.text(p.get_x()+p.get_width()/2., height + 0.1,values[i],ha=\"center\")\n",
    "    "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Offer 2 is the most ignored offer and offer 5 is the least ignored offer."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 301,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style type=\"text/css\">\n",
       "</style>\n",
       "<table id=\"T_d6552_\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th class=\"col_heading level0 col0\" >offer_id</th>\n",
       "      <th class=\"col_heading level0 col1\" >reward</th>\n",
       "      <th class=\"col_heading level0 col2\" >difficulty</th>\n",
       "      <th class=\"col_heading level0 col3\" >duration</th>\n",
       "      <th class=\"col_heading level0 col4\" >email</th>\n",
       "      <th class=\"col_heading level0 col5\" >mobile</th>\n",
       "      <th class=\"col_heading level0 col6\" >social</th>\n",
       "      <th class=\"col_heading level0 col7\" >web</th>\n",
       "      <th class=\"col_heading level0 col8\" >bogo</th>\n",
       "      <th class=\"col_heading level0 col9\" >informational</th>\n",
       "      <th class=\"col_heading level0 col10\" >discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td id=\"T_d6552_row0_col0\" class=\"data row0 col0\" >2</td>\n",
       "      <td id=\"T_d6552_row0_col1\" class=\"data row0 col1\" >10</td>\n",
       "      <td id=\"T_d6552_row0_col2\" class=\"data row0 col2\" >10</td>\n",
       "      <td id=\"T_d6552_row0_col3\" class=\"data row0 col3\" >120</td>\n",
       "      <td id=\"T_d6552_row0_col4\" class=\"data row0 col4\" >1</td>\n",
       "      <td id=\"T_d6552_row0_col5\" class=\"data row0 col5\" >1</td>\n",
       "      <td id=\"T_d6552_row0_col6\" class=\"data row0 col6\" >1</td>\n",
       "      <td id=\"T_d6552_row0_col7\" class=\"data row0 col7\" >1</td>\n",
       "      <td id=\"T_d6552_row0_col8\" class=\"data row0 col8\" >1</td>\n",
       "      <td id=\"T_d6552_row0_col9\" class=\"data row0 col9\" >0</td>\n",
       "      <td id=\"T_d6552_row0_col10\" class=\"data row0 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_d6552_row1_col0\" class=\"data row1 col0\" >5</td>\n",
       "      <td id=\"T_d6552_row1_col1\" class=\"data row1 col1\" >5</td>\n",
       "      <td id=\"T_d6552_row1_col2\" class=\"data row1 col2\" >20</td>\n",
       "      <td id=\"T_d6552_row1_col3\" class=\"data row1 col3\" >240</td>\n",
       "      <td id=\"T_d6552_row1_col4\" class=\"data row1 col4\" >1</td>\n",
       "      <td id=\"T_d6552_row1_col5\" class=\"data row1 col5\" >0</td>\n",
       "      <td id=\"T_d6552_row1_col6\" class=\"data row1 col6\" >0</td>\n",
       "      <td id=\"T_d6552_row1_col7\" class=\"data row1 col7\" >1</td>\n",
       "      <td id=\"T_d6552_row1_col8\" class=\"data row1 col8\" >0</td>\n",
       "      <td id=\"T_d6552_row1_col9\" class=\"data row1 col9\" >0</td>\n",
       "      <td id=\"T_d6552_row1_col10\" class=\"data row1 col10\" >1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n"
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x1be8dda42b0>"
      ]
     },
     "execution_count": 301,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio[(portfolio['offer_id']==2)| (portfolio['offer_id']==5)].style.hide_index()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Offer 2 belongs to BOGO(Buy one Get one) offer type.The only reason for this to be topping this is list must be the duration.120hr to complete this offer with a difficulty of 10?.This might fall into couldn't complete category.Offer 5 is the least ignored offer. How can offer 5 be the least ignored offer and third most accidentally completed offer while also being least intentionally completed offer?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 4. Offer 5 !\n",
    "        \n",
    "    \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 302,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[Text(0.5, 0, 'Offer 5'), Text(0, 0.5, 'Count')]"
      ]
     },
     "execution_count": 302,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA4EAAAHgCAYAAAAbnWgaAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAA3MklEQVR4nO3de7xVdZ3/8ddHSVTQRLmEHIw0VC7qUVBQy8tY4SXzBqmjec9fjJblhXSaGS0zbcqfpiVlUwr+nIzRvOSUSaCmpSIigaAgoQnqCJrkbZSOfn5/7AVuDwc4h84+h3PW6/l47Mde+7O+a+3v2medtfd7r8uOzESSJEmSVA4btHcHJEmSJEltxxAoSZIkSSViCJQkSZKkEjEESpIkSVKJGAIlSZIkqUQMgZIkSZJUIl1qNeOI2AH4eVVpW+DfgIlFfQDwDPDZzHylmOYC4FTgHeBLmfmboj4MuB7YBPgVcFau5bctevbsmQMGDGi15ZEkSZKkjuTRRx99KTN7Na5HW/xOYERsCDwHjADOAP6SmZdFxPlAj8z8akQMBn4G7AFsDfwW2D4z34mIacBZwENUQuBVmfnrNT3n8OHDc/r06bVbKEmSJElaj0XEo5k5vHG9rQ4HPQD4U2b+GTgMmFDUJwCHF8OHATdl5tuZ+TSwANgjIvoCm2fmg8Xev4lV00iSJEmSWqCtQuAxVPbyAfTJzBcAivveRb0fsKhqmsVFrV8x3LguSZIkSWqhmofAiNgI+AzwX2tr2kQt11Bv6rlOj4jpETF96dKlLeuoJEmSJJVAW+wJPAiYkZkvFo9fLA7xpLhfUtQXA/2rpqsDni/qdU3UV5GZ12bm8Mwc3qvXKuc/SpIkSVLptUUIPJb3DgUFuAM4sRg+Ebi9qn5MRHSNiI8AA4FpxSGjr0XEyIgI4ISqaSRJkiRJLVCzn4gAiIhNgU8C/6eqfBkwKSJOBZ4FxgBk5pyImATMBRqAMzLznWKasbz3ExG/Lm6SJEmSpBZqk5+IaA/+RIQkSZKkMmvvn4iQJEmSJK0HDIGSJEmSVCKGQEmSJEkqEUOgJEmSJJWIIbCDW7ZsGaNHj2bHHXdk0KBBPPjggxx99NHU19dTX1/PgAEDqK+vB2Dy5MkMGzaMnXbaiWHDhjF16tSV81m+fDmnn34622+/PTvuuCO33HJLOy2RJEmSpFqq6U9EqPbOOussDjzwQG6++WaWL1/Om2++yc9//vOV48855xw++MEPAtCzZ09++ctfsvXWW/P4448zatQonnvuOQAuueQSevfuzfz583n33Xf5y1/+0i7LI0mSJKm2/ImIDuzVV19ll112YeHChUTEKuMzk2222YapU6cycODAVcb17NmT559/nq5du9K/f3+efPJJunXr1lbdlyRJklRD/kREJ7Rw4UJ69erFySefzK677sppp53GG2+8sXL8/fffT58+fVYJgAC33HILu+66K127dmXZsmUA/Ou//iu77bYbY8aM4cUXX2yrxZAkSZLUhgyBHVhDQwMzZsxg7NixPPbYY3Tr1o3LLrts5fif/exnHHvssatMN2fOHL761a/yox/9aOV8Fi9ezN57782MGTPYc889Offcc9tsOSRJkiS1HUNgB1ZXV0ddXR0jRowAYPTo0cyYMQOoBLtf/OIXHH300e+bZvHixRxxxBFMnDiR7bbbDoCtttqKTTfdlCOOOAKAMWPGrJyPJEmSpM7FENiBfehDH6J///7MmzcPgClTpjB48GAAfvvb37LjjjtSV1e3sv2yZcs45JBDuPTSS9l7771X1iOCQw89lHvvvXeV+UiSJEnqXLwwTAc3c+ZMTjvtNJYvX862227LddddR48ePTjppJMYOXIkX/jCF1a2/eY3v8mll176vnME7777bnr37s2f//xnPve5z7Fs2TJ69erFddddxzbbbNMeiyRJkiSpFazuwjCGwEaGnTexBr1RW3j0Oye0dxckSZKk9YZXB5UkSZIkGQIlSZIkqUwMgZIkSZJUIoZASZIkSSoRQ6AkSZIklYghUJIkSZJKxBAoSZIkSSViCJQkSZKkEjEESpIkSVKJGAIlSZIkqUQMgZIkSZJUIoZASZIkSSoRQ6AkSZIklYghUJIkSZJKxBAoSZIkSSViCJQkSZKkEjEESpIkSVKJGAIlSZIkqUQMgZIkSZJUIoZASZIkSSoRQ6AkSZIklYghUJIkSZJKxBAoSZIkSSViCJQkSZKkEjEESpIkSVKJGAIlSZIkqUQMgZIkSZJUIoZASZIkSSoRQ6AkSZIklYghUJIkSZJKxBAoSZIkSSViCJQkSZKkEjEESpIkSVKJGAIlSZIkqUQMgZIkSZJUIoZASZIkSSoRQ6AkSZIklYghUJIkSZJKxBAoSZIkSSViCJQkSZKk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\n",
      "text/plain": [
       "<Figure size 1080x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "offer_5_sent=sum(offer_5_activity['offer_5_received'])\n",
    "offer_5_seen=sum(offer_5_activity['offer_5_viewed'])\n",
    "offer_5_completed=sum(offer_5_activity['offer_5_completed'])\n",
    "offer_5_accidentallycompleted=sum(offer_5_activity['offer_5_accidentallycompleted'])\n",
    "offer_5_ignored=sum(offer_5_activity['offer_5_ignored'])\n",
    "offer_5_didnotcomplete=sum(offer_5_activity['offer_5_didnotcomplete'])\n",
    "\n",
    "labels=['Sent','Seen','Completed','Accidentally Completed','Ignored','Didnot Complete']\n",
    "values=[offer_5_sent,offer_5_seen,offer_5_completed,offer_5_accidentallycompleted,offer_5_ignored,offer_5_didnotcomplete]\n",
    "\n",
    "offer_5_plot_df=pd.DataFrame(list(zip(labels,values)),columns=['Type','Count'])\n",
    "\n",
    "plt.figure(figsize = (15, 8))\n",
    "ax=sns.barplot(x='Type', y='Count',data=offer_5_plot_df)\n",
    "\n",
    "values=list(offer_5_plot_df['Count'])\n",
    "for i, p in enumerate(ax.patches):\n",
    "    height = p.get_height()\n",
    "    ax.text(p.get_x()+p.get_width()/2., height + 0.1,values[i],ha=\"center\")\n",
    "ax.set(xlabel='Offer 5', ylabel='Count')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "7668 notifications about the offer 5 were sent out,out of them only 2663 were seen by the users.Is that the reason for the offer 5 to be in least in intentionally completed list and 3rd in  accidentally completed list and again the least one in ignored list.Checking stats about other offer might answer this question."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "7668 notifications about the offer were sent out,out of them only 2663 were seen by the users.Is that the reason for the offer 5 to be in least in intentionally completed list and 3rd in  accidentally completed list and again the least one in ignored list. So it is least ignored and 3rd in accidentally completed because it is seen by less users and least in intentionally completed because of the difficulty."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 303,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x576 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x576 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x576 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x576 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x576 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x576 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x576 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x576 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "<Figure size 1080x576 with 0 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA4EAAAHhCAYAAADQwbu/AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAyf0lEQVR4nO3de7QddXk//veThGuQIpBQTFCEXwQCyiUpoHwVBFuCItAKiqXC14oBv6JoVdTaKr3Q4kJsvdQrIkhRykUKtiqNIIJWgQBBiFwLCJQI8RJFWBISPr8/ziYeSIAcPDs7J/N6rbXXnv3smdnPzDonOe+Zz8yu1loAAADohnGDbgAAAIBVRwgEAADoECEQAACgQ4RAAACADhECAQAAOkQIBAAA6JAJ/VpxVW2T5N+GlbZK8sEkX+rVt0xyZ5LXttZ+0Vvm/UnelGRpkre31i7q1WckOS3Jekm+nuTY9jTfbbHpppu2LbfcctS2BwAAYCy5+uqrf9pam/TEeq2K7wmsqvFJ/jfJbknemuTnrbUTq+p9SZ7dWntvVU1P8pUkuyZ5TpJvJXlBa21pVV2Z5NgkP8hQCPx4a+0bT/WZM2fObHPnzu3fRgEAAKzGqurq1trMJ9ZX1XDQfZL8T2vtx0kOTHJ6r356koN60wcmOau19nBr7Y4ktyXZtao2T7Jha+37vbN/Xxq2DAAAACOwqkLgoRk6y5ckm7XWFiRJ73lyrz4lyd3DlrmnV5vSm35iHQAAgBHqewisqrWTHJDknKebdQW19hT1FX3W7KqaW1VzFy5cOLJGAQAAOmBVnAncL8k1rbX7eq/v6w3xTO/5/l79niRbDFtuapJ7e/WpK6gvp7X2udbazNbazEmTlrv+EQAAoPNWRQh8fX47FDRJLkxyRG/6iCQXDKsfWlXrVNXzk0xLcmVvyOgDVbV7VVWSw4ctAwAAwAj07SsikqSq1k/yh0mOGlY+McnZVfWmJHclOSRJWmvzq+rsJD9KsiTJW1trS3vLvCW//YqIb/QeAAAAjNAq+YqIQfAVEQAAQJcN+isiAAAAWA0IgQAAAB0iBAIAAHSIEAgAANAhQiAAA7do0aIcfPDB2XbbbbPddtvl+9//fl73utdlp512yk477ZQtt9wyO+20U5Jkzpw5mTFjRl74whdmxowZueSSS5atZ/HixZk9e3Ze8IIXZNttt8155503oC0CgNVXX78iAgBWxrHHHptZs2bl3HPPzeLFi/PQQw/l3/7t35a9/653vSu/93u/lyTZdNNN87WvfS3Pec5zcsMNN2TffffN//7v/yZJTjjhhEyePDm33HJLHn300fz85z8fyPYAwOrMV0QAMFC/+tWvsuOOO+b2229PVS33fmstz33uc3PJJZdk2rRpy7236aab5t57780666yTLbbYIjfddFMmTpy4qtoHgNWWr4hYhVY0rClJPvGJT2SbbbbJ9ttvn+OOOy5J8sgjj+SII47IC1/4wmy33Xb5x3/8x2XrmTVrVnbcccdsv/32Ofroo7N06dKBbA+wYqP1u77XXntlm222WTb08f777x/I9gzK7bffnkmTJuWNb3xjdt555xx55JF58MEHl71/+eWXZ7PNNlsuACbJeeedl5133jnrrLNOFi1alCT567/+6+yyyy455JBDct99962qzQCAMUMI7IPHhjXddNNNue6667Lddtvl29/+di644IL88Ic/zPz58/Pud787SXLOOefk4YcfzvXXX5+rr746n/3sZ3PnnXcmSc4+++xcd911ueGGG7Jw4cKcc845A9wq1gQjCS133nln1ltvvWXB5Oijj06SPPDAA8tqO+20UzbddNO84x3vGNQmDdRo/a4nyZlnnpl58+Zl3rx5mTx58oC2aDCWLFmSa665Jm95y1ty7bXXZuLEiTnxxBOXvf+Vr3wlr3/965dbbv78+Xnve9+bz372s8vWc88992SPPfbINddckxe/+MXL9n/XjMbveuIABcAaq7W2Rj5mzJjRBuGXv/xl23LLLdujjz76uPohhxzS5syZs9z8X/7yl9v+++/fHnnkkfbTn/60TZs2rf3sZz973DyLFy9u+++/fzvrrLP62jtrvsMPP7x9/vOfb6219vDDD7df/OIX7ZJLLmn77LNP+81vftNaa+2+++5rrbV2xx13tO233/5p17nLLru073znO/1rejU1mr/re+65Z7vqqqtWSd+rowULFrTnPe95y15fdtll7ZWvfGVrrbVHHnmkTZ48ud19992PW+buu+9u06ZNa9/97neX1R599NG2/vrrt6VLl7bWWrvrrrva9OnT+78Bq6HR+l3v+s/mY37xi1+017zmNW2bbbZp2267bfvv//7v1lprH//4x9sLXvCCNn369Pae97yntTa0P9ddd9224447th133LEdddRRrbXWHnzwwfbKV76ybbPNNm369Ontve9978C2Z5BGsi8f8+Mf/7hNnDixnXTSSctq++67b3vRi17Upk+f3o466qi2ZMmSVbodMFYkmdtWkJWcCRxlTzas6ZZbbsnll1+e3XbbLXvuuWeuuuqqJMnBBx+ciRMnZvPNN89zn/vcvPvd787GG2+8bH377rtvJk+enGc961k5+OCDB7VZrAF+9atf5bLLLsub3vSmJMnaa6+djTbaKJ/+9Kfzvve9L+uss06SjOgs1K233pr7778/L33pS/vS8+pstH/X3/jGN2annXbK3/3d36WtoddqP5nf//3fzxZbbJGbb745SXLxxRdn+vTpSZJvfetb2XbbbTN16tRl8y9atCivetWr8o//+I/ZY489ltWrKq9+9atz6aWXLreeLunH73rXjeSsf5JsvfXWy87sf+Yzn1lWf/e7352bbrop1157bb73ve/lG9/4xiA2Z6BGui+T5J3vfGf222+/x9WMlqIfRjKK4sorr1w2SmLHHXfM+eefv2w9H/jAB7LFFltkgw02GMh2rAwhcJQ92bCmJUuW5Be/+EV+8IMf5KSTTsprX/vatNZy5ZVXZvz48bn33ntzxx135OSTT87tt9++bH0XXXRRFixYkIcffvhxt0GHkRppaEmSO+64IzvvvHP23HPPXH755cut8ytf+Upe97rXrfBmHmu60fxdP/PMM3P99dfn8ssvz+WXX54zzjhjwFu36n3iE5/IYYcdlhe96EWZN29e/vIv/zJJctZZZy03FPSTn/xkbrvttvzd3/3dcsMUP/zhD+f444/Pi170opxxxhk5+eSTV/m2DNpo/653+QBFMnqhev3118/LX/7yZevYZZddcs899/S3+dXMM9mX//7v/56tttoq22+//ePWteGGGyYZ+rd48eLFnfx/iNE3koMUO+ywQ+bOnZt58+blm9/8Zo466qgsWbIkSfLqV786V1555SA35Wn5iohRNnXq1EydOjW77bZbkqGj/yeeeGKmTp2aP/mTP0lVZdddd824cePy05/+NF/+8pcza9asrLXWWpk8eXL22GOPzJ07N1tttdWyda677ro54IADcsEFF+QP//APB7VpA7Fo0aIceeSRueGGG1JVOfXUU3PRRRfl85//fCZNmpQk+Yd/+Ie88pWvzOLFi3PUUUdl7ty5GTduXD72sY9lr732SjJ0k50FCxZkyZIleelLX5p/+Zd/yfjx4we4ZaveY6HlE5/4RHbbbbcce+yxy4WWq666Kq997Wtz++23Z/PNN89dd92VTTbZJFdffXUOOuigzJ8/f9l/vMnQH+hdDCzJ6P6uT5kyJUnyrGc9K3/6p3+aK6+8MocffvggN+9JffJdX+vbuv/vnh9aNn3m3383STJzk9dkya2P/9yNsmM+fPRZj1v27A9fsWz6tX/wnmXTF37suiTX9aXfY05+dV/W+7sazd/1M888M1OmTMkDDzyQ17zmNTnjjDNW25/Nfhkeqq+77rrMmDEjH/vYx5aF6g984ANZd91185GPfCR/8Ad/kOS3oXrDDTfM3//93y83WmLRokX52te+lmOPPXYQmzQwI92XDz74YD784Q9nzpw5+chHPrLc+vbdd99ceeWV2W+//YyW4nf22EGK0047LcnQQYq11177SQ9SrL/++suW/c1vfvO4AxG77777qmv8GXImcJQ92bCmgw46aNmZvFtuuSWLFy/Opptuuuy25621PPjgg/nBD36QbbfdNr/+9a+zYMGCJEP/oX/961/PtttuO7DtGpQVHZFJhoaGPDbU5pWvfGWS5POf/3yS5Prrr8+cOXPyrne9K48++mgSw0aSFYeWa6655klDyzrrrJNNNtkkSTJjxoxsvfXWueWWW5at77rrrsuSJUsyY8aMgWzPoI3W7/qSJUvy05/+NMnQHUT/4z/+IzvssMPAtouxbzR/11d0gKJrRnrW/7FQfe211+ajH/1o/vRP/zS/+tWvHre+17/+9Xn729/+uAO+XTDSffmhD30o73znO590SJ3RUisevnj88cdnypQpy0ZKfP3rX08yNOpk+I3dxo0bl3nz5iVJFi9enNmzZ+cFL3hBtt1225x33nkD3KrBeCajKK644opsv/32eeELX5jPfOYzmTBh7JxfGzudjrIZ7/lS39b90FZ/lF32nJVHly7JOhtNzvNmHZlxt6ydH3/zWznpU6emxk/I1L0Oy8zjzsjSxc/Oj/97fs6aNDVpySY7vDRvPGNeHnnwO/mfr/5THl36SNIezbOeOz23Tp2YL/ah76tPWj2P6j7ZEZkn86Mf/Sj77LNPkqGjNBtttFHmzp2bXXfd1bCRPD60bLPNNstCy9Zbb51LLrkke+211+NCy8KFC7Pxxhtn/Pjxuf3223Prrbc+7g+WJ7tj4+rmOy/bs2/rPuLBh3LAzJlZ8mjL5uutm/dNe0HW/f4Pct4tt+T5J5+ctWpc/mKr5+eyPffKi5YuzTduuTlbbbBBWkv2+/3N8otj3pZvLV2aY394XZY82vJoWmZstFFecN/9+c6XvzLq/e552XdGfZ2sfkbrd33JkiVZtGhRNt1002UHKF7xilcMevNWuZGe9Z80adKyMwbDQ/XMmUNf0zV79uxMmzatk3dVHum+vOKKK3LuuefmuOOOy6JFizJu3Lisu+66OeaYY5ats8ujpZLfHiw/99xzs3jx4jz00EO56KKL8s53vnO5aysPO+ywHHbYYUmGDpgfeOCB2WmnnZIkJ5xwQiZPnpxbbrkljz76aH7+85+v6k0ZuJGOoqiq7Lbbbpk/f35uvPHGHHHEEdlvv/2y7rrrDnpTVkpnQ2A/rT/5edn2DX+zXP35rzp6udr4tdfNVgccs1x9rYm/l23fcHw/2hsznmzYSDJ0TdCXvvSlzJw5MyeffHKe/exnZ8cdd8wFF1yQQw89NHfffXeuvvrq3H333dl1112TGDaS/Pa6q8WLF2errbbKF7/4xUycODF//ud/nh122CFrr712Tj/99FRVLrvssnzwgx/MhAkTMn78+HzmM5953I1Mzj777GVHF7tq2gYb5HM777Jc/a9WcNZ+/fHj8zfbLX+TkvXGj1/hOuB3MRq/6w8++GD23XffPPLII1m6dGle8YpX5M1vfvOgN22VG80DaH/1V3+VX/7ylznllFMGvFWDMdJ9Ofz61OOPPz4bbLBBjjnmmPz617/OAw88kM0333zZaKku3qBspAfLh3vigdxTTz01N910U5Jk3Lhx2XTTTUe939XdMzng85jtttsuEydOzA033LDsgM/qrtbUi7xnzpzZ5s6d+6Tv9/NM4Fizup4JnDt3bnbfffd873vfW3ZEZsMNN8wxxxyTTTfdNFWVv/7rv86CBQty6qmnZsmSJXnPe96Tb3/723ne856XRx55JEcddVQOPPDAZev8zW9+k8MOOyxHH330anvEcI9P7PH0M3XE9972vd95Hf08EzjWjMaZwH5eEzjWjMY1gSf8WTcPSK3IB/713N9p+RtP6N9wwBsX3JYPnn9yHln6SKZuvHlO+JPjst5a6+avzj8pNy34n6w1fkLeM+vo7L71zvmv+ZflExeflgnjxmdcjcsx+xyRl2/7kvzklwuz90mHZqtJz81a49dKkhy2+4E5eOarRr3f7T6w96ivc7TMmzcvRx555AoPUMybNy9rr712PvKRj2TvvR+/DY+FwHe/+9257777sv/+++fhhx/O0qVLs/fee+ef/umfxtRQvNEwb968zJ49O9OnT3/cwfKTTjopp512WjbccMPHHSwfbuutt84FF1yQHXbYIYsWLcoLX/jCHHLIIbn00kuz9dZb55Of/GQ222yzAW3Z4Lz0pS/NKaeckm222SbHH398HnzwwWy99da5995787d/+7e55ZZbss8+++Suu+7KnXfemS222CITJkzIj3/847z4xS/OD3/4w8cF6A022CC//vWvB7hFSVVd3VpbLpkKgay2IfAnP/lJdt9992VfqH355ZfnxBNPzH/+538um+fOO+/M/vvvnxtuuGG55V/ykpfklFNOWe4W8aeffnquuuqqfPKTn+xr/8+UEPhbQuDoEgJHlxA4ulbnEDjWjEYIPP7443/3RtYQq+u+GOnB8sdcccUVOfLII3P99dcnybKzWueee25e85rX5KMf/WiuvfbaTt74bSQHKc4444yceOKJWWuttTJu3Lh88IMfzEEHHZQkOe644/LlL3859957b57znOfkyCOPHNjP0ZOFwG4dMmFMebJhIwsWLMjmm2+eJDn//POX3UTjoYceSmstEydOzJw5czJhwoRMnz7dsBEAYI3zZMMXh5/Be/Ob35z999//ccs98at3Ntlkk6y//vr54z/+4yTJIYccki984QurYAuemR3Pvai/H/C+E1JJ7kiy18W9m2Ed9IaMP+gNWZrknT9/JDn3omS9yZnwNx9NS7I0yYeWJB96rLdd98kmu+6TTXqrPD/J+X3o+7qD933GywqBrNZWdF3L29/+9sybNy9VlS233DKf/exnkyT3339/9t1334wbNy5TpkxZdgTrwQcfzAEHHPC4YSNHH7389ZkAAGPFSA+WJ8mjjz6ac845J5dddtmyWlXl1a9+dS699NLsvffey9bDmk0IZFTc9bcv7Mt6N07y1QMee/U/eeATL8sJ05JMS5KW5I488vk/yl0Z+r6TOYc9dkH0fcnp++eu3qvzlo3aGpfk0tz7Dzv3pd8kee4Hr+/bugEAHjOSg+VJctlll2Xq1KnLfT3J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\n",
      "text/plain": [
       "<Figure size 1080x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "offer_sent_dict={}\n",
    "for i in range(1,11):\n",
    "    offer_sent_dict[i]=sum(final_profile['offer_{}_received'.format(i)])\n",
    "    \n",
    "    plt.figure(figsize = (15, 8))\n",
    "offer_sent_dict_df = pd.DataFrame(list(offer_sent_dict.items()))\n",
    "offer_sent_dict_df.columns =[\"offer_id\", \"Count\"]\n",
    "\n",
    "ax=sns.barplot(x='offer_id', y='Count', data=offer_sent_dict_df)\n",
    "values=[x for x in offer_sent_dict.values()]\n",
    "labels=[x for x in offer_sent_dict.keys()]\n",
    "\n",
    "for i, p in enumerate(ax.patches):\n",
    "    height = p.get_height()\n",
    "    ax.text(p.get_x()+p.get_width()/2., height + 0.1,values[i],ha=\"center\")\n",
    "    "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "All offers are sent equally. What about the viewed rate?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 304,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA4EAAAHhCAYAAADQwbu/AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAA0eElEQVR4nO3de5hWZb3/8fdXEA2E0ABDBkUvUDmPwlbMLM0DUHnMA4ppbs1yW6KVpvnb1dZNmtnurMUuE90kohbSCUE80HarNOgg4iHYQjFIDro1DBUcuH9/zHIaYFAG55mHmfv9uq7netb6Pvdaz3ctFfnMuteaSCkhSZIkScrDDuVuQJIkSZLUegyBkiRJkpQRQ6AkSZIkZcQQKEmSJEkZMQRKkiRJUkYMgZIkSZKUkY7lbqBUevTokfr161fuNiRJkiSpLObPn/9iSqnnpvV2GwL79etHVVVVuduQJEmSpLKIiD83VXc6qCRJkiRlxBAoSZIkSRkxBEqSJElSRgyBkiRJkpQRQ6AkSZIkZcQQKEmSJEkZMQRKkiRJUkYMgZIkSZKUEUOgJEmSJGXEEChJkiRJGTEESpIkSVJGDIEl8Morr3DyySez//77M3DgQB5++OGGz66//noighdffLGhds0119C/f3/2228/7rnnHgBeffVVKisrG149evTg4osvbu1DkSRJktTOdCx3A+3RhAkTGDNmDHfeeSfr1q3jtddeA2D58uXMnj2bPffcs2HsU089xdSpU1m0aBHPP/88Rx11FH/605/o2rUr1dXVDeNGjBjBSSed1NqHIkmSJKmd8UpgC1u9ejVz587l3HPPBaBTp050794dgEsuuYTrrruOiGgYf/fddzNu3Dh22mkn9t57b/r378+8efM22ufixYupra3lsMMOa7Xj2F40dVX1X//1Xxk2bBiVlZUcc8wxPP/88wBMmTJlo6unO+ywQ0OQvv322xk2bBiDBw/msssuK+MRSZIkSeVlCGxhzz33HD179uScc87hgAMO4LzzzmPNmjXMmDGDPn36MHz48I3Gr1ixgr59+zasV1RUsGLFio3G3HbbbZx22mkbhcdcvHVV9ZlnnmHBggUMHDiQSy+9lCeeeILq6mo+/vGPc9VVVwEwfvx4qqurqa6u5tZbb6Vfv35UVlby0ksvcemllzJnzhwWLVrECy+8wJw5c8p8ZJIkSVJ5GAJbWF1dHY899hgXXHABjz/+OF26dOHrX/86EydObAgrjaWUNqttGvamTp3K6aefXrKet1dbuqrarVu3hjFr1qxpMhzfdtttDefsueeeY99996Vnz54AHHXUUdx1112tcASSJEnS9scQ2MIqKiqoqKjg4IMPBuDkk0/mscceY+nSpQwfPpx+/fpRU1PDgQceyF//+lcqKipYvnx5w/Y1NTXsscceDesLFiygrq6OESNGtPqxlNuWrqoCXHnllfTt25cpU6Y0Ga5vv/32hhDYv39/nnnmGZYtW0ZdXR3Tp0/f6JznpDnTa2fPns2IESMYOnQoI0aM4L777mvYj9NrJUmS2i5DYAt7//vfT9++fXn22WcBmDNnDgceeCC1tbUsW7aMZcuWUVFRwWOPPcb73/9+jjvuOKZOncratWtZunQpixcv5qCDDmrYX+MrWrlp6qrqtddeC8DEiRNZvnw548eP54c//OFG2z366KN07tyZIUOGALDrrrty4403ctppp3HYYYfRr18/OnbM85lIzZle26NHD37961+zcOFCJk+ezCc/+UkAp9c20pxQ/dJLL3HEEUewyy678LnPfW6j/cyfP5+hQ4fSv39/LrrooiZnCEiSJLUUQ2AJ/OAHP2D8+PEMGzaM6upqvvKVr2xx7ODBgzn11FMZNGgQY8aM4Uc/+hEdOnRo+HzatGnZhsAtXVVt7IwzzthsamdT02ePPfZYHn30UR5++GH2228/BgwYUNrmt0PNnV57wAEHNFyVHjx4MG+88QZr1651em0jzQnVO++8M1dffTXXX3/9Zvu54IILmDRpEosXL2bx4sXMnDmztQ9FkiRlJM/LIcCIS28p7RcccRE7AsuBo77x640+et8pVzH6m79rVOlL95O+BsD/u28V/+++f/S26ye+zvifzQM2fmJoS5r/rbNKtu93o/FV1f322485c+YwaNAgFi9e3BDiZsyYwf7779+wzYYNG7jjjjuYO3fuRvuqra2lV69evPzyy9xwww1MmzatVY9le9B4eu2CBQsYMWIE3/ve9+jSpQtXXnklt9xyC+9973u5//77N9v2rrvu4oADDmCnnXbaaHptRUUF06dPZ926dWU4ovJ6K1TffPPNQH2o7tSp00ZjGofqLl268MEPfpAlS5ZsNGblypWsXr2aQw45BICzzjqL6dOnM3bs2NIfhCRJypJXArVda+qq6uWXX86QIUMYNmwYs2bN4nvf+17D+Llz51JRUcE+++yz0X4mTJjAoEGDOPTQQ7n88svZd999W/tQym5bp9cuWrSIL3/5y/zkJz8BnF77lndzz2pjK1asoKKiomG9qScES5IktaRor/eejBw5MlVVVW3x85JfCWxDWuJK4F+uGtoCnbQPe351YblbaNJf//pXRo0axbJlywD4wx/+wLXXXstvf/vbhjF//vOf+djHPsaTTz4J1D+o6CMf+Qg///nPOfTQQ5vc76RJk1iyZAnXXXddyY9he1JVVcWoUaN46KGHOPjgg5kwYQLdunXj6quvbhhzzTXX8MYbb/Bv//ZvDbWbb76ZqqqqhrD9xz/+kSuuuIJ7770XqP/nct111/HrX288g0CSJKm5ImJ+SmnkpnWvBEqZaOqhRW9Nr31L4+m1r7zyCh/72Me45pprNguAtbW1AA3Ta88777xWOortx7bes9rUfmpqahrWN31CsCRJUkszBEoZac702h/+8IcsWbKEq6++msrKSiorKxvCn9Nrmx+qt6R379507dqVRx55hJQSt9xyC8cff3xJe5ckSXlzOqicDtrC3u100EN/0PS0yxw99PmHyt3C26qurua8885j3bp17LPPPvz85z/nvPPO49lnn2WHHXZgr7324sc//jF9+vQBoF+/fqxevZp169bRvXt3Zs2axaBBg6iqquJTn/oUr7/+OmPHjuUHP/hBwwNlJEmSttWWpoPm9zQHSVl58EMfLun+v925C3TuAv/3Mk8cfwIXAez2vvoP/7aaJaefwVvPA528514bbbvqsxfwYLH8o7e2eWIhcz98eEl6/fDcB995kCRJavecDipJkiRJGTEESpIkSVJGDIGSJEmSlBFDoCRJkiRlxBAoSZIkSRkxBEqSJElSRgyBkiRJkpQRQ6AkSZIkZcQQKEmSJEkZMQRKkiRJUkYMgZIkSZKUEUOgJEmSJGXEEChJkiRJGTEESpIkSVJGDIGSJEmSlJGShsCI6B4Rd0bEMxHxdEQcEhG7RcTsiFhcvO/aaPwVEbEkIp6NiNGN6iMiYmHx2fcjIkrZtyRJkiS1V6W+Evg9YGZKaX9gOPA0cDkwJ6U0AJhTrBMRg4BxwGBgDHBDRHQo9nMjcD4woHiNKXHfkiRJktQulSwERkQ34EPAzwBSSutSSq8AxwOTi2GTgROK5eOBqSmltSmlpcAS4KCI6A10Syk9nFJKwC2NtpEkSZIkNUMprwTuA6wCfh4Rj0fETyOiC7B7SmklQPHeqxjfB1jeaPuaotanWN60LklqJ/r168fQoUOprKxk5MiRACxYsIBDDjmEoUOHcuyxx7J69eqG8ddccw39+/dnv/3245577mmoX3nllfTt25dddtml1Y9BkqS2opQhsCNwIHBjSukAYA3F1M8taOo+v/Q29c13EHF+RFRFRNWqVaua268kqYzuv/9+qqurqaqqAuC8887j2muvZeHChZx44ol861vfAuCpp55i6tSpLFq0iJkzZ/Iv//IvrF+/HoBjjz2WefPmle0YthdNherq6mpGjRrVUHvrPE2ZMoXKysqG1w477EB1dTUAY8aMYfjw4QwePJjPfvazDedZktS2lTIE1gA1KaVHi/U7qQ+FLxRTPCneaxuN79to+wrg+aJe0UR9MymlSSmlkSmlkT179myxA5Ektb5nn32WD33oQwAcffTR3HXXXQDcfffdjBs3jp122om9996b/v37NwSaUaNG0bt377L1vD3ZNFRfdtllfO1rX6O6upqrrrqKyy67DIDx48dTXV1NdXU1t956K/369aOyshKAadOmsWDBAp588klWrVrFHXfcUa7DkSS1oJKFwJTSX4HlEbFfUToSeAqYAZxd1M4G7i6WZwDjImKniNib+gfAzCumjL4aEaOKp4Ke1WgbSVI7EBEcc8wxjBgxgkmTJgEwZMgQZsyYAcAdd9zB8uX1dwysWLGCvn3/8TPDiooKVqxY0fpNtzER0TCl9m9/+xt77LHHZmNuu+02Tj/99Ib1bt26AVBXV8e6devw4dyS1D50LPH+Pw9MiYhOwHPAOdQHz2kRcS7wF+AUgJTSooiYRn1QrAMuTCm9Ne/kAuBm4D3A74uXJKmdeOihh9hjjz2ora3l6KOPZv/99+emm27ioosu4qqrruK4446jU6dOANQ/I2xjhpONvRWqI4LPfOYznH/++Xz3u99l9OjRfOlLX2LDhg38z//8z2bb3X777dx998Y/Zx09ejTz5s1j7NixnHzyya11CJKkEippCEwpVQMjm/joyC2MnwhMbKJeBQxp0eYkSduNt65K9erVixNPPJF58+bxpS99iVmzZgHwpz/9id/+9rdA/ZW/t64KAtTU1DR5VStn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d13DOsBTTz3FkUceCUCvXr3o3r07VVVVPPfcc+y777707NkTgKOOOoq77rqrlY+mvJobqO+44w7Wrl3LwoULmT9/Pj/5yU9YtmwZXbt2pbq6uuG11157cdJJJ5XrsMqmuaEa4IknnuCQQw5h8ODBDB06lDfeeAOA+fPnM3ToUPr3789FF11ESqlVj0Wtb6tCYEQcujU1SZKk9mb9+vVUVlbSq1cvjj76aA4++GBmzJhBnz59GD58+EZjhw8fzt13301dXR1Lly5l/vz5LF++nP79+/PMM8+wbNky6urqmD59OsuXLy/TEZVHcwN1RLBmzRrq6up4/fXX6dSpE926ddton4sXL6a2tpbDDjus9Q5kO9HcUF1XV8eZZ57Jj3/8YxYtWsQDDzzAjjvuCMAFF1zApEmTWLx4MYsXL2bmzJllOSa1nq29EviDraxJkiS1Kx06dKC6upqamhrmzZvHE088wcSJE7nqqqs2G/vP//zPVFRUMHLkSC6++GI+8IEP0LFjR3bddVduvPFGTjvtNA477DD69etHx44dy3A05dWcQH3yySfTpUsXevfuzZ577smXvvQldtttt43G3HbbbZx22mkbhcdcNDdUz5o1i2HDhjWc5/e973106NCBlStXsnr1ag455BAigrPOOovp06e3+vGodb3tnz4RcQjwAaBnRHyh0UfdgA6lbEySJGl70r17dw4//HDuvvtuli5d2vCX6ZqaGg488EDmzZvH+9//fr7zne80bPOBD3yAAQMGAHDsscdy7LHHAjBp0iQ6dMjvr1JvBepXXnmFE088sSFQz5o1a7Ox8+bNo0OHDjz//PO8/PLLHHbYYRx11FHss88+DWOmTp3Krbfe2pqHsF1Zv349I0aMYMmSJVx44YVvG6r/9Kc/ERGMHj2aVatWMW7cOC677DJWrFhBRUVFw7iKigpWrFjR2oeiVvZOP4LqBOxSjOvaqL4aOLlUTUmSJG0PVq1axY477kj37t15/fXXuffee/nyl79MbW1tw5h+/fpRVVVFjx49eO2110gp0aVLF2bPnk3Hjh0ZNGgQALW1tfTq1YuXX36ZG264gWnTppXrsMpuawL1L37xC8aMGcOOO+5Ir169OPTQQ6mqqmoIgQsWLKCuro4RI0aU81DKqjmhuq6ujv/+7//mj3/8I507d+bII49kxIgRm02xBbK8spqb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\n",
      "text/plain": [
       "<Figure size 1080x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "offer_seen_dict={}\n",
    "for i in range(1,11):\n",
    "    offer_seen_dict[i]=sum(final_profile['offer_{}_viewed'.format(i)])\n",
    "    \n",
    "    \n",
    "plt.figure(figsize = (15, 8))\n",
    "offer_seen_dict_df = pd.DataFrame(list(offer_seen_dict.items()))\n",
    "offer_seen_dict_df.columns =[\"offer_id\", \"Count\"]\n",
    "\n",
    "offer_seen_dict_df  = offer_seen_dict_df.sort_values('Count',ascending=False).reset_index()\n",
    "\n",
    "ax=sns.barplot(x='offer_id', y='Count', data=offer_seen_dict_df,order=offer_seen_dict_df['offer_id'])\n",
    "values=[x for x in offer_seen_dict.values()]\n",
    "labels=[x for x in offer_seen_dict.keys()]\n",
    "\n",
    "values, labels= zip(*sorted(zip(values,labels)))\n",
    "values=list(values)\n",
    "values.reverse() \n",
    "\n",
    "for i, p in enumerate(ax.patches):\n",
    "    height = p.get_height()\n",
    "    ax.text(p.get_x()+p.get_width()/2., height + 0.1,values[i],ha=\"center\")\n",
    "    \n",
    "    \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Yes!! Offer 5 is the least seen(viewed) offer by the customers."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 305,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{1: 88.29866826275625,\n",
       " 2: 95.99575307143941,\n",
       " 3: 52.38095238095239,\n",
       " 4: 52.341062079281976,\n",
       " 5: 32.931906036277134,\n",
       " 6: 95.85274229902329,\n",
       " 7: 96.31689717378232,\n",
       " 8: 88.40885142255004,\n",
       " 9: 95.95498783454988,\n",
       " 10: 52.17915849796411}"
      ]
     },
     "execution_count": 305,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "offer_seen_rate={}\n",
    "for i in range(1,11):\n",
    "    offer_seen_rate[i]=(offer_seen_dict[i]/offer_sent_dict[i])*100\n",
    "offer_seen_rate"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "offer 5 has the worst seen rate of only 35%.So it is least in ignored list and 3rd in accidentally completed list because it is seen by less users.The reason for offer 5 being least in intentionally completed must be because of the difficulty.So why do offer 5 has only 35% seen rate?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 306,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style type=\"text/css\">\n",
       "</style>\n",
       "<table id=\"T_b1a32_\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th class=\"col_heading level0 col0\" >offer_id</th>\n",
       "      <th class=\"col_heading level0 col1\" >reward</th>\n",
       "      <th class=\"col_heading level0 col2\" >difficulty</th>\n",
       "      <th class=\"col_heading level0 col3\" >duration</th>\n",
       "      <th class=\"col_heading level0 col4\" >email</th>\n",
       "      <th class=\"col_heading level0 col5\" >mobile</th>\n",
       "      <th class=\"col_heading level0 col6\" >social</th>\n",
       "      <th class=\"col_heading level0 col7\" >web</th>\n",
       "      <th class=\"col_heading level0 col8\" >bogo</th>\n",
       "      <th class=\"col_heading level0 col9\" >informational</th>\n",
       "      <th class=\"col_heading level0 col10\" >discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row0_col0\" class=\"data row0 col0\" >1</td>\n",
       "      <td id=\"T_b1a32_row0_col1\" class=\"data row0 col1\" >10</td>\n",
       "      <td id=\"T_b1a32_row0_col2\" class=\"data row0 col2\" >10</td>\n",
       "      <td id=\"T_b1a32_row0_col3\" class=\"data row0 col3\" >168</td>\n",
       "      <td id=\"T_b1a32_row0_col4\" class=\"data row0 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row0_col5\" class=\"data row0 col5\" >1</td>\n",
       "      <td id=\"T_b1a32_row0_col6\" class=\"data row0 col6\" >1</td>\n",
       "      <td id=\"T_b1a32_row0_col7\" class=\"data row0 col7\" >0</td>\n",
       "      <td id=\"T_b1a32_row0_col8\" class=\"data row0 col8\" >1</td>\n",
       "      <td id=\"T_b1a32_row0_col9\" class=\"data row0 col9\" >0</td>\n",
       "      <td id=\"T_b1a32_row0_col10\" class=\"data row0 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row1_col0\" class=\"data row1 col0\" >2</td>\n",
       "      <td id=\"T_b1a32_row1_col1\" class=\"data row1 col1\" >10</td>\n",
       "      <td id=\"T_b1a32_row1_col2\" class=\"data row1 col2\" >10</td>\n",
       "      <td id=\"T_b1a32_row1_col3\" class=\"data row1 col3\" >120</td>\n",
       "      <td id=\"T_b1a32_row1_col4\" class=\"data row1 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row1_col5\" class=\"data row1 col5\" >1</td>\n",
       "      <td id=\"T_b1a32_row1_col6\" class=\"data row1 col6\" >1</td>\n",
       "      <td id=\"T_b1a32_row1_col7\" class=\"data row1 col7\" >1</td>\n",
       "      <td id=\"T_b1a32_row1_col8\" class=\"data row1 col8\" >1</td>\n",
       "      <td id=\"T_b1a32_row1_col9\" class=\"data row1 col9\" >0</td>\n",
       "      <td id=\"T_b1a32_row1_col10\" class=\"data row1 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row2_col0\" class=\"data row2 col0\" >3</td>\n",
       "      <td id=\"T_b1a32_row2_col1\" class=\"data row2 col1\" >0</td>\n",
       "      <td id=\"T_b1a32_row2_col2\" class=\"data row2 col2\" >0</td>\n",
       "      <td id=\"T_b1a32_row2_col3\" class=\"data row2 col3\" >96</td>\n",
       "      <td id=\"T_b1a32_row2_col4\" class=\"data row2 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row2_col5\" class=\"data row2 col5\" >1</td>\n",
       "      <td id=\"T_b1a32_row2_col6\" class=\"data row2 col6\" >0</td>\n",
       "      <td id=\"T_b1a32_row2_col7\" class=\"data row2 col7\" >1</td>\n",
       "      <td id=\"T_b1a32_row2_col8\" class=\"data row2 col8\" >0</td>\n",
       "      <td id=\"T_b1a32_row2_col9\" class=\"data row2 col9\" >1</td>\n",
       "      <td id=\"T_b1a32_row2_col10\" class=\"data row2 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row3_col0\" class=\"data row3 col0\" >4</td>\n",
       "      <td id=\"T_b1a32_row3_col1\" class=\"data row3 col1\" >5</td>\n",
       "      <td id=\"T_b1a32_row3_col2\" class=\"data row3 col2\" >5</td>\n",
       "      <td id=\"T_b1a32_row3_col3\" class=\"data row3 col3\" >168</td>\n",
       "      <td id=\"T_b1a32_row3_col4\" class=\"data row3 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row3_col5\" class=\"data row3 col5\" >1</td>\n",
       "      <td id=\"T_b1a32_row3_col6\" class=\"data row3 col6\" >0</td>\n",
       "      <td id=\"T_b1a32_row3_col7\" class=\"data row3 col7\" >1</td>\n",
       "      <td id=\"T_b1a32_row3_col8\" class=\"data row3 col8\" >1</td>\n",
       "      <td id=\"T_b1a32_row3_col9\" class=\"data row3 col9\" >0</td>\n",
       "      <td id=\"T_b1a32_row3_col10\" class=\"data row3 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row4_col0\" class=\"data row4 col0\" >5</td>\n",
       "      <td id=\"T_b1a32_row4_col1\" class=\"data row4 col1\" >5</td>\n",
       "      <td id=\"T_b1a32_row4_col2\" class=\"data row4 col2\" >20</td>\n",
       "      <td id=\"T_b1a32_row4_col3\" class=\"data row4 col3\" >240</td>\n",
       "      <td id=\"T_b1a32_row4_col4\" class=\"data row4 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row4_col5\" class=\"data row4 col5\" >0</td>\n",
       "      <td id=\"T_b1a32_row4_col6\" class=\"data row4 col6\" >0</td>\n",
       "      <td id=\"T_b1a32_row4_col7\" class=\"data row4 col7\" >1</td>\n",
       "      <td id=\"T_b1a32_row4_col8\" class=\"data row4 col8\" >0</td>\n",
       "      <td id=\"T_b1a32_row4_col9\" class=\"data row4 col9\" >0</td>\n",
       "      <td id=\"T_b1a32_row4_col10\" class=\"data row4 col10\" >1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row5_col0\" class=\"data row5 col0\" >6</td>\n",
       "      <td id=\"T_b1a32_row5_col1\" class=\"data row5 col1\" >3</td>\n",
       "      <td id=\"T_b1a32_row5_col2\" class=\"data row5 col2\" >7</td>\n",
       "      <td id=\"T_b1a32_row5_col3\" class=\"data row5 col3\" >168</td>\n",
       "      <td id=\"T_b1a32_row5_col4\" class=\"data row5 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row5_col5\" class=\"data row5 col5\" >1</td>\n",
       "      <td id=\"T_b1a32_row5_col6\" class=\"data row5 col6\" >1</td>\n",
       "      <td id=\"T_b1a32_row5_col7\" class=\"data row5 col7\" >1</td>\n",
       "      <td id=\"T_b1a32_row5_col8\" class=\"data row5 col8\" >0</td>\n",
       "      <td id=\"T_b1a32_row5_col9\" class=\"data row5 col9\" >0</td>\n",
       "      <td id=\"T_b1a32_row5_col10\" class=\"data row5 col10\" >1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row6_col0\" class=\"data row6 col0\" >7</td>\n",
       "      <td id=\"T_b1a32_row6_col1\" class=\"data row6 col1\" >2</td>\n",
       "      <td id=\"T_b1a32_row6_col2\" class=\"data row6 col2\" >10</td>\n",
       "      <td id=\"T_b1a32_row6_col3\" class=\"data row6 col3\" >240</td>\n",
       "      <td id=\"T_b1a32_row6_col4\" class=\"data row6 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row6_col5\" class=\"data row6 col5\" >1</td>\n",
       "      <td id=\"T_b1a32_row6_col6\" class=\"data row6 col6\" >1</td>\n",
       "      <td id=\"T_b1a32_row6_col7\" class=\"data row6 col7\" >1</td>\n",
       "      <td id=\"T_b1a32_row6_col8\" class=\"data row6 col8\" >0</td>\n",
       "      <td id=\"T_b1a32_row6_col9\" class=\"data row6 col9\" >0</td>\n",
       "      <td id=\"T_b1a32_row6_col10\" class=\"data row6 col10\" >1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row7_col0\" class=\"data row7 col0\" >8</td>\n",
       "      <td id=\"T_b1a32_row7_col1\" class=\"data row7 col1\" >0</td>\n",
       "      <td id=\"T_b1a32_row7_col2\" class=\"data row7 col2\" >0</td>\n",
       "      <td id=\"T_b1a32_row7_col3\" class=\"data row7 col3\" >72</td>\n",
       "      <td id=\"T_b1a32_row7_col4\" class=\"data row7 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row7_col5\" class=\"data row7 col5\" >1</td>\n",
       "      <td id=\"T_b1a32_row7_col6\" class=\"data row7 col6\" >1</td>\n",
       "      <td id=\"T_b1a32_row7_col7\" class=\"data row7 col7\" >0</td>\n",
       "      <td id=\"T_b1a32_row7_col8\" class=\"data row7 col8\" >0</td>\n",
       "      <td id=\"T_b1a32_row7_col9\" class=\"data row7 col9\" >1</td>\n",
       "      <td id=\"T_b1a32_row7_col10\" class=\"data row7 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row8_col0\" class=\"data row8 col0\" >9</td>\n",
       "      <td id=\"T_b1a32_row8_col1\" class=\"data row8 col1\" >5</td>\n",
       "      <td id=\"T_b1a32_row8_col2\" class=\"data row8 col2\" >5</td>\n",
       "      <td id=\"T_b1a32_row8_col3\" class=\"data row8 col3\" >120</td>\n",
       "      <td id=\"T_b1a32_row8_col4\" class=\"data row8 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row8_col5\" class=\"data row8 col5\" >1</td>\n",
       "      <td id=\"T_b1a32_row8_col6\" class=\"data row8 col6\" >1</td>\n",
       "      <td id=\"T_b1a32_row8_col7\" class=\"data row8 col7\" >1</td>\n",
       "      <td id=\"T_b1a32_row8_col8\" class=\"data row8 col8\" >1</td>\n",
       "      <td id=\"T_b1a32_row8_col9\" class=\"data row8 col9\" >0</td>\n",
       "      <td id=\"T_b1a32_row8_col10\" class=\"data row8 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_b1a32_row9_col0\" class=\"data row9 col0\" >10</td>\n",
       "      <td id=\"T_b1a32_row9_col1\" class=\"data row9 col1\" >2</td>\n",
       "      <td id=\"T_b1a32_row9_col2\" class=\"data row9 col2\" >10</td>\n",
       "      <td id=\"T_b1a32_row9_col3\" class=\"data row9 col3\" >168</td>\n",
       "      <td id=\"T_b1a32_row9_col4\" class=\"data row9 col4\" >1</td>\n",
       "      <td id=\"T_b1a32_row9_col5\" class=\"data row9 col5\" >1</td>\n",
       "      <td id=\"T_b1a32_row9_col6\" class=\"data row9 col6\" >0</td>\n",
       "      <td id=\"T_b1a32_row9_col7\" class=\"data row9 col7\" >1</td>\n",
       "      <td id=\"T_b1a32_row9_col8\" class=\"data row9 col8\" >0</td>\n",
       "      <td id=\"T_b1a32_row9_col9\" class=\"data row9 col9\" >0</td>\n",
       "      <td id=\"T_b1a32_row9_col10\" class=\"data row9 col10\" >1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n"
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x1be8e073160>"
      ]
     },
     "execution_count": 306,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio.style.hide_index()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Only offer 5 was not sent through the mobile app or social media."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Data Preprocessing"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Seperating the customers who intentionally completed the offers.For that the customers must receive the offer first then view it and finally should spent the required amount before the offer duration ends."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 307,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in range(1,11):\n",
    "    locals()['offer_{}_sent_ids'.format(i)]=locals()['offer_{}_activity'.format(i)][locals()['offer_{}_activity'.format(i)]['offer_{}_received'.format(i)]==1]['customer_id'].to_list()\n",
    "    locals()['offer_{}_activity'.format(i)]=locals()['offer_{}_activity'.format(i)][locals()['offer_{}_activity'.format(i)]['offer_{}_received'.format(i)]>=1]\n",
    "# offer_1_sent_ids=offer_1_activity[offer_1_activity['offer_1_received']==1]['customer_id'].to_list()\n",
    "# offer_1_activity=offer_1_activity[offer_1_activity['offer_1_received']==1] "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 308,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in range(1,11):\n",
    "    locals()['offer_{}_activity'.format(i)].drop({'offer_{}_received'.format(i),'offer_{}_viewed'.format(i),'offer_{}_accidentallycompleted'.format(i),'offer_{}_ignored'.format(i),'offer_{}_didnotcomplete'.format(i)},axis=1,inplace=True)\n",
    "    locals()['offer_{}_activity'.format(i)].rename({'offer_{}_completed'.format(i):'offer_complete_status'},axis=1,inplace=True)\n",
    "    "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Adding 'offer_complete_status' column for every offer_(x)_activity df and 'offer_id' column to merge all together into a single dataframe."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 309,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in range(1,11):\n",
    "    locals()['offer_{}_activity'.format(i)]['offer_complete_status']=np.where(locals()['offer_{}_activity'.format(i)]['offer_complete_status']>=1,1,0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 310,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Converting the year of joining to the number of years a customer has been a member\n",
    "import datetime\n",
    "profile['years_member']=datetime.datetime.today().year - profile['year_joined']\n",
    "profile.drop({'year_joined'},axis=1,inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 311,
   "metadata": {},
   "outputs": [],
   "source": [
    "profile['income']=profile['income'].astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 313,
   "metadata": {},
   "outputs": [],
   "source": [
    "#merging all offer acitivity df's with profile to create individual profile_offer_x df's\n",
    "for i in range(1,11):\n",
    "    locals()['profile_offer_{}'.format(i)]=pd.merge(profile,locals()['offer_{}_activity'.format(i)],how='inner',on='customer_id')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 314,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>income</th>\n",
       "      <th>years_member</th>\n",
       "      <th>offer_complete_status</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>100000</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14</td>\n",
       "      <td>61</td>\n",
       "      <td>F</td>\n",
       "      <td>57000</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>15</td>\n",
       "      <td>26</td>\n",
       "      <td>M</td>\n",
       "      <td>46000</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>17</td>\n",
       "      <td>49</td>\n",
       "      <td>M</td>\n",
       "      <td>52000</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>20</td>\n",
       "      <td>61</td>\n",
       "      <td>F</td>\n",
       "      <td>40000</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5559</th>\n",
       "      <td>16979</td>\n",
       "      <td>29</td>\n",
       "      <td>F</td>\n",
       "      <td>58000</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5560</th>\n",
       "      <td>16980</td>\n",
       "      <td>63</td>\n",
       "      <td>F</td>\n",
       "      <td>52000</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5561</th>\n",
       "      <td>16985</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>78000</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5562</th>\n",
       "      <td>16986</td>\n",
       "      <td>26</td>\n",
       "      <td>M</td>\n",
       "      <td>55000</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5563</th>\n",
       "      <td>16999</td>\n",
       "      <td>83</td>\n",
       "      <td>F</td>\n",
       "      <td>50000</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5564 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      customer_id  age gender  income  years_member  offer_complete_status\n",
       "0               4   75      F  100000             5                      1\n",
       "1              14   61      F   57000             5                      1\n",
       "2              15   26      M   46000             8                      1\n",
       "3              17   49      M   52000             8                      1\n",
       "4              20   61      F   40000             4                      0\n",
       "...           ...  ...    ...     ...           ...                    ...\n",
       "5559        16979   29      F   58000             5                      1\n",
       "5560        16980   63      F   52000             9                      1\n",
       "5561        16985   75      F   78000             6                      1\n",
       "5562        16986   26      M   55000             4                      0\n",
       "5563        16999   83      F   50000             6                      1\n",
       "\n",
       "[5564 rows x 6 columns]"
      ]
     },
     "execution_count": 314,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "profile_offer_1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 315,
   "metadata": {},
   "outputs": [],
   "source": [
    "filename='data/profile_cleaned.csv'\n",
    "profile.to_csv(filename,index=False,mode='w+')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 316,
   "metadata": {},
   "outputs": [],
   "source": [
    "#saving the files to csv\n",
    "for i in range(1,11):\n",
    "    filename='data/profile_offer_{}.csv'.format(i)\n",
    "    locals()['profile_offer_{}'.format(i)].to_csv(filename,index=False,mode='w+')\n",
    "    #locals()['profile_offer_{}'.format(i)] equivalent  profile_offer_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 317,
   "metadata": {},
   "outputs": [],
   "source": [
    "#adding offer_id column to every profile_offer_x df to replace the id with the offer attributes later on.\n",
    "for i in range(1,11):\n",
    "    locals()['profile_offer_{}'.format(i)]['offer_id']=i"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 318,
   "metadata": {},
   "outputs": [],
   "source": [
    "#creating profile_offers_list with all the dataframes to merge them to create a master_df\n",
    "profile_offers_list=[]\n",
    "for i in range(1,11):\n",
    "    profile_offers_list.append(locals()['profile_offer_{}'.format(i)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 348,
   "metadata": {},
   "outputs": [],
   "source": [
    "master_df=pd.concat(profile_offers_list).reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 349,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>income</th>\n",
       "      <th>years_member</th>\n",
       "      <th>offer_complete_status</th>\n",
       "      <th>offer_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>100000</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14</td>\n",
       "      <td>61</td>\n",
       "      <td>F</td>\n",
       "      <td>57000</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>15</td>\n",
       "      <td>26</td>\n",
       "      <td>M</td>\n",
       "      <td>46000</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>17</td>\n",
       "      <td>49</td>\n",
       "      <td>M</td>\n",
       "      <td>52000</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>20</td>\n",
       "      <td>61</td>\n",
       "      <td>F</td>\n",
       "      <td>40000</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55217</th>\n",
       "      <td>16982</td>\n",
       "      <td>84</td>\n",
       "      <td>M</td>\n",
       "      <td>93000</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55218</th>\n",
       "      <td>16985</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>78000</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55219</th>\n",
       "      <td>16989</td>\n",
       "      <td>64</td>\n",
       "      <td>M</td>\n",
       "      <td>51000</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55220</th>\n",
       "      <td>16993</td>\n",
       "      <td>21</td>\n",
       "      <td>F</td>\n",
       "      <td>72000</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55221</th>\n",
       "      <td>16994</td>\n",
       "      <td>60</td>\n",
       "      <td>M</td>\n",
       "      <td>113000</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>55222 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       customer_id  age gender  income  years_member  offer_complete_status  \\\n",
       "0                4   75      F  100000             5                      1   \n",
       "1               14   61      F   57000             5                      1   \n",
       "2               15   26      M   46000             8                      1   \n",
       "3               17   49      M   52000             8                      1   \n",
       "4               20   61      F   40000             4                      0   \n",
       "...            ...  ...    ...     ...           ...                    ...   \n",
       "55217        16982   84      M   93000             6                      0   \n",
       "55218        16985   75      F   78000             6                      0   \n",
       "55219        16989   64      M   51000             4                      0   \n",
       "55220        16993   21      F   72000             5                      0   \n",
       "55221        16994   60      M  113000             4                      0   \n",
       "\n",
       "       offer_id  \n",
       "0             1  \n",
       "1             1  \n",
       "2             1  \n",
       "3             1  \n",
       "4             1  \n",
       "...         ...  \n",
       "55217        10  \n",
       "55218        10  \n",
       "55219        10  \n",
       "55220        10  \n",
       "55221        10  \n",
       "\n",
       "[55222 rows x 7 columns]"
      ]
     },
     "execution_count": 349,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "master_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 350,
   "metadata": {},
   "outputs": [],
   "source": [
    "master_df=master_df.merge(portfolio,on='offer_id',how='outer')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 351,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>customer_id</th>\n",
       "      <th>age</th>\n",
       "      <th>gender</th>\n",
       "      <th>income</th>\n",
       "      <th>years_member</th>\n",
       "      <th>offer_complete_status</th>\n",
       "      <th>offer_id</th>\n",
       "      <th>reward</th>\n",
       "      <th>difficulty</th>\n",
       "      <th>duration</th>\n",
       "      <th>email</th>\n",
       "      <th>mobile</th>\n",
       "      <th>social</th>\n",
       "      <th>web</th>\n",
       "      <th>bogo</th>\n",
       "      <th>informational</th>\n",
       "      <th>discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>4</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>100000</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14</td>\n",
       "      <td>61</td>\n",
       "      <td>F</td>\n",
       "      <td>57000</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>15</td>\n",
       "      <td>26</td>\n",
       "      <td>M</td>\n",
       "      <td>46000</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>17</td>\n",
       "      <td>49</td>\n",
       "      <td>M</td>\n",
       "      <td>52000</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>20</td>\n",
       "      <td>61</td>\n",
       "      <td>F</td>\n",
       "      <td>40000</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55217</th>\n",
       "      <td>16982</td>\n",
       "      <td>84</td>\n",
       "      <td>M</td>\n",
       "      <td>93000</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55218</th>\n",
       "      <td>16985</td>\n",
       "      <td>75</td>\n",
       "      <td>F</td>\n",
       "      <td>78000</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55219</th>\n",
       "      <td>16989</td>\n",
       "      <td>64</td>\n",
       "      <td>M</td>\n",
       "      <td>51000</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55220</th>\n",
       "      <td>16993</td>\n",
       "      <td>21</td>\n",
       "      <td>F</td>\n",
       "      <td>72000</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55221</th>\n",
       "      <td>16994</td>\n",
       "      <td>60</td>\n",
       "      <td>M</td>\n",
       "      <td>113000</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>168</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>55222 rows × 17 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       customer_id  age gender  income  years_member  offer_complete_status  \\\n",
       "0                4   75      F  100000             5                      1   \n",
       "1               14   61      F   57000             5                      1   \n",
       "2               15   26      M   46000             8                      1   \n",
       "3               17   49      M   52000             8                      1   \n",
       "4               20   61      F   40000             4                      0   \n",
       "...            ...  ...    ...     ...           ...                    ...   \n",
       "55217        16982   84      M   93000             6                      0   \n",
       "55218        16985   75      F   78000             6                      0   \n",
       "55219        16989   64      M   51000             4                      0   \n",
       "55220        16993   21      F   72000             5                      0   \n",
       "55221        16994   60      M  113000             4                      0   \n",
       "\n",
       "       offer_id  reward  difficulty  duration  email  mobile  social  web  \\\n",
       "0             1      10          10       168      1       1       1    0   \n",
       "1             1      10          10       168      1       1       1    0   \n",
       "2             1      10          10       168      1       1       1    0   \n",
       "3             1      10          10       168      1       1       1    0   \n",
       "4             1      10          10       168      1       1       1    0   \n",
       "...         ...     ...         ...       ...    ...     ...     ...  ...   \n",
       "55217        10       2          10       168      1       1       0    1   \n",
       "55218        10       2          10       168      1       1       0    1   \n",
       "55219        10       2          10       168      1       1       0    1   \n",
       "55220        10       2          10       168      1       1       0    1   \n",
       "55221        10       2          10       168      1       1       0    1   \n",
       "\n",
       "       bogo  informational  discount  \n",
       "0         1              0         0  \n",
       "1         1              0         0  \n",
       "2         1              0         0  \n",
       "3         1              0         0  \n",
       "4         1              0         0  \n",
       "...     ...            ...       ...  \n",
       "55217     0              0         1  \n",
       "55218     0              0         1  \n",
       "55219     0              0         1  \n",
       "55220     0              0         1  \n",
       "55221     0              0         1  \n",
       "\n",
       "[55222 rows x 17 columns]"
      ]
     },
     "execution_count": 351,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "master_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 352,
   "metadata": {},
   "outputs": [],
   "source": [
    "master_df.to_csv('data/master_df.csv',index=False,mode='w+')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 353,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "101"
      ]
     },
     "execution_count": 353,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "master_df['age'].max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 354,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 354,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['age'].hist(figsize=(6,4))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Binning the values to handle imbalance in the data set.'jenkspy' library is used to find the natural break points in the values."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 355,
   "metadata": {},
   "outputs": [],
   "source": [
    "# breaks = jenkspy.jenks_breaks(master_df['age'], nb_class=5) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Using the natural breakpoints custom demographic groups are created."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 356,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 356,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYsAAAD5CAYAAADWfRn1AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAdY0lEQVR4nO3df5QdZZ3n8fdnEsWQTCAQ6Y1JZjpq/BGI4zFtjKPONIaV7OgY3IHdMChhNntyZPDHzMbVZDlnmdk52RNnh0VBYU5WMEGREFFIzrCwMDAtM3P4YVC0CYhmTAtNIhHBSCMEOn73j3p6LDo3/eRW9eXeNp/XOTld91v1VD3Pk6fv9z5V1bcUEZiZmY3lN9pdATMz63xOFmZmluVkYWZmWU4WZmaW5WRhZmZZk9tdgapmzpwZ3d3dlco+88wzTJ06dXwr9GvM/dUc91fz3GfNqdNf99133xMR8cpmy03YZNHd3c2OHTsqle3r66O3t3d8K/RrzP3VHPdX89xnzanTX5J+VKWcT0OZmVmWk4WZmWU5WZiZWZaThZmZZTlZmJlZlpOFmZllOVmYmVmWk4WZmWU5WZiZWdaE/Qtua0732psql12zcJjzapQf2PDeymXNrDN4ZmFmZllOFmZmluVkYWZmWU4WZmaW5WRhZmZZThZmZpaVTRaSrpK0T9IDo+IflfSwpJ2S/roUXydpV1p3eim+SFJ/WnepJKX4MZKuS/F7JHWPY/vMzGwcHMnMYhOwrByQdCqwHHhTRJwM/E2KLwBWACenMpdLmpSKXQGsBuanfyP7XAU8FRGvBS4BPl2jPWZm1gLZZBERdwJPjgqfD2yIiANpm30pvhzYEhEHImI3sAtYLGkWMD0i7oqIAK4GziiV2ZyWrweWjsw6zMysM1T9C+7XAe+StB54DvhERHwTmA3cXdpuMMVeSMuj46SfjwJExLCk/cCJwBOjDyppNcXshK6uLvr6+ipVfmhoqHLZiWrNwuHKZbum1Ct/tPX10Ti+6nKfNacd/VU1WUwGZgBLgLcCWyW9Gmg0I4gx4mTWvTgYsRHYCNDT0xNVH1h+ND4cvs7XdaxZOMzF/dW/GWbgnN7KZSeio3F81eU+a047+qvq3VCDwNejcC/wS2Bmis8tbTcH2JPicxrEKZeRNBk4jkNPe5mZWRtVTRY3Au8GkPQ64OUUp422AyvSHU7zKC5k3xsRe4GnJS1J1yPOBbalfW0HVqblM4E70nUNMzPrENlzC5KuBXqBmZIGgYuAq4Cr0u20zwMr0xv8TklbgQeBYeCCiDiYdnU+xZ1VU4Cb0z+AK4EvSdpFMaNYMT5NMzOz8ZJNFhFx9mFWffAw268H1jeI7wBOaRB/DjgrVw8zM2sf/wW3mZllOVmYmVmWk4WZmWU5WZiZWZaThZmZZTlZmJlZlpOFmZllOVmYmVmWk4WZmWU5WZiZWZaThZmZZTlZmJlZlpOFmZllOVmYmVmWk4WZmWVlk4WkqyTtSw86Gr3uE5JC0sxSbJ2kXZIelnR6Kb5IUn9ad2l6Yh7pqXrXpfg9krrHqW1mZjZOjmRmsQlYNjooaS7wb4FHSrEFFE+6OzmVuVzSpLT6CmA1xaNW55f2uQp4KiJeC1wCfLpKQ8zMrHWyySIi7qR43OlolwCfBMrPy14ObImIAxGxG9gFLJY0C5geEXelx69eDZxRKrM5LV8PLB2ZdZiZWWeodM1C0vuBxyLiO6NWzQYeLb0eTLHZaXl0/EVlImIY2A+cWKVeZmbWGtlncI8m6VjgQuA9jVY3iMUY8bHKNDr2aopTWXR1ddHX15erbkNDQ0OVy05UaxYOVy7bNaVe+aOtr4/G8VWX+6w57eivppMF8BpgHvCddLZoDvAtSYspZgxzS9vOAfak+JwGcUplBiVNBo6j8WkvImIjsBGgp6cnent7K1S/ePOqWnaiOm/tTZXLrlk4zMX9VYZKYeCc3splJ6KjcXzV5T5rTjv6q+nTUBHRHxEnRUR3RHRTvNm/JSJ+DGwHVqQ7nOZRXMi+NyL2Ak9LWpKuR5wLbEu73A6sTMtnAnek6xpmZtYhjuTW2WuBu4DXSxqUtOpw20bETmAr8CBwC3BBRBxMq88HvkBx0ftfgJtT/ErgREm7gP8CrK3YFjMza5HsuYWIODuzvnvU6/XA+gbb7QBOaRB/DjgrVw8zM2sf/wW3mZllOVmYmVmWk4WZmWVVvx9yAut/bH+tW0nrGNjw3rYc18ysDs8szMwsy8nCzMyynCzMzCzLycLMzLKcLMzMLMvJwszMspwszMwsy8nCzMyynCzMzCzLycLMzLKcLMzMLMvJwszMso7kSXlXSdon6YFS7H9J+p6k70q6QdLxpXXrJO2S9LCk00vxRZL607pL0+NVSY9gvS7F75HUPb5NNDOzuo5kZrEJWDYqdhtwSkS8Cfg+sA5A0gJgBXByKnO5pEmpzBXAaorncs8v7XMV8FREvBa4BPh01caYmVlrZJNFRNwJPDkqdmtEDKeXdwNz0vJyYEtEHIiI3RTP214saRYwPSLuiogArgbOKJXZnJavB5aOzDrMzKwzjMfzLP4TcF1ank2RPEYMptgLaXl0fKTMowARMSxpP3Ai8MToA0laTTE7oauri76+vkoV7poCaxYO5zdsgap1rqtOe+v2V7va3C5DQ0NHXZvrcp81px39VStZSLoQGAauGQk12CzGiI9V5tBgxEZgI0BPT0/09vY2U91/ddk127i4vz3PfRo4p7ctx63zsKc1C4dr9Ve72twufX19VB2bRyv3WXPa0V+V74aStBJ4H3BOOrUExYxhbmmzOcCeFJ/TIP6iMpImA8cx6rSXmZm1V6VkIWkZ8Cng/RHxi9Kq7cCKdIfTPIoL2fdGxF7gaUlL0vWIc4FtpTIr0/KZwB2l5GNmZh0ge25B0rVALzBT0iBwEcXdT8cAt6Vr0XdHxIcjYqekrcCDFKenLoiIg2lX51PcWTUFuDn9A7gS+JKkXRQzihXj0zQzMxsv2WQREWc3CF85xvbrgfUN4juAUxrEnwPOytXDzMzax3/BbWZmWU4WZmaW5WRhZmZZThZmZpblZGFmZllOFmZmltWe77wws18r3TW+TgaKr5Sp+pU0AxveW+vYdmQ8szAzsywnCzMzy3KyMDOzLCcLMzPLcrIwM7MsJwszM8tysjAzsywnCzMzy3KyMDOzrGyykHSVpH2SHijFTpB0m6QfpJ8zSuvWSdol6WFJp5fiiyT1p3WXpserkh7Bel2K3yOpe5zbaGZmNR3JzGITsGxUbC1we0TMB25Pr5G0gOKxqCenMpdLmpTKXAGspngu9/zSPlcBT0XEa4FLgE9XbYyZmbVGNllExJ0Uz8YuWw5sTsubgTNK8S0RcSAidgO7gMWSZgHTI+KuiAjg6lFlRvZ1PbB0ZNZhZmadoeoXCXZFxF6AiNgr6aQUnw3cXdpuMMVeSMuj4yNlHk37Gpa0HzgReGL0QSWtppid0NXVRV9fX7XKTym+uKwdqta5rjrtrdtf7WpzuwwNDR11ba77+1RnjB1tfQ3tGWPj/a2zjWYEMUZ8rDKHBiM2AhsBenp6ore3t0IV4bJrtnFxf3u+cHfgnN62HLfqN3pC8Utcp7/a1eZ26evro+rYnKjqjC+oN8aOtvEF7RljVe+GejydWiL93Jfig8Dc0nZzgD0pPqdB/EVlJE0GjuPQ015mZtZGVZPFdmBlWl4JbCvFV6Q7nOZRXMi+N52yelrSknQ94txRZUb2dSZwR7quYWZmHSI775N0LdALzJQ0CFwEbAC2SloFPAKcBRAROyVtBR4EhoELIuJg2tX5FHdWTQFuTv8ArgS+JGkXxYxixbi0zMzMxk02WUTE2YdZtfQw268H1jeI7wBOaRB/jpRszMysM/kvuM3MLMvJwszMspwszMwsy8nCzMyynCzMzCzLycLMzLKcLMzMLMvJwszMspwszMwsy8nCzMyynCzMzCzLycLMzLKcLMzMLMvJwszMspwszMwsq1aykPTnknZKekDStZJeIekESbdJ+kH6OaO0/TpJuyQ9LOn0UnyRpP607tL0ND0zM+sQlZOFpNnAx4CeiDgFmETxlLu1wO0RMR+4Pb1G0oK0/mRgGXC5pElpd1cAqykewzo/rTczsw5R9zTUZGCKpMnAscAeYDmwOa3fDJyRlpcDWyLiQETsBnYBiyXNAqZHxF3p2dtXl8qYmVkHyD5W9XAi4jFJf0PxDO5ngVsj4lZJXRGxN22zV9JJqchs4O7SLgZT7IW0PDp+CEmrKWYgdHV10dfXV6nuXVNgzcLhSmXrqlrnuuq0t25/tavN7TI0NHTUtbnu71OdMXa09TW0Z4xVThbpWsRyYB7wM+Crkj44VpEGsRgjfmgwYiOwEaCnpyd6e3ubqPGvXHbNNi7ur9z0WgbO6W3Lcc9be1PlsmsWDtfqr3a1uV36+vqoOjYnqjrjC+qNsaNtfEF7xlidd8zTgN0R8RMASV8Hfhd4XNKsNKuYBexL2w8Cc0vl51CcthpMy6PjZhNS/2P7a795VjWw4b1tOa79+qtzzeIRYImkY9PdS0uBh4DtwMq0zUpgW1reDqyQdIykeRQXsu9Np6yelrQk7efcUhkzM+sAda5Z3CPpeuBbwDDwbYpTRNOArZJWUSSUs9L2OyVtBR5M218QEQfT7s4HNgFTgJvTPzMz6xC1TtxHxEXARaPCByhmGY22Xw+sbxDfAZxSpy5mZtY6/gtuMzPLcrIwM7MsJwszM8tysjAzsywnCzMzy3KyMDOzLCcLMzPLcrIwM7MsJwszM8tysjAzsywnCzMzy3KyMDOzLCcLMzPLcrIwM7MsJwszM8tysjAzs6xayULS8ZKul/Q9SQ9JerukEyTdJukH6eeM0vbrJO2S9LCk00vxRZL607pL0+NVzcysQ9SdWXwWuCUi3gD8DsUzuNcCt0fEfOD29BpJC4AVwMnAMuBySZPSfq4AVlM8l3t+Wm9mZh2i8mNVJU0Hfg84DyAingeel7Qc6E2bbQb6gE8By4EtEXEA2C1pF7BY0gAwPSLuSvu9GjgDP4fbzDpY99qb2nbsTcumvuTHVERUKyi9GdgIPEgxq7gP+DjwWEQcX9ruqYiYIelzwN0R8eUUv5IiIQwAGyLitBR/F/CpiHhfg2OuppiB0NXVtWjLli2V6r7vyf08/mylorUtnH1cW47b/9j+ymW7plCrv9rV5nbx+GpenTE2Udtcx7zjJjFt2rRKZU899dT7IqKn2XKVZxap7FuAj0bEPZI+SzrldBiNrkPEGPFDgxEbKRIUPT090dvb21SFR1x2zTYu7q/T9OoGzulty3HPq/EpaM3C4Vr91a42t4vHV/PqjLGJ2uY6Ni2bStX3v6rqXLMYBAYj4p70+nqK5PG4pFkA6ee+0vZzS+XnAHtSfE6DuJmZdYjKySIifgw8Kun1KbSU4pTUdmBliq0EtqXl7cAKScdImkdxIfveiNgLPC1pSboL6txSGTMz6wB158ofBa6R9HLgh8CfUCSgrZJWAY8AZwFExE5JWykSyjBwQUQcTPs5H9gETKG4juGL22ZmHaRWsoiI+4FGF0qWHmb79cD6BvEdwCl16mJmZq3jv+A2M7MsJwszM8tysjAzsywnCzMzy3KyMDOzLCcLMzPLcrIwM7MsJwszM8tysjAzsywnCzMzy3KyMDOzLCcLMzPLcrIwM7MsJwszM8tysjAzs6zayULSJEnflvR36fUJkm6T9IP0c0Zp23WSdkl6WNLppfgiSf1p3aXpiXlmZtYhxmNm8XHgodLrtcDtETEfuD29RtICYAVwMrAMuFzSpFTmCmA1xaNW56f1ZmbWIWolC0lzgPcCXyiFlwOb0/Jm4IxSfEtEHIiI3cAuYLGkWcD0iLgrIgK4ulTGzMw6QN2ZxWeATwK/LMW6ImIvQPp5UorPBh4tbTeYYrPT8ui4mZl1iMrP4Jb0PmBfRNwnqfdIijSIxRjxRsdcTXG6iq6uLvr6+o6orqN1TYE1C4crla2rap3rqtPeuv3Vrja3i8dX8+r02URtcx1DQ0MvebsrJwvgHcD7Jf0B8ApguqQvA49LmhURe9Mppn1p+0Fgbqn8HGBPis9pED9ERGwENgL09PREb29vpYpfds02Lu6v0/TqBs7pbctxz1t7U+WyaxYO1+qvdrW5XTy+mldnjE3UNtexadlUqr7/VVX5NFRErIuIORHRTXHh+o6I+CCwHViZNlsJbEvL24EVko6RNI/iQva96VTV05KWpLugzi2VMTOzDtCKjz8bgK2SVgGPAGcBRMROSVuBB4Fh4IKIOJjKnA9sAqYAN6d/ZmbWIcYlWUREH9CXln8KLD3MduuB9Q3iO4BTxqMuZmY2/vwX3GZmluVkYWZmWU4WZmaW5WRhZmZZThZmZpblZGFmZllOFmZmluVkYWZmWU4WZmaW5WRhZmZZThZmZpblZGFmZllOFmZmluVkYWZmWU4WZmaW5WRhZmZZlZOFpLmS/kHSQ5J2Svp4ip8g6TZJP0g/Z5TKrJO0S9LDkk4vxRdJ6k/rLk2PVzUzsw5RZ2YxDKyJiDcCS4ALJC0A1gK3R8R84Pb0mrRuBXAysAy4XNKktK8rgNUUz+Wen9abmVmHqJwsImJvRHwrLT8NPATMBpYDm9Nmm4Ez0vJyYEtEHIiI3cAuYLGkWcD0iLgrIgK4ulTGzMw6gIr355o7kbqBOymeo/1IRBxfWvdURMyQ9Dng7oj4copfCdwMDAAbIuK0FH8X8KmIeF+D46ymmIHQ1dW1aMuWLZXqu+/J/Tz+bKWitS2cfVxbjtv/2P7KZbumUKu/2tXmdvH4al6dMTZR21zHvOMmMW3atEplTz311PsioqfZcpMrHa1E0jTga8CfRcTPx7jc0GhFjBE/NBixEdgI0NPTE729vU3XF+Cya7ZxcX/tplcycE5vW4573tqbKpdds3C4Vn+1q83t4vHVvDpjbKK2uY5Ny6ZS9f2vqlp3Q0l6GUWiuCYivp7Cj6dTS6Sf+1J8EJhbKj4H2JPicxrEzcysQ9S5G0rAlcBDEfG/S6u2AyvT8kpgWym+QtIxkuZRXMi+NyL2Ak9LWpL2eW6pjJmZdYA6c+V3AB8C+iXdn2L/DdgAbJW0CngEOAsgInZK2go8SHEn1QURcTCVOx/YBEyhuI5xc416mZnZOKucLCLin2h8vQFg6WHKrAfWN4jvoLg4bmZmHch/wW1mZllOFmZmluVkYWZmWU4WZmaW5WRhZmZZThZmZpblZGFmZllOFmZmluVkYWZmWU4WZmaW5WRhZmZZThZmZpblZGFmZllOFmZmluVkYWZmWU4WZmaW1THJQtIySQ9L2iVpbbvrY2Zmv9IRyULSJODzwL8DFgBnS1rQ3lqZmdmIjkgWwGJgV0T8MCKeB7YAy9tcJzMzSxQR7a4Dks4ElkXEf06vPwS8LSI+Mmq71cDq9PL1wMMVDzkTeKJi2aOR+6s57q/muc+aU6e/fjsiXtlsockVDzbe1CB2SBaLiI3AxtoHk3ZERE/d/Rwt3F/NcX81z33WnHb0V6echhoE5pZezwH2tKkuZmY2Sqcki28C8yXNk/RyYAWwvc11MjOzpCNOQ0XEsKSPAP8PmARcFRE7W3jI2qeyjjLur+a4v5rnPmvOS95fHXGB28zMOlunnIYyM7MO5mRhZmZZThZmZpZ1VCULSb2S7pe0U9I3SvGrJO2T9MAR7OO6tI/7JQ1Iuj/FuyU9W1r3ty1syktG0lslHUx/ODkS+/PUhw9IulbSKzL7+Gj63q+dkv46xU6U9A+ShiR9rtXtaDVJb5B0l6QDkj4xat0R95ekv5L03TSGbpX0qhRfXBpb35H0gVa3qZUkLS+1c4ekd6b4KyTdm9q4U9JfHuH+PiEpJM1Mr18mabOkfkkPSVrXyva0g6T/WhoTD6Tf0xPSuoHU9vsl7RiXA0bEUfEPOB54EPit9Pqk0rrfA94CPNDkPi8G/nta7m62fKf/o7gz7Q7g/wJnpthsYDcwJb3eCpw3xj5OBf4eOKbc78BU4J3Ah4HPtbut49BXJwFvBdYDnyjFm+2v6aXljwF/m5aPBSan5VnAvpHXE/EfMI1f3WDzJuB7aVnAtLT8MuAeYElmX3Mp7qT8ETAzxf4Y2FLquwGgu93tbmF//iFwR+n1wEhfjFFmoJljdNzMQtKNku5LnypWp9gqSd+X1Cfp/4x8EpX0Sklfk/TN9O8dY+z6j4GvR8QjABGxb2RFRNwJPNlkPQX8B+DaJps4rlrYXwAfBb5G8cZUNhmYImkyxS/iWH9AeT6wISIOwK/6PSKeiYh/Ap5rts11tKq/ImJfRHwTeKHB6iPur4j4eenlVNI3GUTELyJiOMVfQYNvOGiFFvbXUKR3LF7czoiIoRR/WfqXa+slwCdHbRfA1NTnU4DngZ83KNtyLf4dHXE2rX4vandGbJDtTkg/pwAPUHwyGwBOoBg4/0j6JAp8BXhnWv4t4KEx9vsZim+27QPuA84dtb6bJmYGFLORHaPKPwN8G/gG8K4J3l+zUzsmAZtIM4u07uPAEPAT4JpM/e4H/pLiE+I3gLeOWn8eL+HMolX9Vdr/X1CaWTTbX2n79cCjqX6vLMXfBuxM+/rARO8v4APA9yg+qL29FJ+Uxs0Q8OnMPt4PfDYtD/CrmcXLKL6Q9Cfp93L1SzXG2jDmjk19eEIpthv4FsV7XcO20+TMoiP+KG+Uj5XOx84FPgR8IyKeBJD0VeB1af1pwILiQz4A0yX9ZkQ83WC/k4FFwFKK/7S7JN0dEd+vWM/RmXwvxSmun0paBNwo6eR48SfFVmhVf30G+FREHCxtj6QZFN8IPA/4GfBVSR+MiC8fpn6TgRnAEorTNFslvTrSaG2DVvVXQxX6i4i4ELgwnWf/CHBRit8DnCzpjcBmSTdHRKtnZi3rr4i4AbhB0u8Bf5XKExEHgTdLOj6tPyUiDrmeKOlY4ELgPQ12vxg4CLyKYvz9o6S/j4gfNtX68dHqMfeHwD+P7C95R0TskXQScJuk70XEnZIuBM5K27xK6ZprKn/BWI3oqGQhqZeis94eEb+Q1EfxzbJvPEyR30jbPnsEux8EnoiIZ4BnJN0J/A7QdLJIU9t/T5F8AIjiNMvIqZb7JP0LxQAYn4tLjevRS+v6qwfYkgbtTOAPJA1TfBLaHRE/SXX4OvC7wOHe/AYpTv8FcK+kX6b9/eQI6jCuWtxfh3MazfVX2VeAm0jJYkREPCTpGeAUJu74+lfpTew1kmZGxBOl+M/SMZdRfCIf7TUUSfg7aZzOAb4laTHFaedbIuIFYJ+kf6YY0y9psniJ+nAFo05BRcSe9HOfpBsokuedEbGeYuaKpIGIePORHqTTrlkcBzyVOvUNFJ9GjwV+X9KM9Cb9R6Xtb6X45AWApDePse9twLskTU6fSN4GPFSxnqdRXJAbLB37lSoe4oSkVwPzaf3AbFl/RcS8iOiOiG7geuBPI+JG4BFgiaRjVfyGLmXsfrwReHc63uuAl9O+r6Ju5fg6nKb6S9L80sv3U5ymQcX3pk1Oy79N8RX9AxXq04yW9Zek16b+QNJbKMbFT9Pv0fEpPoX0u9ZoHxHRHxEnlcbpIPCWiPgxRb+/W4Wpqe4N99NiLR1zko4Dfp/i/W0kNlXSb44sU8y8snd65nTUzAK4BfiwpO9SZN+7gceA/0lxznsPxR1N+9P2HwM+n7afDNxJcXfNIdKnsVuA7wK/BL4wMrWVdC3QC8yUNAhcFBFXjlHPQzI5xTWM/5E+fR8EPjxqWtgKLeuvw4mIeyRdT3E+dJjiGs1Y31NzFXCVituSnwdWjpyCkjQATAdeLukM4D0R8WAz9WlSy/pL0r+h+JQ/HfilpD8DFlTorw2SXk8xRn9UOt47gbWSXkjr/rT8KbxFWjm+/gg4N7XnWeA/RkRImkVxim0SxYfZrRHxdxXq/nngixRvkgK+GBHfrbCfulr9O/oB4NZ0xmREF8XpO9I+vhIRt9RtyIT4bihJ0yJiKGXhGyi+aPCGdterU7m/muP+ao77q76J2IeddhrqcP4iXYh5gOIq/41trU3nc381x/3VHPdXfROuDyfEzKIZkv6E4lbFsuyV/gb7+Tww+h7nz0bEF+vUr9O4v5rj/mqO+6u+8erD2vX4dUsWZmY2/ibKaSgzM2sjJwszM8tysjAzsywnCzMzy/r/tpho9uqX8pAAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "age_breaks=[17.9,33.1,48.1,61.1,75.1,102]\n",
    "age_labels=['age_18_33','age_33_48','age_48_61','age_61_75','age_75+']\n",
    "master_df['age_bin'] = pd.cut(master_df['age'] , bins=age_breaks, labels=age_labels, include_lowest=True)\n",
    "master_df['age_bin'].hist(figsize=(6,4))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 357,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 357,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['income'].hist(figsize=(6,4))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 358,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 358,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "income_breaks=[0,50000.1,80000.1,120000.1]\n",
    "income_labels=['below_average','above_average','rich']\n",
    "master_df['income_bin'] = pd.cut(master_df['income'] , bins=income_breaks, labels=income_labels, include_lowest=True)\n",
    "master_df['income_bin'].hist(figsize=(6,4))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 359,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 359,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['years_member'].hist(figsize=(6,4))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 360,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 360,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "years_member_breaks=[0,5.1,9.1]\n",
    "years_member_labels=['below five','above five']\n",
    "master_df['years_member_bin'] = pd.cut(master_df['years_member'] , bins=years_member_breaks, labels=years_member_labels, include_lowest=True)\n",
    "master_df['years_member_bin'].hist(figsize=(6,4))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 361,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 361,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['reward'].hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 362,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 362,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "reward_breaks=[0.0,1.9,4.1,6.1,10.1]\n",
    "reward_labels=['very low','low','high','very high']\n",
    "master_df['reward_bin'] = pd.cut(master_df['reward'] , bins=reward_breaks, labels=reward_labels, include_lowest=True)\n",
    "master_df['reward_bin'].hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 363,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 363,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['difficulty'].hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 364,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 364,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYQAAAD4CAYAAADsKpHdAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAATsElEQVR4nO3df5Bd5X3f8ffHEsEyBmwQbCmiFjNWMgaUkmGr4PG03ZiOrYQkkERO5BADNbUyBDd2R9NUZJLYacIUZorJwBRq+UcEDgErdmKREMcwwmtPHX5Y2NhCYGrVyFhGA6UmBNFCWfztH+fZ5rKstLt3f9wVer9m7txzn3Oec557nj3nc8+PezdVhSRJrxl0AyRJi4OBIEkCDARJUmMgSJIAA0GS1CwddAP6tXz58lq5cmVfdZ977jmOOuqouW2QZs1+WXzsk8VpNv1y//33P1VVJ0w27pANhJUrV7Jjx46+6o6OjjIyMjK3DdKs2S+Lj32yOM2mX5J890DjPGUkSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCTAQJEmNgSBJAg7hbyrPxs7vP8PFm24fyLL3XHnuQJYrSVPxCEGSBBgIkqTGQJAkAQaCJKkxECRJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJEmAgSBJagwESRIwjUBIckqSLyZ5OMmuJB9o5ccluTPJt9vzG3vqXJ5kd5JHkryzp/ysJDvbuGuTpJUfmeTTrfzeJCvn4b1Kkg5iOkcIY8DGqnoLcDZwWZLTgE3A9qpaBWxvr2nj1gOnA2uB65MsafO6AdgArGqPta38EuDpqnozcA1w1Ry8N0nSDEwZCFW1r6q+1oafBR4GTgbOA25sk90InN+GzwNuraoXqupRYDewJslJwDFVdXdVFXDThDrj8/oMcM740YMkaWHM6F9otlM5PwHcCwxV1T7oQiPJiW2yk4F7eqrtbWUvtuGJ5eN1vtfmNZbkGeB44KkJy99Ad4TB0NAQo6OjM2n+/ze0DDauHuur7mz12+bDwf79+10/i4x9sjjNV79MOxCSvB74LPDBqvr7g3yAn2xEHaT8YHVeXlC1GdgMMDw8XCMjI1O0enLX3byNq3cO5t9J77lgZCDLPRSMjo7Sb59qftgni9N89cu07jJKcgRdGNxcVX/eip9op4Foz0+28r3AKT3VVwCPt/IVk5S/rE6SpcCxwA9m+mYkSf2bzl1GAT4BPFxVH+kZdRtwURu+CNjWU76+3Tl0Kt3F4/va6aVnk5zd5nnhhDrj81oH3NWuM0iSFsh0zpu8DXgPsDPJA63st4Erga1JLgEeA94FUFW7kmwFHqK7Q+myqnqp1bsU2AIsAz7fHtAFzqeS7KY7Mlg/u7clSZqpKQOhqv4bk5/jBzjnAHWuAK6YpHwHcMYk5c/TAkWSNBh+U1mSBBgIkqTGQJAkAQaCJKkxECRJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJEmAgSBJagwESRJgIEiSGgNBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBgIkqTGQJAkAbB00A2QNHdWbrp9Tue3cfUYF09jnnuuPHdOl6vB8AhBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBgIkqRmykBI8skkTyZ5sKfsw0m+n+SB9viZnnGXJ9md5JEk7+wpPyvJzjbu2iRp5Ucm+XQrvzfJyjl+j5KkaZjOEcIWYO0k5ddU1Znt8dcASU4D1gOntzrXJ1nSpr8B2ACsao/xeV4CPF1VbwauAa7q871IkmZhykCoqi8DP5jm/M4Dbq2qF6rqUWA3sCbJScAxVXV3VRVwE3B+T50b2/BngHPGjx4kSQtnNr92+v4kFwI7gI1V9TRwMnBPzzR7W9mLbXhiOe35ewBVNZbkGeB44KmJC0yyge4og6GhIUZHR/tq+NCy7lccB6HfNh8O9u/f7/qZpbn+u57utmK/Laz52lb6DYQbgD8Aqj1fDbwXmOyTfR2knCnGvbywajOwGWB4eLhGRkZm1Ohx1928jat3DuaXv/dcMDKQ5R4KRkdH6bdP1ZnOT1XPxMbVY9PaVvy7Xljzta30dZdRVT1RVS9V1Q+BjwFr2qi9wCk9k64AHm/lKyYpf1mdJEuBY5n+KSpJ0hzpKxDaNYFxvwCM34F0G7C+3Tl0Kt3F4/uqah/wbJKz2/WBC4FtPXUuasPrgLvadQZJ0gKa8lgwyS3ACLA8yV7gQ8BIkjPpTu3sAX4doKp2JdkKPASMAZdV1UttVpfS3bG0DPh8ewB8AvhUkt10Rwbr5+B9SZJmaMpAqKp3T1L8iYNMfwVwxSTlO4AzJil/HnjXVO2QJM0vv6ksSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCTAQJEmNgSBJAgwESVJjIEiSAANBktQYCJIkwECQJDUGgiQJMBAkSY2BIEkCDARJUmMgSJIAA0GS1BgIkiTAQJAkNQaCJAkwECRJjYEgSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCYClg26AXv1Wbrp9WtNtXD3GxdOcdjr2XHnunM1LOhx4hCBJAgwESVJjIEiSAANBktQYCJIkwECQJDVTBkKSTyZ5MsmDPWXHJbkzybfb8xt7xl2eZHeSR5K8s6f8rCQ727hrk6SVH5nk06383iQr5/g9SpKmYTpHCFuAtRPKNgHbq2oVsL29JslpwHrg9Fbn+iRLWp0bgA3AqvYYn+clwNNV9WbgGuCqft+MJKl/UwZCVX0Z+MGE4vOAG9vwjcD5PeW3VtULVfUosBtYk+Qk4JiquruqCrhpQp3xeX0GOGf86EGStHD6/abyUFXtA6iqfUlObOUnA/f0TLe3lb3YhieWj9f5XpvXWJJngOOBpyYuNMkGuqMMhoaGGB0d7a/xy7pvxQ5Cv20+lE13Xc91v7iuZ2+6fXI4rutB2r9//7ys87n+6YrJPtnXQcoPVueVhVWbgc0Aw8PDNTIy0kcT4bqbt3H1zsH8aseeC0YGstxBmu7PUWxcPTan/eK6nr3p9snhuK4HaXR0lH73fwfT711GT7TTQLTnJ1v5XuCUnulWAI+38hWTlL+sTpKlwLG88hSVJGme9RsItwEXteGLgG095evbnUOn0l08vq+dXno2ydnt+sCFE+qMz2sdcFe7ziBJWkBTHgsmuQUYAZYn2Qt8CLgS2JrkEuAx4F0AVbUryVbgIWAMuKyqXmqzupTujqVlwOfbA+ATwKeS7KY7Mlg/J+9MkjQjUwZCVb37AKPOOcD0VwBXTFK+AzhjkvLnaYEiSRocv6ksSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCTAQJEmNgSBJAgwESVJjIEiSAANBktQYCJIkwECQJDUGgiQJMBAkSY2BIEkCDARJUmMgSJIAA0GS1BgIkiTAQJAkNQaCJAkwECRJjYEgSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCTAQJEmNgSBJAgwESVJjIEiSAFg66AZI0qFo5abbB7bsLWuPmpf5eoQgSQIMBElSM6tASLInyc4kDyTZ0cqOS3Jnkm+35zf2TH95kt1JHknyzp7ys9p8die5Nklm0y5J0szNxRHCT1XVmVU13F5vArZX1Spge3tNktOA9cDpwFrg+iRLWp0bgA3AqvZYOwftkiTNwHycMjoPuLEN3wic31N+a1W9UFWPAruBNUlOAo6pqrurqoCbeupIkhbIbO8yKuCOJAV8tKo2A0NVtQ+gqvYlObFNezJwT0/dva3sxTY8sfwVkmygO5JgaGiI0dHRvho9tAw2rh7rq+5s9dvmQ9l01/Vc94vrevam2yeu64W1f//+eVnnsw2Et1XV422nf2eSbx1k2smuC9RByl9Z2AXOZoDh4eEaGRmZYXM71928jat3DuaO2z0XjAxkuYN08TRvz9u4emxO+8V1PXvT7RPX9cLasvYo+t3/HcysThlV1ePt+UngL4A1wBPtNBDt+ck2+V7glJ7qK4DHW/mKScolSQuo70BIclSSo8eHgXcADwK3ARe1yS4CtrXh24D1SY5McirdxeP72umlZ5Oc3e4uurCnjiRpgczm+HwI+It2h+hS4E+r6m+SfBXYmuQS4DHgXQBVtSvJVuAhYAy4rKpeavO6FNgCLAM+3x6SpAXUdyBU1XeAfzpJ+f8CzjlAnSuAKyYp3wGc0W9bJEmz5zeVJUmAgSBJagwESRJgIEiSGgNBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBgIkqTGQJAkAQaCJKkxECRJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJEmAgSBJagwESRJgIEiSGgNBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBgIkqRm0QRCkrVJHkmyO8mmQbdHkg43iyIQkiwB/gvw08BpwLuTnDbYVknS4WVRBAKwBthdVd+pqv8L3AqcN+A2SdJhJVU16DaQZB2wtqr+TXv9HuAnq+r9E6bbAGxoL38MeKTPRS4HnuqzruaP/bL42CeL02z65U1VdcJkI5b23545lUnKXpFUVbUZ2DzrhSU7qmp4tvPR3LJfFh/7ZHGar35ZLKeM9gKn9LxeATw+oLZI0mFpsQTCV4FVSU5N8iPAeuC2AbdJkg4ri+KUUVWNJXk/8AVgCfDJqto1j4uc9WknzQv7ZfGxTxaneemXRXFRWZI0eIvllJEkacAMBEkScJgEQpI9SZbP0bwuTvKP52JekjQuycokD87h/PbPtM5hEQgz1X5K40AuBgyEGUjHvzVpniSZkxuEFu1G2tLyW0k+nuTBJDcn+VdJvpLk20nWJDkuyeeSfDPJPUl+vNU9PskdSb6e5KP0fPEtya8luS/JA0k+Or7zT7I/yX9Mci/w1iS/l+Srbdmb205tHTAM3NzqL0tyVpIvJbk/yReSnDSI9TXfklyV5Dd6Xn84ycY2/O/buvpmkt9vZSuTPJzkeuBrwO8muaan/vuSfGSS5bwjyd1Jvpbkz5K8vpW/oj9a+W8meagt+9Ykr2l/Hye08a9pP5g4J0eIrxaTbQdJbkiyI8mu8X5s017Zs47/c5Kjkzya5Ig2/ph2FH7E4N7Rq8aSJB9rfXBH28e8r/3tfyPJZ5O8DiDJliQfSfJF4Kp22/7dbdo/6GvpVbUoH8BKYAxYTRdc9wOfpNu5nwd8DrgO+FCb/u3AA234WuD32vC5dN96Xg68BfhL4Ig27nrgwjZcwC/3LP+4nuFPAT/XhkeB4TZ8BPC3wAnt9a/Q3TI78PU3D/3xE8CXel4/BPwT4B10t8Cl9dNfAf+i9d8PgbPb9EcB/6Nn3f8tsHrCMpYDXwaOaq//Q08/Hqg/HgeObMNvaM8fAj7Yht8BfHbQ628xPQ60HYyvY7pbv0eBHweOo/uJmPE7EsfX8R8D57fhDcDVg35fh/qjZ593Znu9Ffg14Pieaf4Q+LdteEvb3pa017f17M8uA/bPtA2L4nsIB/FoVe0ESLIL2F5VlWQn3cp7E/BLAFV1VzsyOJZuh/SLrfz2JE+3+Z0DnAV8tX3AXAY82ca9BHy2Z9k/leS3gNfRbRS76DaiXj8GnAHc2ea3BNg3N299camqryc5Md31kxOAp6vqsSS/SbfT/Xqb9PXAKuAx4LtVdU+r/1ySu4CfTfIw3c5o54TFnE33a7dfaevzR4C727gD9cc36Y7YPkf3IQG6Dw7bgD8C3ku389I/ONB28Mvpfi9sKXASXV88BDwPfDzJ7XQ7IICPA79Ft87/NfC+BWz/q9mjVfVAG76fbj93RpI/BN5At319oWf6P6uql9rw22j7Q7oPTVfNdOGLPRBe6Bn+Yc/rH9K1fWySOjXhuVeAG6vq8knGPT++YpO8lu5T03BVfS/Jh4HXHmB+u6rqrVO9kVeJzwDrgH9E94u00K2D/1RVH+2dMMlK4LkJ9T8O/DbwLSbfSQe4s6rePWFeB+uPc+k+APw83Wmp09s0TyR5O/CTwAV9vNdXs1dsB0lOBe4E/llVPZ1kC/Da6r40uoYuRNYD7wfeXlVfaacF/yXdJ9Q5uxh6mOvd571EF9Zb6I7GvpHkYmCkZ5qJ29isvli2aK8hTNOXaRt7khHgqar6+wnlPw28sU2/HViX5MQ27rgkb5pkvuM7m6faOex1PeOeBY5uw48AJyR5a5vfEUlOn5u3tijdSrdTWEcXDtB9Wnlvz7n+k8fX70RVdS/db1b9KnDLJJPcA7wtyZvbvF6X5Ec5QH+ku1B9SlV9ke7T6hvoPkFBFz5/Amzt+QSlziu2A7rTf88BzyQZovvfJLT1fWxV/TXwQeDMnvncRNePHoHNr6OBfe0azcE+3HyFbvtkiukOaLEfIUzlw8AfJ/km8L+Bi1r57wO3JPka8CW60xdU1UNJfge4o+1MXqQ71/bd3plW1d8l+RiwE9hD91tL47YA/zXJ/wHeSrdzuradqlpKd5piPn92Y2CqaleSo4HvV9W+VnZHkrcAd7fTD/vpznseaCe8le4c6dMTR1TV/2yfgG5JcmQr/p2q+u8H6I8lwJ+0dR/gmqr6uzbuNrodlTurCQ6yHXyd7m/3O3Q7F+h2RtvaUVqAf9czq5vpzmlPFu6aO78L3Eu3n9rJP3wgnegDwJ8m+QAvP/09bf50hRZUkr+i23Fvn+flDLfl/PP5XM7hLN1dd+dV1XsG3RbNjUP9CEGHiCRvAO4DvrEAYbAJuBSvHcybJNfRnVb6mUG3RXPHIwRJEnDoX1SWJM0RA0GSBBgIkqTGQJAkAQaCJKn5fz8lst1FdcnrAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "difficulty_breaks=[0.0,4.9,7.1,10.1,20.1]\n",
    "difficulty_labels=['very easy','easy','moderate','hard']\n",
    "master_df['difficulty_bin'] = pd.cut(master_df['difficulty'] , bins=difficulty_breaks, labels=difficulty_labels, include_lowest=True)\n",
    "master_df['difficulty_bin'].hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 365,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 365,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['duration'].hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 366,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 366,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "duration_breaks=[70,121,169,241]\n",
    "duration_labels=['less time','moderate time','abundant time']\n",
    "master_df['duration_bin'] = pd.cut(master_df['duration'] , bins=duration_breaks, labels=duration_labels, include_lowest=True)\n",
    "master_df['duration_bin'].hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 367,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 367,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['email'].hist()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Each and every offer is sent via email."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 368,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 368,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYQAAAD4CAYAAADsKpHdAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAASdElEQVR4nO3df6zd9V3H8edr7YbIBuPHuGlatCj1BzA3xxUbp+bOGunQWEwgqT9GtzRpRDQzIdHiHxpjmsA/YojCbMbSgjpocJMqopLicRr5saJsXWHIdShcaWgYyLgYcBff/nE+dzm93Paent57bm/v85GcnO95n+/n+/280+a8zvf7PefcVBWSJL1jsScgSTo5GAiSJMBAkCQ1BoIkCTAQJEnNysWewKDOO++8Wrt27UBjX3/9dc4444z5ndBJzp6XB3teHk6k58cff/ylqnrfbM8t2UBYu3Yt+/fvH2hsp9NhbGxsfid0krPn5cGel4cT6TnJfx7tOU8ZSZIAA0GS1BgIkiTAQJAkNX0FQpL/SHIgyRNJ9rfaOUkeTPJMuz+7Z/0bk4wneTrJFT31y9p2xpPcmiStflqSe1r90SRr57lPSdIcjucI4SNV9cGqGm2PtwP7qmodsK89JsnFwGbgEmAjcFuSFW3M7cA2YF27bWz1rcArVXURcAtw8+AtSZIGcSKnjDYBu9vybuCqnvrdVfVmVT0LjAOXJ1kFnFlVD1f3J1bvnDFmelv3Ahumjx4kScPR7/cQCvi7JAX8cVXtBEaq6hBAVR1Kcn5bdzXwSM/YiVb7ZlueWZ8e83zb1lSSV4FzgZd6J5FkG90jDEZGRuh0On1O/0iTk5MDj12q7Hl5sOflYaF67jcQPlxVL7QX/QeTfPUY6872zr6OUT/WmCML3SDaCTA6OlqDfjHDL7IsD/a8PNjz/OkrEKrqhXZ/OMnngcuBF5OsakcHq4DDbfUJ4IKe4WuAF1p9zSz13jETSVYCZwEvD9aSJC28tdvvX7R979q4MD/VMec1hCRnJHnP9DLwU8BXgL3AlrbaFuC+trwX2Nw+OXQh3YvHj7XTS68lWd+uD1w7Y8z0tq4GHir/lJskDVU/RwgjwOfbNd6VwJ9V1d8k+SKwJ8lW4DngGoCqOphkD/AkMAVcX1VvtW1dB+wCTgceaDeAO4C7kozTPTLYPA+9SZKOw5yBUFVfAz4wS/3rwIajjNkB7Jilvh+4dJb6G7RAkSQtDr+pLEkCDARJUmMgSJIAA0GS1BgIkiTAQJAkNQaCJAkwECRJjYEgSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCTAQJEmNgSBJAgwESVJjIEiSAANBktQYCJIkwECQJDUGgiQJMBAkSY2BIEkCDARJUmMgSJIAA0GS1BgIkiTAQJAkNQaCJAkwECRJjYEgSQKOIxCSrEjyr0n+qj0+J8mDSZ5p92f3rHtjkvEkTye5oqd+WZID7blbk6TVT0tyT6s/mmTtPPYoSerD8RwhfBJ4qufxdmBfVa0D9rXHJLkY2AxcAmwEbkuyoo25HdgGrGu3ja2+FXilqi4CbgFuHqgbSdLA+gqEJGuAnwY+3VPeBOxuy7uBq3rqd1fVm1X1LDAOXJ5kFXBmVT1cVQXcOWPM9LbuBTZMHz1IkoZjZZ/r/QHwG8B7emojVXUIoKoOJTm/1VcDj/SsN9Fq32zLM+vTY55v25pK8ipwLvBS7ySSbKN7hMHIyAidTqfP6R9pcnJy4LFLlT0vD/Y8PDe8f2ro+5y2UD3PGQhJfgY4XFWPJxnrY5uzvbOvY9SPNebIQtVOYCfA6OhojY31M52363Q6DDp2qbLn5cGeh+fj2+8f+j6n7dp4xoL03M8RwoeBn01yJfBtwJlJ/gR4McmqdnSwCjjc1p8ALugZvwZ4odXXzFLvHTORZCVwFvDygD1JkgYw5zWEqrqxqtZU1Vq6F4sfqqpfAvYCW9pqW4D72vJeYHP75NCFdC8eP9ZOL72WZH27PnDtjDHT27q67eNtRwiSpIXT7zWE2dwE7EmyFXgOuAagqg4m2QM8CUwB11fVW23MdcAu4HTggXYDuAO4K8k43SODzScwL0nSAI4rEKqqA3Ta8teBDUdZbwewY5b6fuDSWepv0AJFkrQ4/KayJAkwECRJjYEgSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCTAQJEmNgSBJAgwESVJjIEiSAANBktQYCJIkwECQJDUGgiQJMBAkSY2BIEkCDARJUmMgSJIAA0GS1BgIkiTAQJAkNQaCJAkwECRJjYEgSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1cwZCkm9L8liSLyU5mOR3W/2cJA8meabdn90z5sYk40meTnJFT/2yJAfac7cmSaufluSeVn80ydoF6FWSdAz9HCG8CfxEVX0A+CCwMcl6YDuwr6rWAfvaY5JcDGwGLgE2ArclWdG2dTuwDVjXbhtbfSvwSlVdBNwC3HzirUmSjsecgVBdk+3hO9utgE3A7lbfDVzVljcBd1fVm1X1LDAOXJ5kFXBmVT1cVQXcOWPM9LbuBTZMHz1Ikoajr2sISVYkeQI4DDxYVY8CI1V1CKDdn99WXw083zN8otVWt+WZ9SPGVNUU8Cpw7gD9SJIGtLKflarqLeCDSd4LfD7JpcdYfbZ39nWM+rHGHLnhZBvdU06MjIzQ6XSOMY2jm5ycHHjsUmXPy4M9D88N758a+j6nLVTPfQXCtKr67yQduuf+X0yyqqoOtdNBh9tqE8AFPcPWAC+0+ppZ6r1jJpKsBM4CXp5l/zuBnQCjo6M1NjZ2PNP/lk6nw6Bjlyp7Xh7seXg+vv3+oe9z2q6NZyxIz/18yuh97ciAJKcDPwl8FdgLbGmrbQHua8t7gc3tk0MX0r14/Fg7rfRakvXt+sC1M8ZMb+tq4KF2nUGSNCT9HCGsAna3Twq9A9hTVX+V5GFgT5KtwHPANQBVdTDJHuBJYAq4vp1yArgO2AWcDjzQbgB3AHclGad7ZLB5PpqTJPVvzkCoqi8DPzhL/evAhqOM2QHsmKW+H3jb9YeqeoMWKJKkxeE3lSVJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJEmAgSBJagwESRJgIEiSGgNBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBgIkqTGQJAkAQaCJKkxECRJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJElAH4GQ5IIkf5/kqSQHk3yy1c9J8mCSZ9r92T1jbkwynuTpJFf01C9LcqA9d2uStPppSe5p9UeTrF2AXiVJx9DPEcIUcENVfT+wHrg+ycXAdmBfVa0D9rXHtOc2A5cAG4Hbkqxo27od2Aasa7eNrb4VeKWqLgJuAW6eh94kScdhzkCoqkNV9S9t+TXgKWA1sAnY3VbbDVzVljcBd1fVm1X1LDAOXJ5kFXBmVT1cVQXcOWPM9LbuBTZMHz1IkoZj5fGs3E7l/CDwKDBSVYegGxpJzm+rrQYe6Rk20WrfbMsz69Njnm/bmkryKnAu8NKM/W+je4TByMgInU7neKb/LZOTkwOPXarseXmw5+G54f1TQ9/ntIXque9ASPJu4M+BX6+qbxzjDfxsT9Qx6scac2ShaiewE2B0dLTGxsbmmPXsOp0Og45dqux5ebDn4fn49vuHvs9puzaesSA99/UpoyTvpBsGf1pVn2vlF9tpINr94VafAC7oGb4GeKHV18xSP2JMkpXAWcDLx9uMJGlw/XzKKMAdwFNV9fs9T+0FtrTlLcB9PfXN7ZNDF9K9ePxYO730WpL1bZvXzhgzva2rgYfadQZJ0pD0c8row8DHgANJnmi13wJuAvYk2Qo8B1wDUFUHk+wBnqT7CaXrq+qtNu46YBdwOvBAu0E3cO5KMk73yGDzibUlSTpecwZCVf0Ts5/jB9hwlDE7gB2z1PcDl85Sf4MWKJKkxeE3lSVJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJEmAgSBJagwESRJgIEiSGgNBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBgIkqTGQJAkAQaCJKkxECRJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJElAH4GQ5DNJDif5Sk/tnCQPJnmm3Z/d89yNScaTPJ3kip76ZUkOtOduTZJWPy3JPa3+aJK189yjJKkP/Rwh7AI2zqhtB/ZV1TpgX3tMkouBzcAlbcxtSVa0MbcD24B17Ta9za3AK1V1EXALcPOgzUiSBjdnIFTVF4CXZ5Q3Abvb8m7gqp763VX1ZlU9C4wDlydZBZxZVQ9XVQF3zhgzva17gQ3TRw+SpOFZOeC4kao6BFBVh5Kc3+qrgUd61ptotW+25Zn16THPt21NJXkVOBd4aeZOk2yje5TByMgInU5noMlPTk4OPHapsuflwZ6H54b3Tw19n9MWqudBA+FoZntnX8eoH2vM24tVO4GdAKOjozU2NjbAFKHT6TDo2KXKnpcHex6ej2+/f+j7nLZr4xkL0vOgnzJ6sZ0Got0fbvUJ4IKe9dYAL7T6mlnqR4xJshI4i7efopIkLbBBA2EvsKUtbwHu66lvbp8cupDuxePH2uml15Ksb9cHrp0xZnpbVwMPtesMkqQhmvOUUZLPAmPAeUkmgN8BbgL2JNkKPAdcA1BVB5PsAZ4EpoDrq+qttqnr6H5i6XTggXYDuAO4K8k43SODzfPSmSTpuMwZCFX180d5asNR1t8B7Jilvh+4dJb6G7RAkSQtHr+pLEkCDARJUmMgSJIAA0GS1BgIkiTAQJAkNQaCJAkwECRJjYEgSQIMBElSYyBIkgADQZLUzPcfyFkSDvzXq4v2xy3+46afXpT9StJcPEKQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBgIkqTGQJAkAQaCJKkxECRJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJEmAgSBJak6aQEiyMcnTScaTbF/s+UjScnNSBEKSFcAfAR8FLgZ+PsnFizsrSVpeTopAAC4Hxqvqa1X1v8DdwKZFnpMkLSsrF3sCzWrg+Z7HE8APz1wpyTZgW3s4meTpAfd3HvDSgGNPSG5ejL0Ci9jzIrLn5WHZ9fyRm0+o5+882hMnSyBkllq9rVC1E9h5wjtL9lfV6IluZymx5+XBnpeHher5ZDllNAFc0PN4DfDCIs1FkpalkyUQvgisS3JhkncBm4G9izwnSVpWTopTRlU1leRXgb8FVgCfqaqDC7jLEz7ttATZ8/Jgz8vDgvScqredqpckLUMnyykjSdIiMxAkScApHghz/RxGum5tz385yYcWY57zqY+ef7H1+uUk/5zkA4sxz/nU78+eJPmhJG8luXqY81sI/fScZCzJE0kOJvmHYc9xPvXx//qsJH+Z5Eut308sxjznU5LPJDmc5CtHeX7+X7+q6pS80b04/e/AdwHvAr4EXDxjnSuBB+h+D2I98Ohiz3sIPf8IcHZb/uhy6LlnvYeAvwauXux5D+Hf+b3Ak8B3tMfnL/a8F7jf3wJubsvvA14G3rXYcz/Bvn8c+BDwlaM8P++vX6fyEUI/P4exCbizuh4B3ptk1bAnOo/m7Lmq/rmqXmkPH6H7nY+lrN+fPfk14M+Bw8Oc3ALpp+dfAD5XVc8BVNVS7ruffgt4T5IA76YbCFPDneb8qqov0O3jaOb99etUDoTZfg5j9QDrLCXH289Wuu8wlrI5e06yGvg54FNDnNdC6uff+XuAs5N0kjye5NqhzW7+9dPvHwLfT/cLrQeAT1bV/w1neotm3l+/TorvISyQfn4Oo6+fzFhC+u4nyUfoBsKPLuiMFl4/Pf8B8JtV9Vb3DeSS10/PK4HLgA3A6cDDSR6pqn9b6MktgH76vQJ4AvgJ4LuBB5P8Y1V9Y4Hntpjm/fXrVA6Efn4O41T7yYy++knyA8CngY9W1deHNLeF0k/Po8DdLQzOA65MMlVVfzGUGc6/fv9vv1RVrwOvJ/kC8AFgKQZCP/1+AripuifXx5M8C3wf8Nhwprgo5v3161Q+ZdTPz2HsBa5tV+vXA69W1aFhT3Qezdlzku8APgd8bIm+W5xpzp6r6sKqWltVa4F7gV9ZwmEA/f3fvg/4sSQrk3w73V8PfmrI85wv/fT7HN2jIZKMAN8LfG2osxy+eX/9OmWPEOooP4eR5Jfb85+i+4mTK4Fx4H/ovstYsvrs+beBc4Hb2jvmqVrCvxTZZ8+nlH56rqqnkvwN8GXg/4BPV9WsH1882fX5b/x7wK4kB+ieSvnNqlrSP4md5LPAGHBekgngd4B3wsK9fvnTFZIk4NQ+ZSRJOg4GgiQJMBAkSY2BIEkCDARJUmMgSJIAA0GS1Pw/R5FLq6AF+KQAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['mobile'].hist()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "There are only two possible values so no need of binning."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 369,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 369,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['social'].hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 370,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 370,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYQAAAD4CAYAAADsKpHdAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAAQrElEQVR4nO3df6zd9V3H8edrdGOVDcaPcdO0zKJUXQH3g4qNU3O3mtAxYzGBpHOOsjRpRDQzIXFlf7gY0wT+UBZ0sDRjaWHLoGFT6hANKR6nGT8sutEVRK5jQqWhYSCjGJDL3v5xPtccbm97T2/vPae39/lITs73vM/38/1+3m1zXuf7/Z5zmqpCkqS3DHsCkqTjg4EgSQIMBElSYyBIkgADQZLULBr2BGbqrLPOquXLl89o7CuvvMIpp5wyuxM6ztnzwmDPC8Ox9PzII488X1Xvnuq5eRsIy5cvZ/fu3TMa2+l0GB0dnd0JHefseWGw54XhWHpO8p+He85TRpIkwECQJDUGgiQJMBAkSY2BIEkCDARJUmMgSJIAA0GS1BgIkiRgHn9TWZKGafnme4a2721r5+anOjxCkCQBBoIkqTEQJEmAgSBJagwESRJgIEiSGgNBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBxFICQ5Kcm/Jvlme3xGkvuSPNnuT+9Z97okY0meSHJJT/2iJHvaczclSaufnOTOVn8oyfJZ7FGS1IejOUL4NPB4z+PNwK6qWgHsao9JshJYD5wPrAVuTnJSG3MLsAlY0W5rW30j8GJVnQfcCNwwo24kSTPWVyAkWQZ8DPhST3kdsL0tbwcu66nfUVWvVdVTwBhwcZIlwKlV9UBVFXDbpDET27oLWDNx9CBJGox+/wvNzwN/CLyzpzZSVfsBqmp/krNbfSnwYM96+1rt9bY8uT4x5pm2rfEkLwFnAs/3TiLJJrpHGIyMjNDpdPqc/psdPHhwxmPnK3teGOx5cK69cHzg+5wwVz1PGwhJfh04UFWPJBntY5tTvbOvI9SPNObNhaqtwFaAVatW1ehoP9M5VKfTYaZj5yt7XhjseXCuGvL/qTwXPfdzhPAh4DeSXAq8HTg1yVeA55IsaUcHS4ADbf19wDk945cBz7b6sinqvWP2JVkEnAa8MMOeJEkzMO01hKq6rqqWVdVyuheL76+q3wZ2AhvaahuAu9vyTmB9++TQuXQvHj/cTi+9nGR1uz5w5aQxE9u6vO3jkCMESdLc6fcawlSuB3Yk2Qg8DVwBUFV7k+wAHgPGgWuq6o025mpgG7AYuLfdAG4Fbk8yRvfIYP0xzEuSNANHFQhV1QE6bfmHwJrDrLcF2DJFfTdwwRT1V2mBIkkaDr+pLEkCDARJUmMgSJIAA0GS1BgIkiTAQJAkNQaCJAkwECRJjYEgSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCTAQJEmNgSBJAgwESVJjIEiSAANBktQYCJIkwECQJDUGgiQJMBAkSY2BIEkCDARJUmMgSJIAA0GS1BgIkiTAQJAkNQaCJAkwECRJjYEgSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ10wZCkrcneTjJd5PsTfLHrX5GkvuSPNnuT+8Zc12SsSRPJLmkp35Rkj3tuZuSpNVPTnJnqz+UZPkc9CpJOoJ+jhBeAz5SVe8D3g+sTbIa2AzsqqoVwK72mCQrgfXA+cBa4OYkJ7Vt3QJsAla029pW3wi8WFXnATcCNxx7a5KkozFtIFTXwfbwre1WwDpge6tvBy5ry+uAO6rqtap6ChgDLk6yBDi1qh6oqgJumzRmYlt3AWsmjh4kSYOxqJ+V2jv8R4DzgC9U1UNJRqpqP0BV7U9ydlt9KfBgz/B9rfZ6W55cnxjzTNvWeJKXgDOB5yfNYxPdIwxGRkbodDp9tvlmBw8enPHY+cqeFwZ7HpxrLxwf+D4nzFXPfQVCVb0BvD/Ju4C/THLBEVaf6p19HaF+pDGT57EV2AqwatWqGh0dPcI0Dq/T6TDTsfOVPS8M9jw4V22+Z+D7nLBt7Slz0vNRfcqoqv4b6NA99/9cOw1Euz/QVtsHnNMzbBnwbKsvm6L+pjFJFgGnAS8czdwkScemn08ZvbsdGZBkMfBrwL8BO4ENbbUNwN1teSewvn1y6Fy6F48fbqeXXk6yul0fuHLSmIltXQ7c364zSJIGpJ9TRkuA7e06wluAHVX1zSQPADuSbASeBq4AqKq9SXYAjwHjwDXtlBPA1cA2YDFwb7sB3ArcnmSM7pHB+tloTpLUv2kDoaoeBT4wRf2HwJrDjNkCbJmivhs45PpDVb1KCxRJ0nD4TWVJEmAgSJIaA0GSBBgIkqTGQJAkAQaCJKkxECRJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJEmAgSBJagwESRJgIEiSGgNBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBgIkqTGQJAkAQaCJKkxECRJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqZk2EJKck+TvkzyeZG+ST7f6GUnuS/Jkuz+9Z8x1ScaSPJHkkp76RUn2tOduSpJWPznJna3+UJLlc9CrJOkI+jlCGAeurar3AquBa5KsBDYDu6pqBbCrPaY9tx44H1gL3JzkpLatW4BNwIp2W9vqG4EXq+o84EbghlnoTZJ0FKYNhKraX1X/0pZfBh4HlgLrgO1tte3AZW15HXBHVb1WVU8BY8DFSZYAp1bVA1VVwG2Txkxs6y5gzcTRgyRpMBYdzcrtVM4HgIeAkaraD93QSHJ2W20p8GDPsH2t9npbnlyfGPNM29Z4kpeAM4HnJ+1/E90jDEZGRuh0Okcz/f938ODBGY+dr+x5YbDnwbn2wvGB73PCXPXcdyAkeQfwdeAPqupHR3gDP9UTdYT6kca8uVC1FdgKsGrVqhodHZ1m1lPrdDrMdOx8Zc8Lgz0PzlWb7xn4PidsW3vKnPTc16eMkryVbhh8taq+0crPtdNAtPsDrb4POKdn+DLg2VZfNkX9TWOSLAJOA1442mYkSTPXz6eMAtwKPF5Vf9bz1E5gQ1veANzdU1/fPjl0Lt2Lxw+300svJ1ndtnnlpDET27ocuL9dZ5AkDUg/p4w+BHwS2JPkO632WeB6YEeSjcDTwBUAVbU3yQ7gMbqfULqmqt5o464GtgGLgXvbDbqBc3uSMbpHBuuPrS1J0tGaNhCq6p+Y+hw/wJrDjNkCbJmivhu4YIr6q7RAkSQNh99UliQBBoIkqTEQJEmAgSBJagwESRJgIEiSGgNBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqDARJEmAgSJIaA0GSBBgIkqTGQJAkAQaCJKkxECRJgIEgSWoMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqTEQJEmAgSBJagwESRJgIEiSGgNBkgQYCJKkxkCQJAEGgiSpMRAkSYCBIElqFg17AsOw579e4qrN9wxl3z+4/mND2a8kTccjBEkS0EcgJPlykgNJvtdTOyPJfUmebPen9zx3XZKxJE8kuaSnflGSPe25m5Kk1U9OcmerP5Rk+Sz3KEnqQz9HCNuAtZNqm4FdVbUC2NUek2QlsB44v425OclJbcwtwCZgRbtNbHMj8GJVnQfcCNww02YkSTM3bSBU1beAFyaV1wHb2/J24LKe+h1V9VpVPQWMARcnWQKcWlUPVFUBt00aM7Gtu4A1E0cPkqTBmelF5ZGq2g9QVfuTnN3qS4EHe9bb12qvt+XJ9Ykxz7RtjSd5CTgTeH7yTpNsonuUwcjICJ1OZ2aTXwzXXjg+o7HHaqZzPlYHDx4c2r6HxZ4XhmH1PKzXEJi7nmf7U0ZTvbOvI9SPNObQYtVWYCvAqlWranR0dAZThD//6t386Z7hfMDqB58YHcp+O50OM/3zmq/seWEYVs/D+qQiwLa1p8xJzzP9lNFz7TQQ7f5Aq+8DzulZbxnwbKsvm6L+pjFJFgGncegpKknSHJtpIOwENrTlDcDdPfX17ZND59K9ePxwO730cpLV7frAlZPGTGzrcuD+dp1BkjRA0543SfI1YBQ4K8k+4HPA9cCOJBuBp4ErAKpqb5IdwGPAOHBNVb3RNnU13U8sLQbubTeAW4Hbk4zRPTJYPyudSZKOyrSBUFUfP8xTaw6z/hZgyxT13cAFU9RfpQWKJGl4/KayJAkwECRJjYEgSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCTAQJEmNgSBJAgwESVJjIEiSAANBktQYCJIkwECQJDUGgiQJMBAkSY2BIEkCDARJUmMgSJIAA0GS1BgIkiTAQJAkNQaCJAkwECRJjYEgSQIMBElSYyBIkgADQZLUGAiSJMBAkCQ1BoIkCTAQJEmNgSBJAgwESVJjIEiSAANBktQcN4GQZG2SJ5KMJdk87PlI0kJzXARCkpOALwAfBVYCH0+ycrizkqSF5bgIBOBiYKyqvl9V/wvcAawb8pwkaUFZNOwJNEuBZ3oe7wN+cfJKSTYBm9rDg0memOH+zgKen+HYY5IbhrFXYIg9D5E9LwwLrucP33BMPf/k4Z44XgIhU9TqkELVVmDrMe8s2V1Vq451O/OJPS8M9rwwzFXPx8spo33AOT2PlwHPDmkukrQgHS+B8M/AiiTnJnkbsB7YOeQ5SdKCclycMqqq8SS/B/wdcBLw5araO4e7PObTTvOQPS8M9rwwzEnPqTrkVL0kaQE6Xk4ZSZKGzECQJAEneCBM93MY6bqpPf9okg8OY56zqY+eP9F6fTTJt5O8bxjznE39/uxJkl9I8kaSywc5v7nQT89JRpN8J8neJP8w6DnOpj7+XZ+W5K+TfLf1+6lhzHM2JflykgNJvneY52f/9auqTsgb3YvT/wH8FPA24LvAyknrXArcS/d7EKuBh4Y97wH0/EvA6W35owuh55717gf+Brh82PMewN/zu4DHgPe0x2cPe95z3O9ngRva8ruBF4C3DXvux9j3rwIfBL53mOdn/fXrRD5C6OfnMNYBt1XXg8C7kiwZ9ERn0bQ9V9W3q+rF9vBBut/5mM/6/dmT3we+DhwY5OTmSD89/xbwjap6GqCq5nPf/fRbwDuTBHgH3UAYH+w0Z1dVfYtuH4cz669fJ3IgTPVzGEtnsM58crT9bKT7DmM+m7bnJEuB3wS+OMB5zaV+/p5/Bjg9SSfJI0muHNjsZl8//f4F8F66X2jdA3y6qn48mOkNzay/fh0X30OYI/38HEZfP5kxj/TdT5IP0w2EX57TGc29fnr+PPCZqnqj+wZy3uun50XARcAaYDHwQJIHq+rf53pyc6Cffi8BvgN8BPhp4L4k/1hVP5rjuQ3TrL9+nciB0M/PYZxoP5nRVz9Jfh74EvDRqvrhgOY2V/rpeRVwRwuDs4BLk4xX1V8NZIazr99/289X1SvAK0m+BbwPmI+B0E+/nwKur+7J9bEkTwE/Bzw8mCkOxay/fp3Ip4z6+TmMncCV7Wr9auClqto/6InOoml7TvIe4BvAJ+fpu8XJpu25qs6tquVVtRy4C/jdeRwG0N+/7buBX0myKMlP0P314McHPM/Z0k+/T9M9GiLJCPCzwPcHOsvBm/XXrxP2CKEO83MYSX6nPf9Fup84uRQYA/6H7ruMeavPnv8IOBO4ub1jHq95/EuRffZ8Qumn56p6PMnfAo8CPwa+VFVTfnzxeNfn3/GfANuS7KF7KuUzVTWvfxI7ydeAUeCsJPuAzwFvhbl7/fKnKyRJwIl9ykiSdBQMBEkSYCBIkhoDQZIEGAiSpMZAkCQBBoIkqfk/2tRc5j45bq0AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['web'].hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 371,
   "metadata": {},
   "outputs": [],
   "source": [
    "#dropping binned columns\n",
    "master_df.drop({'customer_id','age','income','years_member','offer_id','reward','difficulty','duration'},axis=1,inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 372,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age_bin</th>\n",
       "      <th>income_bin</th>\n",
       "      <th>years_member_bin</th>\n",
       "      <th>reward_bin</th>\n",
       "      <th>difficulty_bin</th>\n",
       "      <th>duration_bin</th>\n",
       "      <th>offer_complete_status</th>\n",
       "      <th>mobile</th>\n",
       "      <th>social</th>\n",
       "      <th>web</th>\n",
       "      <th>bogo</th>\n",
       "      <th>informational</th>\n",
       "      <th>discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>F</td>\n",
       "      <td>age_61_75</td>\n",
       "      <td>rich</td>\n",
       "      <td>below five</td>\n",
       "      <td>very high</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>F</td>\n",
       "      <td>age_48_61</td>\n",
       "      <td>above_average</td>\n",
       "      <td>below five</td>\n",
       "      <td>very high</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>M</td>\n",
       "      <td>age_18_33</td>\n",
       "      <td>below_average</td>\n",
       "      <td>above five</td>\n",
       "      <td>very high</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>M</td>\n",
       "      <td>age_48_61</td>\n",
       "      <td>above_average</td>\n",
       "      <td>above five</td>\n",
       "      <td>very high</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>F</td>\n",
       "      <td>age_48_61</td>\n",
       "      <td>below_average</td>\n",
       "      <td>below five</td>\n",
       "      <td>very high</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55217</th>\n",
       "      <td>M</td>\n",
       "      <td>age_75+</td>\n",
       "      <td>rich</td>\n",
       "      <td>above five</td>\n",
       "      <td>low</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55218</th>\n",
       "      <td>F</td>\n",
       "      <td>age_61_75</td>\n",
       "      <td>above_average</td>\n",
       "      <td>above five</td>\n",
       "      <td>low</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55219</th>\n",
       "      <td>M</td>\n",
       "      <td>age_61_75</td>\n",
       "      <td>above_average</td>\n",
       "      <td>below five</td>\n",
       "      <td>low</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55220</th>\n",
       "      <td>F</td>\n",
       "      <td>age_18_33</td>\n",
       "      <td>above_average</td>\n",
       "      <td>below five</td>\n",
       "      <td>low</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55221</th>\n",
       "      <td>M</td>\n",
       "      <td>age_48_61</td>\n",
       "      <td>rich</td>\n",
       "      <td>below five</td>\n",
       "      <td>low</td>\n",
       "      <td>moderate</td>\n",
       "      <td>moderate time</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>55222 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      gender    age_bin     income_bin years_member_bin reward_bin  \\\n",
       "0          F  age_61_75           rich       below five  very high   \n",
       "1          F  age_48_61  above_average       below five  very high   \n",
       "2          M  age_18_33  below_average       above five  very high   \n",
       "3          M  age_48_61  above_average       above five  very high   \n",
       "4          F  age_48_61  below_average       below five  very high   \n",
       "...      ...        ...            ...              ...        ...   \n",
       "55217      M    age_75+           rich       above five        low   \n",
       "55218      F  age_61_75  above_average       above five        low   \n",
       "55219      M  age_61_75  above_average       below five        low   \n",
       "55220      F  age_18_33  above_average       below five        low   \n",
       "55221      M  age_48_61           rich       below five        low   \n",
       "\n",
       "      difficulty_bin   duration_bin  offer_complete_status  mobile  social  \\\n",
       "0           moderate  moderate time                      1       1       1   \n",
       "1           moderate  moderate time                      1       1       1   \n",
       "2           moderate  moderate time                      1       1       1   \n",
       "3           moderate  moderate time                      1       1       1   \n",
       "4           moderate  moderate time                      0       1       1   \n",
       "...              ...            ...                    ...     ...     ...   \n",
       "55217       moderate  moderate time                      0       1       0   \n",
       "55218       moderate  moderate time                      0       1       0   \n",
       "55219       moderate  moderate time                      0       1       0   \n",
       "55220       moderate  moderate time                      0       1       0   \n",
       "55221       moderate  moderate time                      0       1       0   \n",
       "\n",
       "       web  bogo  informational  discount  \n",
       "0        0     1              0         0  \n",
       "1        0     1              0         0  \n",
       "2        0     1              0         0  \n",
       "3        0     1              0         0  \n",
       "4        0     1              0         0  \n",
       "...    ...   ...            ...       ...  \n",
       "55217    1     0              0         1  \n",
       "55218    1     0              0         1  \n",
       "55219    1     0              0         1  \n",
       "55220    1     0              0         1  \n",
       "55221    1     0              0         1  \n",
       "\n",
       "[55222 rows x 14 columns]"
      ]
     },
     "execution_count": 372,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "master_df[['gender','age_bin','income_bin','years_member_bin','reward_bin','difficulty_bin',\n",
    "           'duration_bin','offer_complete_status','mobile','social','web','bogo','informational','discount']]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Modeling"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 419,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import LabelEncoder\n",
    "from collections import defaultdict\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import classification_report\n",
    "import numpy as np\n",
    "from sklearn.metrics import f1_score,confusion_matrix, classification_report,accuracy_score\n",
    "from sklearn.naive_bayes import GaussianNB \n",
    "from sklearn.svm import SVC\n",
    "from sklearn.neighbors import KNeighborsClassifier\n",
    "from sklearn.tree import DecisionTreeClassifier\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.model_selection import GridSearchCV\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.metrics import accuracy_score\n",
    "from sklearn.model_selection import KFold"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 420,
   "metadata": {},
   "outputs": [],
   "source": [
    "def train_n_results(model,X_train,y_train,X_test):\n",
    "    \"\"\"\n",
    "    Returns the model after fitting on X_train and y_train and the predicted traget values in the form of array \n",
    "    and also prints classification report for train and train.and confustion matrix.\n",
    "    Args:\n",
    "    model:  the instance of the model\n",
    "    X_train: training set with independent variables\n",
    "    y_train: training set with dependent variable\n",
    "    Return: \n",
    "    model: the instance of the model after training\n",
    "    y_pred: ndarray with predicted values\n",
    "    \"\"\"\n",
    "    model.fit(X_train, y_train)\n",
    "    y_train_pred=model.predict(X_train)\n",
    "    labels=np.unique(y_train)\n",
    "    print(\"Accuracy on train\", accuracy_score(y_train, y_train_pred))\n",
    "    print(\"Classification report on train\\n\", classification_report(y_train, y_train_pred, labels = labels))\n",
    "    print(\"=================================================================\")\n",
    "    y_pred=model.predict(X_test)\n",
    "    print(classification_report(y_test, y_pred, labels = labels))\n",
    "    print(\"f1 Score\",f1_score(y_test, y_pred))\n",
    "    print(\"Labels:\", labels)\n",
    "    print(\"Confusion Matrix:\\n\", confusion_matrix(y_test.values, y_pred, labels = labels))\n",
    "    return model,y_pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 421,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 421,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "master_df['offer_complete_status'].hist(figsize=(6,4))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 422,
   "metadata": {},
   "outputs": [],
   "source": [
    "labelencoder = LabelEncoder()\n",
    "d = defaultdict(LabelEncoder)\n",
    "master_df_ml=master_df.apply(lambda x: d[x.name].fit_transform(x))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 423,
   "metadata": {},
   "outputs": [],
   "source": [
    "X=master_df_ml[['gender','age_bin','income_bin','years_member_bin','reward_bin','difficulty_bin','duration_bin',\n",
    "             'mobile','social','web','email','bogo','informational','discount']]\n",
    "y=master_df_ml['offer_complete_status']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 424,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 425,
   "metadata": {},
   "outputs": [],
   "source": [
    "#to display accuracy scores of all models on train and test\n",
    "def train_predict_result(model, X_train, y_train, X_test, y_test):\n",
    "    \"\"\"\n",
    "    Returns the model after fitting on X_train and y_train and the predicted traget values in the form of array \n",
    "    and also prints classification report for train and train.and confustion matrix.\n",
    "    Args:\n",
    "    model:  the instance of the model\n",
    "    X_train: training set with independent variables\n",
    "    y_train: training set with dependent variable\n",
    "    Return: \n",
    "    results : a dict with model names as keys and their accuracy,f1 scores in values\n",
    "    \"\"\"\n",
    "    results = {}\n",
    "    model.fit(X_train, y_train)\n",
    "    y_pred_train = model.predict(X_train)\n",
    "    y_pred_test = model.predict(X_test)\n",
    "    \n",
    "    results['acc_train'] = accuracy_score(y_train, y_pred_train) #Accuracy of training\n",
    "    results['acc_test'] = accuracy_score(y_test, y_pred_test) #Accuracy of testing\n",
    "    \n",
    "    results['f1_train'] = f1_score(y_train, y_pred_train) #f1-score for training\n",
    "    results['f1_test'] = f1_score(y_test, y_pred_test) #f1-score for testing\n",
    "    \n",
    "    print(\"{} trained.\".format(model.__class__.__name__))\n",
    "    return results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 427,
   "metadata": {},
   "outputs": [],
   "source": [
    "gnb = GaussianNB()\n",
    "svm=SVC(kernel=\"linear\",C=0.025,random_state=0)\n",
    "logreg = LogisticRegression(solver='lbfgs', class_weight='balanced', max_iter=600,random_state=0)\n",
    "knn=KNeighborsClassifier()\n",
    "dectree = DecisionTreeClassifier(random_state=0)\n",
    "rfc = RandomForestClassifier(random_state=0)\n",
    "\n",
    "models = [gnb,svm, logreg,knn, dectree, rfc]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 428,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "GaussianNB trained.\n",
      "SVC trained.\n",
      "LogisticRegression trained.\n",
      "KNeighborsClassifier trained.\n",
      "DecisionTreeClassifier trained.\n",
      "RandomForestClassifier trained.\n"
     ]
    }
   ],
   "source": [
    "result_dict = {}\n",
    "for model in models:\n",
    "    model_name = model.__class__.__name__\n",
    "    result_dict[model_name] = train_predict_result(model, X_train, y_train, X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 429,
   "metadata": {},
   "outputs": [],
   "source": [
    "result_dict\n",
    "rs_df=pd.DataFrame.from_dict(result_dict, orient ='index')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 430,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>acc_train</th>\n",
       "      <th>f1_train</th>\n",
       "      <th>acc_test</th>\n",
       "      <th>f1_test</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>GaussianNB</th>\n",
       "      <td>0.657650</td>\n",
       "      <td>0.728259</td>\n",
       "      <td>0.654957</td>\n",
       "      <td>0.724380</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SVC</th>\n",
       "      <td>0.655635</td>\n",
       "      <td>0.701360</td>\n",
       "      <td>0.652150</td>\n",
       "      <td>0.697242</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LogisticRegression</th>\n",
       "      <td>0.657310</td>\n",
       "      <td>0.689310</td>\n",
       "      <td>0.658035</td>\n",
       "      <td>0.688392</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>KNeighborsClassifier</th>\n",
       "      <td>0.651470</td>\n",
       "      <td>0.689633</td>\n",
       "      <td>0.649163</td>\n",
       "      <td>0.686919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DecisionTreeClassifier</th>\n",
       "      <td>0.688594</td>\n",
       "      <td>0.723283</td>\n",
       "      <td>0.672612</td>\n",
       "      <td>0.708434</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RandomForestClassifier</th>\n",
       "      <td>0.688594</td>\n",
       "      <td>0.723827</td>\n",
       "      <td>0.673246</td>\n",
       "      <td>0.709490</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        acc_train  f1_train  acc_test   f1_test\n",
       "GaussianNB               0.657650  0.728259  0.654957  0.724380\n",
       "SVC                      0.655635  0.701360  0.652150  0.697242\n",
       "LogisticRegression       0.657310  0.689310  0.658035  0.688392\n",
       "KNeighborsClassifier     0.651470  0.689633  0.649163  0.686919\n",
       "DecisionTreeClassifier   0.688594  0.723283  0.672612  0.708434\n",
       "RandomForestClassifier   0.688594  0.723827  0.673246  0.709490"
      ]
     },
     "execution_count": 430,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rs_df[['acc_train','f1_train','acc_test','f1_test']]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the majority of the models, accuracy ranges between 65% and 67.3%, in which Random Forest Classifier performs the best. No overfitting is seen in any of the models, and Random Forest Classifier also has the highest f1_test of 71%. Therefore, Random Forest Classifier is selected."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 432,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 432,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAABNAAAAI/CAYAAAC28CSIAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/MnkTPAAAACXBIWXMAAAsTAAALEwEAmpwYAAA0zElEQVR4nO3de7RmV10m6vclhQmQpGghYhGFUgwgdCBAEQSCBkGObVREoaOdxiAe03hpvDTaGWLTiK2WSh8QFDGH5uKlaQQJAlFErgnXpCoJqYAJ0FAODBwUxQoQEiGZ54+90m7LXav2rtpV367U84yxx17fXHPO9Vu71vhGjXfMtVbHGAEAAAAAVna7RRcAAAAAABuZAA0AAAAAZgjQAAAAAGCGAA0AAAAAZgjQAAAAAGCGAA0AAAAAZmxadAGs3V3vetexdevWRZcBAAAAcJuxc+fOz4wxTlppnwDtCLR169bs2LFj0WUAAAAA3Ga0/at97XMLJwAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwB2oK1vXvb10zbZ7Z946JrAgAAAOCfbFp0AUe7McYnkzxx0XUAAAAAsDIr0Nao7b9ve2nbK9v+bttj2n6+7a+13dn2LW1Pb/uOth9r+93TuK1tL2l7+fTziGXtVy/2rAAAAADYFwHaGrT9xiRnJ3nkGOO0JDcnOSfJnZK8Y4zxkCSfS/Lfknxbkickec40/G+SfNsY48HTHC84vNUDAAAAcCDcwrk2j0nykCSXtU2SO2QpGPvHJG+a+uxKctMY40ttdyXZOrXfPslvtT0tS8Hbvddy4LbnJTkvSe5xj3sc1EkAAAAAsHpWoK1Nk7xijHHa9HOfMcazk3xpjDGmPrckuSlJxhi35J9Cyp9O8ukkD0yyLclXrOXAY4wLxhjbxhjbTjrppHU4FQAAAABWQ4C2Nm9N8sS2X5Ukbb+y7T1XOXZzkk9NodqTkxxziGoEAAAAYB0J0NZgjPGhJL+Q5M1tr0ryF0m2rHL4i5Kc2/Z9Wbp98wuHpkoAAAAA1lP/6c5DjhTbtm0bO3bsWHQZAAAAALcZbXeOMbattM8KNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBmbFl0Aa7fruj3Zev5Fh/24u7efddiPCQAAALBoVqABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADM2HABWtv3rKLPo9p+sO2Vbe9wmOo6s+0jln1+WtsfXOdjbG179XrOCQAAAMDB2XBv4RxjPGL/vXJOkueOMV62mjnbHjPGuPngKsuZST6f5D1JMsZ48UHOBwAAAMARYCOuQPv89PvMtu9o+5q217T9wy75v5P82yTPWtb2G22vbrur7dnLxr+97f9Msmv6/M62f9T2w223tz2n7aXTuHtN476r7fvbXtH2LW3v1nZrkqcl+elp1duj2j677TOmMae1fV/bq9pe2PZfTe3vaPtr0zE+3PZRU/vWtpe0vXz6WU1oCAAAAMACbLgAbS8PSvJTSe6X5OuTPHKM8ZIkr0/ys2OMc5J8b5LTkjwwyWOT/EbbLdP405M8c4xxv+nzA5P8ZJJTkzw5yb3HGKcneUmS/zj1eVeSbxpjPCjJ/0ryc2OM3UlenOR5Y4zTxhiX7FXn7yX5z2OMByTZleS/Ltu3aTrGTy1r/5sk3zbGeHCSs5O84ID+OgAAAAAcchvuFs69XDrG+OskaXtlkq1ZCriWOyPJK6dbND/d9p1JHprk+mn8x5f1vWyM8alpvv+d5M1T+64kj562vybJq6YQ7iuSLB//L7TdnOTOY4x3Tk2vSPLqZV1eO/3eOdWfJLdP8lttT0tyc5J7zx1jOs55Sc5LkmNOPGl/3QEAAABYJxt9BdpNy7ZvzsqBX2fGf2FmvluWfb5l2dwvTPJbY4xTk/yHJMetutqV3XqM5fX/dJJPZ2lF3LYsBXWzxhgXjDG2jTG2HXPHzQdZEgAAAACrtdEDtNW4OMnZbY9pe1KSb05y6UHMtznJddP2ucvaP5fkhL07jzH2JPnsrc83y9Ktoe/cu98Kx/jUGOOWqf8xB1EvAAAAAIfQbSFAuzDJVUk+kORtWXpm2f93EPM9O8mr216S5DPL2t+Q5Am3vkRgrzHnZunZa1dl6Xlsz9nPMV6U5Ny278vS7Zt7r5QDAAAAYIPoGGPRNbBGx245ZWw59/mH/bi7t5912I8JAAAAcDi03TnG2LbSvtvCCjQAAAAAOGQEaAAAAAAwQ4AGAAAAADMEaAAAAAAwQ4AGAAAAADM2LboA1u7UkzdnhzdiAgAAABwWVqABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwIxNiy6Atdt13Z5sPf+iRZdx0HZvP2vRJQAAAADslxVoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoB6jt1rZXL7oOAAAAAA4tARoAAAAAzBCgHZxNbV/R9qq2r2l7x7aPaXtF211tX9r22CRp+x1tr2n7rrYvaPvGqf0r275umuN9bR+w2FMCAAAAYDkB2sG5T5ILxhgPSHJ9kp9J8vIkZ48xTk2yKcmPtj0uye8m+TdjjDOSnLRsjl9McsU0x88n+b3DWD8AAAAA+yFAOzifGGO8e9r+gySPSfLxMcaHp7ZXJPnmJPdN8rExxsen9lcum+OMJL+fJGOMtyW5S9vNex+o7Xltd7TdcfMNew7BqQAAAACwEgHawRmr7Nc17vsX844xLhhjbBtjbDvmjv8iXwMAAADgEBGgHZx7tH34tP0DSd6SZGvbb5janpzknUmuSfL1bbdO7Wcvm+PiJOckSdszk3xmjHH9oS0bAAAAgNXatOgCjnB/meTctr+b5CNJfjLJ+5K8uu2mJJclefEY46a2P5bkTW0/k+TSZXM8O8nL2l6V5IYk5x7OEwAAAABgngDtAI0xdie53wq73prkQSu0v32Mcd+2TfLbSXZM8/x9kscfqjoBAAAAODhu4Tx8fqTtlUk+mGRzlt7KCQAAAMAGZwXaYTLGeF6S5y26DgAAAADWxgo0AAAAAJghQAMAAACAGQI0AAAAAJjhGWhHoFNP3pwd289adBkAAAAARwUr0AAAAABghgANAAAAAGYI0AAAAABghgANAAAAAGYI0AAAAABghgANAAAAAGYI0AAAAABghgANAAAAAGYI0AAAAABghgANAAAAAGYI0AAAAABghgANAAAAAGYI0AAAAABghgANAAAAAGYI0AAAAABghgANAAAAAGYI0AAAAABghgANAAAAAGZsWnQBrN2u6/Zk6/kXLbqMdbF7+1mLLgEAAABglhVoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADDjqH8LZ9tnJ/l8khOTXDzGeMuC6jgtyd3HGH+6iOMDAAAAsLKjPkC71RjjWQsu4bQk25II0AAAAAA2kKPyFs62z2x7bdu3JLnP1Pbytk+ctre3/VDbq9o+d2q7W9sL235g+nnE1P4zba+efn5qatva9uplx3vGtNItbd/R9tfaXtr2w20f1fYrkjwnydltr2x79mH8cwAAAAAw46hbgdb2IUm+P8mDsnT+lyfZuWz/VyZ5QpL7jjFG2ztPu16Q5J1jjCe0PSbJ8dNcP5TkYUma5P1t35nks/spY9MY4/S235Hkv44xHtv2WUm2jTF+Yt1OFgAAAICDdjSuQHtUkgvHGDeMMa5P8vq99l+f5MYkL2n7vUlumNq/NcnvJMkY4+Yxxp4kZ0xzfWGM8fkkr53m35/XTr93Jtm6mqLbntd2R9sdN9+wZzVDAAAAAFgHR2OAliRjnzvG+HKS05P8cZLvSfKmmXm6j/Yv55//bY/ba/9N0++bs8pVgGOMC8YY28YY24654+bVDAEAAABgHRyNAdrFSZ7Q9g5tT0jyXct3tj0+yebpbZg/laWH+yfJW5P86NTnmLYnTnN9T9s7tr1Tlm79vCTJp5N8Vdu7tD02yXeuoq7PJTnhYE8OAAAAgPV11AVoY4zLk7wqyZVZWmV2yV5dTkjyxrZXJXlnkp+e2n8yyaPb7srSrZf3n+Z6eZJLk7w/yUvGGFeMMb6UpZcCvD/JG5Ncs4rS3p7kfl4iAAAAALCxdIx93s3IBnXsllPGlnOfv+gy1sXu7WctugQAAACAtN05xti20r6jbgUaAAAAAKyFAA0AAAAAZgjQAAAAAGCGAA0AAAAAZgjQAAAAAGDGpkUXwNqdevLm7PD2SgAAAIDDwgo0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGZsWXQBrt+u6Pdl6/kWLLuOQ2b39rEWXAAAAAPB/WIEGAAAAADMEaAAAAAAwQ4AGAAAAADMEaAAAAAAwQ4AGAAAAADMEaAvWdnfbuy66DgAAAABWJkADAAAAgBkCtHXS9ufaPn3afl7bt03bj2n7B20f1/a9bS9v++q2xy8b/rNtL51+vmEhJwAAAADAigRo6+fiJI+atrclOb7t7ZOckWRXkl9I8tgxxoOT7EjyM8vGXj/GOD3JbyV5/mGrGAAAAID9EqCtn51JHtL2hCQ3JXlvloK0RyX5YpL7JXl32yuTnJvknsvGvnLZ74evNHnb89ruaLvj5hv2HJozAAAAAOBf2LToAm4rxhhfars7yQ8leU+Sq5I8Osm9knw8yV+MMX5gX8P3sb18/guSXJAkx245ZcU+AAAAAKw/K9DW18VJnjH9viTJ05JcmeR9SR556/PN2t6x7b2XjTt72e/3HrZqAQAAANgvK9DW1yVJnpnkvWOML7S9McklY4y/bfuUJK9se+zU9xeSfHjaPrbt+7MUaO5rlRoAAAAACyBAW0djjLcmuf2yz/detv22JA9dYczWafMXD3V9AAAAAKydWzgBAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIa3cB6BTj15c3ZsP2vRZQAAAAAcFaxAAwAAAIAZAjQAAAAAmCFAAwAAAIAZAjQAAAAAmCFAAwAAAIAZAjQAAAAAmCFAAwAAAIAZAjQAAAAAmCFAAwAAAIAZAjQAAAAAmCFAAwAAAIAZAjQAAAAAmCFAAwAAAIAZAjQAAAAAmCFAAwAAAIAZAjQAAAAAmCFAAwAAAIAZAjQAAAAAmLFp0QWwdruu25Ot51+06DLY4HZvP2vRJQAAAMBtghVoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAM464AK3ts9s+Yx3muXPbH1v2+e5tX3Ow8+51jM/vo/05bR+7nscCAAAA4NA44gK0tWi7aWb3nZP8nwBtjPHJMcYTD3lRS8d61hjjLYfjWAAAAAAcnCMiQGv7zLbXtn1LkvtMbe9ou23avmvb3dP2U9q+uu0bkry57fFt39r28ra72j5+mnZ7knu1vbLtb7Td2vbqaY7j2r5s6n9F20cvm/u1bd/U9iNtf30Vtf/36dhvbXvS1Pbytk+ctne3/cVl9d13Xf94AAAAAByUDR+gtX1Iku9P8qAk35vkoasY9vAk544xvjXJjUmeMMZ4cJJHJ/nvbZvk/CT/e4xx2hjjZ/ca/+NJMsY4NckPJHlF2+OmfaclOTvJqUnObvu1M3XcKcnl07HfmeS/7qPfZ6Y+v5NkxdtT257XdkfbHTffsGfu3AEAAABYRxs+QEvyqCQXjjFuGGNcn+T1qxjzF2OMv5+2m+RX2l6V5C1JTk5yt/2MPyPJ7yfJGOOaJH+V5N7TvreOMfaMMW5M8qEk95yZ55Ykr5q2/2CadyWvnX7vTLJ1pQ5jjAvGGNvGGNuOuePm/ZQPAAAAwHqZe0bYRjJWaPty/ikAPG6vfV9Ytn1OkpOSPGSM8aXpVs+9+++tM/tuWrZ9c9b2N1zpPJbPudb5AAAAADjEjoQVaBcneULbO7Q9Icl3Te27kzxk2p57+P/mJH8zhWePzj+tGPtckhNmjnlOkrS9d5J7JLn2AGq/3bLa/l2Sdx3AHAAAAAAs0IZf7TTGuLztq5JcmaVbKS+Zdj03yR+1fXKSt81M8YdJ3tB2xzTHNdO8f9f23dOLA/4syW8vG/OiJC9uuytLK92eMsa4aenRaWvyhST3b7szyZ4sPTsNAAAAgCNIx9jXXYVsVMduOWVsOff5iy6DDW739rMWXQIAAAAcMdruHGNsW2nfkXALJwAAAAAszIa/hfNI0Pb9SY7dq/nJY4xdi6gHAAAAgPUjQFsHY4yHLboGAAAAAA4NAdoR6NSTN2eH51sBAAAAHBaegQYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMzYtugDWbtd1e7L1/IsWXQZHgN3bz1p0CQAAAHDEswINAAAAAGYI0AAAAABghgANAAAAAGYI0AAAAABghgANAAAAAGYI0A5C2zPbvnFm/7PbPmOF9ru3fc2hrQ4AAACA9XCbCtC65JCdU9tj1mOeMcYnxxhPXI+5AAAAADi0jvgAre3Wtn/Z9kVJLk/yX9pe1vaqtr849fm5tk+ftp/X9m3T9mPa/sG0/Tttd7T94K3jpvbdbZ/V9l1JntT229teM33+3lWU+MC2b2v7kbY/sqzmq6ftp7R9bds3TX1+fR3/PAAAAAAcpE2LLmCd3CfJDyV5XZInJjk9SZO8vu03J7k4yX9K8oIk25Ic2/b2Sc5Icsk0xzPHGH8/rTJ7a9sHjDGumvbdOMY4o+1xST6S5FuTfDTJq1ZR2wOSfFOSOyW5ou1FK/Q5LcmDktyU5Nq2LxxjfGItfwAAAAAADo0jfgXa5K/GGO9L8rjp54osrUa7b5JTkuxM8pC2J2QppHpvloK0R+WfArR/2/byaez9k9xv2fy3BmX3TfLxMcZHxhgjyR+sorY/GWN8cYzxmSRvz1K4t7e3jjH2jDFuTPKhJPfcu0Pb86YVcjtuvmHPKg4LAAAAwHq4raxA+8L0u0l+dYzxu3t3aLs7S6vU3pPkqiSPTnKvJH/Z9uuSPCPJQ8cYn2378iTHrTB/kow11rZ3/5XG37Rs++as8O8yxrggyQVJcuyWU9ZaAwAAAAAH6LayAu1Wf57kqW2PT5K2J7f9qmnfxVkKyS7O0qqzpyW5clpJdmKWQrI9be+W5N/sY/5rknxd23tNn39gFTU9vu1xbe+S5Mwkl639tAAAAABYlNtUgDbGeHOS/5nkvW13JXlNkhOm3Zck2ZLkvWOMTye5cWrLGOMDWbp184NJXprk3fuY/8Yk5yW5aHqJwF+toqxLk1yU5H1JfmmM8ckDOzsAAAAAFqFLC7A4khy75ZSx5dznL7oMjgC7t5+16BIAAADgiNB25xhj20r7blMr0AAAAABgvd1WXiKwUG1/KMlP7tX87jHGjy+iHgAAAADWjwBtHYwxXpbkZYuuAwAAAID15xZOAAAAAJhhBdoR6NSTN2eHh8MDAAAAHBZWoAEAAADADAEaAAAAAMwQoAEAAADADAEaAAAAAMwQoAEAAADADAEaAAAAAMwQoAEAAADADAEaAAAAAMwQoAEAAADADAEaAAAAAMwQoAEAAADADAEaAAAAAMwQoAEAAADADAEaAAAAAMwQoAEAAADADAEaAAAAAMwQoAEAAADADAEaAAAAAMwQoAEAAADAjE2LLoC123Xdnmw9/6JFl8ERbvf2sxZdAgAAABwRrEADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBlHTIDW9tltn9H2OW0fO7U9qu0H217Z9g5tf2P6/Bttn9b2Bw/wWO9ou23a/vkDnOPMtm/cx74/bXvnA5kXAAAAgMNr06ILWKsxxrOWfTwnyXPHGC9Lkrb/IclJY4yb1vGQP5/kV9ZxvowxvmM95wMAAADg0NnQAVrbZyb5wSSfSPK3SXa2fXmSNya5c5J/m+T/mlaknZDkTkne3/ZXk3xjks+PMZ7b9huSvDjJSUluTvKkJF+b5BljjO+cjvVbSXaMMV6+7Pjbk9yh7ZVJPpjkY0k+M8b4zWn/Lyf59BjjBfs4hRPbXpjkPkkuTvJjY4xb2u5Osi3J8Un+LMm7kjwiyXVJHj/G+OJB/NkAAAAAWEcb9hbOtg9J8v1JHpTke5M8dPn+McZLkrw+yc+OMc4ZY3x3ki+OMU4bY7xqr+n+MMlvjzEemKWg6lOrqWGMcf6yOc9J8j+SnDvVd7upvj+cmeL0JP8pyalJ7jWdx95OmWq7f5J/SPJ9K03U9ry2O9ruuPmGPaspHwAAAIB1sGEDtCSPSnLhGOOGMcb1WQrL1qztCUlOHmNcmCRjjBvHGDccyFxjjN1J/q7tg5I8LskVY4y/mxly6RjjY2OMm5O8MskZK/T5+Bjjyml7Z5Kt+zj2BWOMbWOMbcfccfOBlA8AAADAAdjQt3AmGeswR/fR/uX88wDxuFXO95IkT0ny1Uleup++e9e/0vksf17bzUnusMo6AAAAADgMNvIKtIuTPGF6u+YJSb7rQCaZVq/9ddvvSZK2x7a9Y5K/SnK/6fPmJI/ZxxRfanv7ZZ8vTPLtWbql9M/3c/jT237ddLvn2Vl61hkAAAAAR5ANG6CNMS5P8qokVyb54ySXHMR0T07y9LZXJXlPkq8eY3wiyR8luSpLzzG7Yh9jL0hyVds/nOr6xyRvT/JH062Zc96bZHuSq5N8PEvhGwAAAABHkI6xHndJHj2m1WSXJ3nSGOMji6jh2C2njC3nPn8Rh+Y2ZPf2sxZdAgAAAGwYbXeOMbattG/DrkDbiNreL8lHk7x1UeEZAAAAAIfXRn+JwIYyxvhQkq9f3tb21CS/v1fXm8YYDztshQEAAABwyAjQDtIYY1eS0xZdBwAAAACHhls4AQAAAGCGFWhHoFNP3pwdHgAPAAAAcFhYgQYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMzYtugDWbtd1e7L1/IsWXQbc5u3eftaiSwAAAGADsAINAAAAAGYI0AAAAABghgANAAAAAGYI0AAAAABghgDtMGj78rZPXHQdAAAAAKydAG0DauvtqAAAAAAbhKBmL23/S5JzknwiyWeS7ExyYZLfTnJSkhuS/MgY45q2L09yfZJtSb46yc+NMV7TtklemORbk3w8SZfN/5Ak/0+S46f5nzLG+FTbdyR5T5JHJnl9kv9+yE8WAAAAgP0SoC3TdluS70vyoCz9bS7PUoB2QZKnjTE+0vZhSV6UpXAsSbYkOSPJfbMUfL0myROS3CfJqUnuluRDSV7a9vZZCtYeP8b427ZnJ/nlJE+d5rrzGONbDvmJAgAAALBqArR/7owkfzLG+GKStH1DkuOSPCLJq5cWliVJjl025nVjjFuSfKjt3aa2b07yyjHGzUk+2fZtU/t9kvzrJH8xzXVMkk8tm+tV+yqs7XlJzkuSY0486YBPEAAAAIC1EaD9c12h7XZJ/mGMcdo+xty0j/FjH/N/cIzx8H3M9YV9FTbGuCBLK+Fy7JZTVpobAAAAgEPASwT+uXcl+a62x7U9PslZWXrm2cfbPilJuuSB+5nn4iTf3/aYtluSPHpqvzbJSW0fPs11+7b3PyRnAgAAAMC6EKAtM8a4LEvPMftAktcm2ZFkT5ZeKvDDbT+Q5INJHr+fqS5M8pEku5L8TpJ3TvP/Y5InJvm1aa4rs3R7KAAAAAAbVMdwN+BybY8fY3y+7R2ztJLsvDHG5Yuua7ljt5wytpz7/EWXAbd5u7eftegSAAAAOEza7hxjbFtpn2eg/UsXtL1fll4e8IqNFp4BAAAAcHgJ0PYyxvh3i64BAAAAgI3DM9AAAAAAYIYADQAAAABmCNAAAAAAYIZnoB2BTj15c3Z4OyAAAADAYWEFGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwAwBGgAAAADMEKABAAAAwIxNiy6Atdt13Z5sPf+iRZcBHKDd289adAkAAACsgRVoAAAAADBDgAYAAAAAMwRoAAAAADBDgAYAAAAAMwRoAAAAADBDgLbO2j677TNWaL9729dM22e2fePhrw4AAACAtdq06AKOFmOMTyZ54qLrAAAAAGBtrEBbQdutba9p+5K2V7f9w7aPbfvuth9pe3rbr2z7urZXtX1f2wcsm+KBbd829f2RZXNevcKx7tT2pW0va3tF28cfthMFAAAAYL+sQNu3b0jypCTnJbksyb9LckaS707y80k+keSKMcb3tP3WJL+X5LRp7AOSfFOSOyW5ou1FM8d5ZpK3jTGe2vbOSS5t+5YxxhfW/5QAAAAAWCsr0Pbt42OMXWOMW5J8MMlbxxgjya4kW7MUpv1+kowx3pbkLm03T2P/ZIzxxTHGZ5K8PcnpM8d5XJLz216Z5B1Jjktyj707tT2v7Y62O26+Yc96nB8AAAAAq2AF2r7dtGz7lmWfb8nS3+3LK4wZe/3eu30lTfJ9Y4xr54oZY1yQ5IIkOXbLKXPzAQAAALCOrEA7cBcnOSdZeqtmks+MMa6f9j2+7XFt75LkzCzdArovf57kP7btNNeDDlXBAAAAAKydFWgH7tlJXtb2qiQ3JDl32b5Lk1yUpVsxf2mM8cm2W/cxzy8leX6Sq6YQbXeS7zw0JQMAAACwVl16rBdHkmO3nDK2nPv8RZcBHKDd289adAkAAADspe3OMca2lfa5hRMAAAAAZgjQAAAAAGCGAA0AAAAAZgjQAAAAAGCGAA0AAAAAZmxadAGs3aknb84Ob/EDAAAAOCysQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJghQAMAAACAGQI0AAAAAJixadEFsHa7rtuTredftOgyAI5Ku7eftegSAACAw8wKNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCNAAAAACYIUADAAAAgBkCtEOo7bPbPmOF9ru3fc0iagIAAABgbTYtuoCj0Rjjk0meuOg6AAAAANg/K9CStH1d251tP9j2vKnth9t+uO072v6/bX9raj+p7R+3vWz6eeR+pn9g27e1/UjbH5nm2Nr26mn7KW1f2/ZNU59fP6QnCwAAAMCaWIG25KljjL9ve4ckl7W9KMl/SfLgJJ9L8rYkH5j6/maS540x3tX2Hkn+PMk3zsz9gCTflOROSa6Y5t7baUkelOSmJNe2feEY4xPLO0zB3nlJcsyJJx3YWQIAAACwZgK0JU9v+4Rp+2uTPDnJO8cYf58kbV+d5N7T/scmuV/bW8ee2PaEMcbn9jH3n4wxvpjki23fnuT0JFfu1eetY4w907E+lOSeSf5ZgDbGuCDJBUly7JZTxgGdJQAAAABrdtQHaG3PzFIo9vAxxg1t35Hk2ux7Vdntpr5fXOUh9g67Vgq/blq2fXP8uwAAAABsGJ6BlmxO8tkpPLtvlm63vGOSb2n7r9puSvJ9y/q/OclP3Pqh7Wn7mf/xbY9re5ckZya5bD2LBwAAAODQEqAlb0qyqe1VSX4pyfuSXJfkV5K8P8lbknwoyZ6p/9OTbGt71XS75dP2M/+lSS6a5v2l6Q2cAAAAABwhOobHaa2k7fFjjM9PK9AuTPLSMcaFi64rWXoG2pZzn7/oMgCOSru3n7XoEgAAgEOg7c4xxraV9lmBtm/PbntlkquTfDzJ6xZaDQAAAAAL4WH1+zDGeMZq+7b9oSQ/uVfzu8cYP76+VQEAAABwuAnQ1sEY42VJXrboOgAAAABYf27hBAAAAIAZVqAdgU49eXN2eIg1AAAAwGFhBRoAAAAAzBCgAQAAAMAMARoAAAAAzBCgAQAAAMAMARoAAAAAzBCgAQAAAMAMARoAAAAAzBCgAQAAAMAMARoAAAAAzBCgAQAAAMAMARoAAAAAzBCgAQAAAMAMARoAAAAAzBCgAQAAAMAMARoAAAAAzBCgAQAAAMAMARoAAAAAzBCgAQAAAMCMTYsugLXbdd2ebD3/okWXAQDrYvf2sxZdAgAAzLICDQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYMYRG6C1fc+ia9ifti9v+8QV2re1fcEiagIAAABgbTYtuoADNcZ4xKJrOFBjjB1Jdiy6DgAAAAD270hegfb56feZbd/R9jVtr2n7h2077Xto2/e0/UDbS9ue0Pa4ti9ru6vtFW0fPfV9StvXtX1D24+3/Ym2PzP1eV/br5z63avtm9rubHtJ2/vup9THTv0+3PY7l9X8xmn72W1fOp3Dx9o+/ZD90QAAAABYsyN2BdpeHpTk/kk+meTdSR7Z9tIkr0py9hjjsrYnJvlikp9MkjHGqVP49ea2957m+dfTXMcl+WiS/zzGeFDb5yX5wSTPT3JBkqeNMT7S9mFJXpTkW2dq25rkW5LcK8nb237DCn3um+TRSU5Icm3b3xljfGl5h7bnJTkvSY458aRV/2EAAAAAODi3lQDt0jHGXydJ2yuzFFrtSfKpMcZlSTLGuH7af0aSF05t17T9qyS3BmhvH2N8Lsnn2u5J8oapfVeSB7Q9Pskjkrx6WuSWJMfup7Y/GmPckuQjbT+WpbBsbxeNMW5KclPbv0lytyR/vbzDGOOCLIV3OXbLKWM/xwQAAABgndxWArSblm3fnKXzapKVgqau0LbSPLcs+3zLNOftkvzDGOO0NdS2dw0r1bRS/QAAAABsAEfsM9BW4Zokd2/70CSZnn+2KcnFSc6Z2u6d5B5Jrl3NhNMqto+3fdI0vm0fuJ9hT2p7u7b3SvL1qz0WAAAAABvDbTZAG2P8Y5Kzk7yw7QeS/EWWnm32oiTHtN2VpWekPWW6fXK1zknyw9OcH0zy+P30vzbJO5P8WZaenXbj2s4EAAAAgEXqGB6ndaQ5dsspY8u5z190GQCwLnZvP2vRJQAAQNruHGNsW2nfbXYFGgAAAACsBw+rXwdtn5nkSXs1v3qM8cuLqAcAAACA9SNAWwdTUCYsAwAAALgNEqAdgU49eXN2eF4MAAAAwGHhGWgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMGPTogtg7XZdtydbz79o0WUAAABHmd3bz1p0CQALYQUaAAAAAMwQoAEAAADADAEaAAAAAMwQoAEAAADADAEaAAAAAMw46gO0tme2feMhmPcdbbet0P7dbc9f7+MBAAAAcGhsOtwHbHvMGOPmw33cQ2Wt5zPGeH2S1x/CkgAAAABYR7Mr0Nr+UtufXPb5l9s+ve3Ptr2s7VVtf3HZ/te13dn2g23PW9b++bbPafv+JA9vu73th6bxz505/svb/k7bt7f9WNtvafvStn/Z9uXL+j2u7XvbXt721W2Pn9p3t/2Vad+Otg9u++dt/3fbpy071IltL5xqenHb261i3me1fVeSJ838Cf992/e0vbrt6dPYp7T9rWXn94Kpz8faPnHu3wMAAACAw29/t3D+jyTnJskUKn1/kk8nOSXJ6UlOS/KQtt889X/qGOMhSbYleXrbu0ztd0py9RjjYUk+lOQJSe4/xnhAkv+2nxr+VZJvTfLTSd6Q5HlJ7p/k1Lantb1rkl9I8tgxxoOT7EjyM8vGf2KM8fAklyR5eZInJvmmJM9Z1uf0JP8pyalJ7pXke1cx741jjDPGGP9rpvY7jTEekeTHkrx0H322JDkjyXcm2T73hwAAAADg8Ju9hXOMsbvt37V9UJK7JbkiyUOTPG7aTpLjsxSoXZyl0OwJU/vXTu1/l+TmJH88tV+f5MYkL2l7UZL9PX/sDWOM0XZXkk+PMXYlSdsPJtma5GuS3C/Ju9smyVckee+y8bfeLrkryfFjjM8l+VzbG9veedp36RjjY9O8r8xSoHXjfuZ91X7qTpJXJskY4+K2Jy473nKvG2PckuRDbe+2r4mmFX3nJckxJ560ikMDAAAAsB5W8wy0lyR5SpKvztIqqsck+dUxxu8u79T2zCSPTfLwMcYNbd+R5Lhp9423PidsjPHl6XbGx2RpRdtPZGmF2b7cNP2+Zdn2rZ83ZSmc+4sxxg8c4PgkGXuNGUm6n3m/MFPz8nnmPi+vL9MxV55ojAuSXJAkx245ZaV5AAAAADgEVvMWzguTfHuWVp79+fTz1GXPAzu57Vcl2Zzks1N4dt8s3Sb5L0zjNo8x/jTJT2XpNtCD8b4kj2z7DdP8d2x77zXOcXrbr5tuUz07ybvWad6zp7FnJNkzxtizxvEAAAAALNh+V6CNMf6x7duT/MO0iuzNbb8xyXunWxs/n+TfJ3lTkqe1vSrJtVkKoFZyQpI/aXtcllZc/fTBnMAY42/bPiXJK9seOzX/QpIPr2Ga92bp+WOnZulW1AvHGLesw7yfbfueJCcmeeoaxgEAAACwQXSM+bsBp1VZlyd50hjjI4elKmYdu+WUseXc5y+6DAAA4Cize/tZiy4B4JBpu3OMsW2lfbO3cLa9X5KPJnmr8AwAAACAo9H+3sL5oSRff6iLaPvMJE/aq/nVY4xfPtTHPlhtfzvJI/dq/s0xxssWUQ8AAAAA62s1b+E85KagbMOHZSsZY/z4omsAAAAA4NBZzVs4AQAAAOCotSFWoLE2p568OTs8vBMAAADgsLACDQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmCNAAAAAAYIYADQAAAABmbFp0Aazdruv2ZOv5Fy26DAAAAOAotXv7WYsu4bCyAg0AAAAAZgjQAAAAAGCGAA0AAAAAZgjQAAAAAGCGAO0wabut7Qv20+fMtm88XDUBAAAAsH/ewnmYjDF2JNmx6DoAAAAAWBsr0Fap7Z3aXtT2A22vbnt228e0vaLtrrYvbXvs1Pehbd8z9b207QnLV5e1PX3af8X0+z6LPTsAAAAA9sUKtNX79iSfHGOclSRtNye5Osljxhgfbvt7SX607YuSvCrJ2WOMy9qemOSLe811TZJvHmN8ue1jk/xKku87bGcCAAAAwKoJ0FZvV5Lntv21JG9Mcn2Sj48xPjztf0WSH0/y1iSfGmNcliRjjOuTpO3yuTYneUXbU5KMJLff38HbnpfkvCQ55sST1uN8AAAAAFgFt3Cu0hSUPSRLQdqvJnn8Pro2S6HYnF9K8vYxxr9O8l1JjlvF8S8YY2wbY2w75o6bV184AAAAAAdFgLZKbe+e5IYxxh8keW6SRyTZ2vYbpi5PTvLOLN2eefe2D53GndB275V+m5NcN20/5VDXDgAAAMCBcwvn6p2a5Dfa3pLkS0l+NEtB2KungOyyJC8eY/xj27OTvLDtHbL0/LPH7jXXr2fpFs6fSfK2w3YGAAAAAKxZx9jf3YZsNMduOWVsOff5iy4DAAAAOErt3n7WoktYd213jjG2rbTPLZwAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMGPTogtg7U49eXN23AbfdgEAAACwEVmBBgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzBGgAAAAAMEOABgAAAAAzOsZYdA2sUdvPJbl20XXAIXbXJJ9ZdBFwGLjWORq4zjlauNY5GrjOuS275xjjpJV2bDrclbAurh1jbFt0EXAotd3hOudo4FrnaOA652jhWudo4DrnaOUWTgAAAACYIUADAAAAgBkCtCPTBYsuAA4D1zlHC9c6RwPXOUcL1zpHA9c5RyUvEQAAAACAGVagAQAAAMAMAdoG0/bb217b9qNtz19hf9u+YNp/VdsHr3YsbBQHeZ3vbrur7ZVtdxzeymH1VnGd37fte9ve1PYZaxkLG8lBXuu+0zkirOI6P2f6P8tVbd/T9oGrHQsbxUFe577Puc1zC+cG0vaYJB9O8m1J/jrJZUl+YIzxoWV9viPJf0zyHUkeluQ3xxgPW81Y2AgO5jqf9u1Osm2M8ZnDXDqs2iqv869Kcs8k35Pks2OM5652LGwUB3OtT/t2x3c6G9wqr/NHJPnLMcZn2/6bJM/2f3SOJAdznU/7dsf3ObdxVqBtLKcn+egY42NjjH9M8r+SPH6vPo9P8ntjyfuS3LntllWOhY3gYK5zOFLs9zofY/zNGOOyJF9a61jYQA7mWocjxWqu8/eMMT47fXxfkq9Z7VjYIA7mOoejggBtYzk5ySeWff7rqW01fVYzFjaCg7nOk2QkeXPbnW3PO2RVwsE5mO9k3+ccSQ72evWdzpFgrdf5Dyf5swMcC4tyMNd54vuco8CmRRfAP9MV2va+x3ZffVYzFjaCg7nOk+SRY4xPTrcE/UXba8YYF69rhXDwDuY72fc5R5KDvV59p3MkWPV13vbRWQoWzljrWFiwg7nOE9/nHAWsQNtY/jrJ1y77/DVJPrnKPqsZCxvBwVznGWPc+vtvklyYpeXmsNEczHey73OOJAd1vfpO5wixquu87QOSvCTJ48cYf7eWsbABHMx17vuco4IAbWO5LMkpbb+u7Vck+f4kr9+rz+uT/OD0lsJvSrJnjPGpVY6FjeCAr/O2d2p7QpK0vVOSxyW5+nAWD6t0MN/Jvs85khzw9eo7nSPIfq/ztvdI8tokTx5jfHgtY2GDOODr3Pc5Rwu3cG4gY4wvt/2JJH+e5JgkLx1jfLDt06b9L07yp1l6M+FHk9yQ5Ifmxi7gNGDWwVznSe6W5MK2ydL31/8cY7zpMJ8C7NdqrvO2X51kR5ITk9zS9qeS3G+Mcb3vc44UB3OtJ7lrfKdzBFjl/12eleQuSV40XdNfHmNs8390jhQHc53H/9E5SnQMt+ADAAAAwL64hRMAAAAAZgjQAAAAAGCGAA0AAAAAZgjQAAAAAGCGAA0AAAAAZgjQAAAAAGCGAA0AAAAAZgjQAAAAAGDG/w+fDJxIZ5Df+QAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 1440x720 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "feat_importances = pd.Series(rfc.feature_importances_, index=X.columns)\n",
    "feat_importances.nlargest(20).plot(kind='barh',figsize=(20,10))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 433,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "gender              0.058829\n",
       "age_bin             0.094818\n",
       "income_bin          0.117594\n",
       "years_member_bin    0.215427\n",
       "reward_bin          0.037342\n",
       "difficulty_bin      0.039019\n",
       "duration_bin        0.036878\n",
       "mobile              0.064742\n",
       "social              0.285164\n",
       "web                 0.014886\n",
       "email               0.000000\n",
       "bogo                0.013519\n",
       "informational       0.008066\n",
       "discount            0.013716\n",
       "dtype: float64"
      ]
     },
     "execution_count": 433,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "feat_importances"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "email has 0 importance removing 'email' and training the model again"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 435,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy on train 0.6885936120605745\n",
      "Classification report on train\n",
      "               precision    recall  f1-score   support\n",
      "\n",
      "           0       0.66      0.63      0.64     19721\n",
      "           1       0.71      0.74      0.72     24456\n",
      "\n",
      "    accuracy                           0.69     44177\n",
      "   macro avg       0.68      0.68      0.68     44177\n",
      "weighted avg       0.69      0.69      0.69     44177\n",
      "\n",
      "=================================================================\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.64      0.61      0.63      4958\n",
      "           1       0.70      0.72      0.71      6087\n",
      "\n",
      "    accuracy                           0.67     11045\n",
      "   macro avg       0.67      0.67      0.67     11045\n",
      "weighted avg       0.67      0.67      0.67     11045\n",
      "\n",
      "f1 Score 0.7092826664519766\n",
      "Labels: [0 1]\n",
      "Confusion Matrix:\n",
      " [[3029 1929]\n",
      " [1682 4405]]\n"
     ]
    }
   ],
   "source": [
    "rfc = RandomForestClassifier(random_state=0)\n",
    "X=master_df_ml[['gender','age_bin','income_bin','years_member_bin','reward_bin','difficulty_bin','duration_bin',\n",
    "             'mobile','social','web','bogo','informational','discount']]\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=0)\n",
    "model,y_pred=train_n_results(rfc,X_train,y_train,X_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# GridSearchCV to find the best parameters."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 436,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'bootstrap': True,\n",
       " 'ccp_alpha': 0.0,\n",
       " 'class_weight': None,\n",
       " 'criterion': 'gini',\n",
       " 'max_depth': None,\n",
       " 'max_features': 'auto',\n",
       " 'max_leaf_nodes': None,\n",
       " 'max_samples': None,\n",
       " 'min_impurity_decrease': 0.0,\n",
       " 'min_impurity_split': None,\n",
       " 'min_samples_leaf': 1,\n",
       " 'min_samples_split': 2,\n",
       " 'min_weight_fraction_leaf': 0.0,\n",
       " 'n_estimators': 100,\n",
       " 'n_jobs': None,\n",
       " 'oob_score': False,\n",
       " 'random_state': 0,\n",
       " 'verbose': 0,\n",
       " 'warm_start': False}"
      ]
     },
     "execution_count": 436,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rfc.get_params()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 437,
   "metadata": {},
   "outputs": [],
   "source": [
    "n_estimators = [100,200,300,400,500]\n",
    "\n",
    "min_samples_split = [25,50,75,100]\n",
    "\n",
    "max_depth = [7,9,11,13,15,17,19]\n",
    "\n",
    "bootstrap = [True, False]\n",
    "\n",
    "criterion=['gini','entropy']\n",
    "\n",
    "parameters = {'n_estimators': n_estimators,\n",
    "              'min_samples_split':min_samples_split,\n",
    "               'max_depth': max_depth,\n",
    "               'bootstrap': bootstrap,\n",
    "              'criterion':criterion\n",
    "             }"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "GridSearch took 34 minutes on a 6 threaded processor while using all threads\n",
    "*******************************************************************************************************\n",
    "'{'bootstrap': False, 'criterion': 'gini','max_depth': 17,'min_samples_split': 25,'n_estimators': 100}' are the best_params"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 438,
   "metadata": {},
   "outputs": [],
   "source": [
    "# import time\n",
    "# start = time.time()\n",
    "# cv = KFold(n_splits=5, shuffle=True, random_state=1)\n",
    "\n",
    "# rfc_grid = GridSearchCV(estimator=rfc,\n",
    "#                     param_grid=parameters,\n",
    "#                     scoring='precision',\n",
    "#                     cv = cv,\n",
    "#                     verbose=10,\n",
    "#                     n_jobs=-1)\n",
    "# rfc_grid.fit(X_train,y_train)\n",
    "# end = time.time()\n",
    "# print(\"Time taken to perform GridSerach\",(end - start)/60)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 439,
   "metadata": {},
   "outputs": [],
   "source": [
    "# rfc_grid.best_score_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 440,
   "metadata": {},
   "outputs": [],
   "source": [
    "# best_params = rfc_grid.best_params_\n",
    "# best_params"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![Block Diagram](img/block_diagram.png)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 441,
   "metadata": {},
   "outputs": [],
   "source": [
    "rfc_best=RandomForestClassifier(n_estimators=100,criterion='gini',bootstrap=False,max_depth=17,min_samples_split=25,random_state=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 442,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy on train 0.6882767050727754\n",
      "Classification report on train\n",
      "               precision    recall  f1-score   support\n",
      "\n",
      "           0       0.66      0.63      0.64     19721\n",
      "           1       0.71      0.74      0.72     24456\n",
      "\n",
      "    accuracy                           0.69     44177\n",
      "   macro avg       0.68      0.68      0.68     44177\n",
      "weighted avg       0.69      0.69      0.69     44177\n",
      "\n",
      "=================================================================\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.64      0.61      0.63      4958\n",
      "           1       0.70      0.72      0.71      6087\n",
      "\n",
      "    accuracy                           0.67     11045\n",
      "   macro avg       0.67      0.67      0.67     11045\n",
      "weighted avg       0.67      0.67      0.67     11045\n",
      "\n",
      "f1 Score 0.709490461241246\n",
      "Labels: [0 1]\n",
      "Confusion Matrix:\n",
      " [[3029 1929]\n",
      " [1680 4407]]\n"
     ]
    }
   ],
   "source": [
    "model,y_pred=train_n_results(rfc_best,X_train,y_train,X_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "write something about decrease in false negatives"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 443,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 443,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1440x720 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "feat_importances = pd.Series(model.feature_importances_, index=X.columns)\n",
    "feat_importances.nlargest(20).plot(kind='barh',figsize=(20,10))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 444,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pickle\n",
    "filename='models/{}'.format(model.__class__.__name__)\n",
    "pickle.dump(model, open(filename, 'wb'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 461,
   "metadata": {},
   "outputs": [],
   "source": [
    "test_data=pd.read_csv('data/Starbucks_X_test.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "test_data has the demograohics that all the customers are grouped into."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 462,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age range</th>\n",
       "      <th>Income range</th>\n",
       "      <th>Member ship</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Male</td>\n",
       "      <td>18-33</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Male</td>\n",
       "      <td>33-48</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Male</td>\n",
       "      <td>48-61</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>61-75</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Male</td>\n",
       "      <td>75+</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>85</th>\n",
       "      <td>Others</td>\n",
       "      <td>18-33</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>Others</td>\n",
       "      <td>33-48</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>Others</td>\n",
       "      <td>48-61</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>Others</td>\n",
       "      <td>61-75</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>Others</td>\n",
       "      <td>75+</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>90 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Gender Age range Income range Member ship\n",
       "0     Male     18-33      30k-50k   <=5 years\n",
       "1     Male     33-48      30k-50k   <=5 years\n",
       "2     Male     48-61      30k-50k   <=5 years\n",
       "3     Male     61-75      30k-50k   <=5 years\n",
       "4     Male       75+      30k-50k   <=5 years\n",
       "..     ...       ...          ...         ...\n",
       "85  Others     18-33         80k+    >5 years\n",
       "86  Others     33-48         80k+    >5 years\n",
       "87  Others     48-61         80k+    >5 years\n",
       "88  Others     61-75         80k+    >5 years\n",
       "89  Others       75+         80k+    >5 years\n",
       "\n",
       "[90 rows x 4 columns]"
      ]
     },
     "execution_count": 462,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 463,
   "metadata": {},
   "outputs": [],
   "source": [
    "#creating dicts to map test_data values similar to train_data\n",
    "age_range_dict={'18-33':'age_18_33','33-48':'age_33_48','48-61':'age_48_61','61-75':'age_61_75','75+':'age_75+'}\n",
    "gender_dict={'Male':'M','Female':'F','Others':'O'}\n",
    "income_dict={'30k-50k':'below_average','50k-80k':'above_average','80k+':'rich'}\n",
    "membership_dict={'<=5 years':'below five','>5 years':'above five'}\n",
    "test_data['Age range']=test_data['Age range'].map(age_range_dict)\n",
    "test_data['Gender']=test_data['Gender'].map(gender_dict)\n",
    "test_data['Income range']=test_data['Income range'].map(income_dict)\n",
    "test_data['Member ship']=test_data['Member ship'].map(membership_dict)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 464,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age range</th>\n",
       "      <th>Income range</th>\n",
       "      <th>Member ship</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>M</td>\n",
       "      <td>age_18_33</td>\n",
       "      <td>below_average</td>\n",
       "      <td>below five</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>M</td>\n",
       "      <td>age_33_48</td>\n",
       "      <td>below_average</td>\n",
       "      <td>below five</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>M</td>\n",
       "      <td>age_48_61</td>\n",
       "      <td>below_average</td>\n",
       "      <td>below five</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Gender  Age range   Income range Member ship\n",
       "0      M  age_18_33  below_average  below five\n",
       "1      M  age_33_48  below_average  below five\n",
       "2      M  age_48_61  below_average  below five"
      ]
     },
     "execution_count": 464,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_data.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 465,
   "metadata": {},
   "outputs": [],
   "source": [
    "#renaming the columns to perform label encoding \n",
    "test_data.rename({'Age range':'age_bin','Gender':'gender','Income range':'income_bin','Member ship':'years_member_bin',},axis=1,inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 466,
   "metadata": {},
   "outputs": [],
   "source": [
    "#applying label encoding\n",
    "test_data=test_data.apply(lambda x: d[x.name].transform(x))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 403,
   "metadata": {},
   "outputs": [],
   "source": [
    "portfolio_ml=portfolio.copy()\n",
    "\n",
    "portfolio_ml['reward_bin'] = pd.cut(portfolio_ml['reward'] , bins=reward_breaks, labels=reward_labels, include_lowest=True)\n",
    "\n",
    "portfolio_ml['difficulty_bin'] = pd.cut(portfolio_ml['difficulty'] , bins=difficulty_breaks, labels=difficulty_labels, include_lowest=True)\n",
    "\n",
    "\n",
    "portfolio_ml['duration_bin'] = pd.cut(portfolio_ml['duration'] , bins=duration_breaks, labels=duration_labels, include_lowest=True)\n",
    "\n",
    "portfolio_ml.drop({'offer_id','reward','difficulty','duration'},axis=1,inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 404,
   "metadata": {},
   "outputs": [],
   "source": [
    "portfolio_ml=portfolio_ml.apply(lambda x: d[x.name].transform(x))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 467,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>reward_bin</th>\n",
       "      <th>difficulty_bin</th>\n",
       "      <th>duration_bin</th>\n",
       "      <th>mobile</th>\n",
       "      <th>social</th>\n",
       "      <th>web</th>\n",
       "      <th>bogo</th>\n",
       "      <th>informational</th>\n",
       "      <th>discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    reward_bin  difficulty_bin  duration_bin  mobile  social  web  bogo  \\\n",
       "1            2               2             2       1       1    0     1   \n",
       "2            2               2             1       1       1    1     1   \n",
       "3            3               3             1       1       0    1     0   \n",
       "4            0               0             2       1       0    1     1   \n",
       "5            0               1             0       0       0    1     0   \n",
       "6            1               0             2       1       1    1     0   \n",
       "7            1               2             0       1       1    1     0   \n",
       "8            3               3             1       1       1    0     0   \n",
       "9            0               0             1       1       1    1     1   \n",
       "10           1               2             2       1       0    1     0   \n",
       "\n",
       "    informational  discount  \n",
       "1               0         0  \n",
       "2               0         0  \n",
       "3               1         0  \n",
       "4               0         0  \n",
       "5               0         1  \n",
       "6               0         1  \n",
       "7               0         1  \n",
       "8               1         0  \n",
       "9               0         0  \n",
       "10              0         1  "
      ]
     },
     "execution_count": 467,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#rearranging the columns according to the train data set's order whith which the model is trained\n",
    "portfolio_ml=portfolio_ml[['reward_bin','difficulty_bin','duration_bin',\n",
    "             'mobile','social','web','bogo','informational','discount']]\n",
    "portfolio_ml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 468,
   "metadata": {},
   "outputs": [],
   "source": [
    "test_data_ml=test_data[['gender','age_bin','income_bin','years_member_bin']].copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 469,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.31012658, 0.68987342])"
      ]
     },
     "execution_count": 469,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.predict_proba(pd.DataFrame([[1,0,1,1,3,3,1,1,1,0,0,1,0]]))[0] #offer 1\n",
    "#['gender','age_bin','income_bin','years_member_bin','reward_bin','difficulty_bin','duration_bin',\n",
    "#            'mobile','social','web','bogo','informational','discount']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 470,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.6898734177215197"
      ]
     },
     "execution_count": 470,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.predict_proba(pd.DataFrame([[1,0,1,1,3,3,1,1,1,0,0,1,0]]))[0][1] #offer 1  #to pluck the probability"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 471,
   "metadata": {},
   "outputs": [],
   "source": [
    "#changing dataframe index to start from one\n",
    "portfolio_ml.index = np.arange(1, len(portfolio_ml)+1)\n",
    "test_data_ml.index = np.arange(1, len(test_data_ml)+1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 472,
   "metadata": {},
   "outputs": [],
   "source": [
    "for (test_data_index,gender,age_bin,income_bin,years_member_bin) in test_data_ml.itertuples():\n",
    "    max_prob_of_offer=0.0\n",
    "    max_prob_offer=None\n",
    "    for (portfolio_index,reward_bin,difficulty_bin,duration_bin,mobile,social,web,bogo,informational,discount) in portfolio_ml.itertuples():\n",
    "        current_offer_prob=model.predict_proba(pd.DataFrame([[gender,age_bin,income_bin,years_member_bin,reward_bin,difficulty_bin,duration_bin,mobile,social,web,bogo,informational,discount]]))[0][1]\n",
    "        if current_offer_prob>max_prob_of_offer:\n",
    "            max_prob_of_offer=current_offer_prob\n",
    "            max_prob_offer=portfolio_index\n",
    "    #print(\"The maximum probability among all the offers is {} for the offer {} for the demograhic with the id {}\".format(max_prob_of_offer,max_prob_offer,test_data_index))\n",
    "    #print(\"=====================================================================================\")\n",
    "    #test_data['max_prob_offer']=max_prob_offer\n",
    "    #test_data['max_prob_of_offer']=max_prob_of_offer\n",
    "    test_data_ml.at[test_data_index, 'max_prob_offer']=int(max_prob_offer)\n",
    "    test_data_ml.at[test_data_index, 'max_prob_of_offer']=float(\"{0:.2f}\".format(max_prob_of_offer))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 473,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age_bin</th>\n",
       "      <th>income_bin</th>\n",
       "      <th>years_member_bin</th>\n",
       "      <th>max_prob_offer</th>\n",
       "      <th>max_prob_of_offer</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>0.69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>0.68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>0.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>0.69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>0.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>0.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>0.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>0.96</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>90 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    gender  age_bin  income_bin  years_member_bin  max_prob_offer  \\\n",
       "1        1        0           1                 1               8   \n",
       "2        1        1           1                 1               8   \n",
       "3        1        2           1                 1               8   \n",
       "4        1        3           1                 1               8   \n",
       "5        1        4           1                 1               8   \n",
       "..     ...      ...         ...               ...             ...   \n",
       "86       2        0           2                 0               9   \n",
       "87       2        1           2                 0               2   \n",
       "88       2        2           2                 0               2   \n",
       "89       2        3           2                 0               7   \n",
       "90       2        4           2                 0               9   \n",
       "\n",
       "    max_prob_of_offer  \n",
       "1                0.69  \n",
       "2                0.68  \n",
       "3                0.66  \n",
       "4                0.69  \n",
       "5                0.76  \n",
       "..                ...  \n",
       "86               0.93  \n",
       "87               0.97  \n",
       "88               0.95  \n",
       "89               0.94  \n",
       "90               0.96  \n",
       "\n",
       "[90 rows x 6 columns]"
      ]
     },
     "execution_count": 473,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test_data_ml['max_prob_offer']=test_data_ml['max_prob_offer'].astype(int)\n",
    "test_data_ml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 474,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age_bin</th>\n",
       "      <th>income_bin</th>\n",
       "      <th>years_member_bin</th>\n",
       "      <th>max_prob_offer</th>\n",
       "      <th>max_prob_of_offer</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>M</td>\n",
       "      <td>age_18_33</td>\n",
       "      <td>below_average</td>\n",
       "      <td>below five</td>\n",
       "      <td>8</td>\n",
       "      <td>0.69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>M</td>\n",
       "      <td>age_33_48</td>\n",
       "      <td>below_average</td>\n",
       "      <td>below five</td>\n",
       "      <td>8</td>\n",
       "      <td>0.68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>M</td>\n",
       "      <td>age_48_61</td>\n",
       "      <td>below_average</td>\n",
       "      <td>below five</td>\n",
       "      <td>8</td>\n",
       "      <td>0.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>M</td>\n",
       "      <td>age_61_75</td>\n",
       "      <td>below_average</td>\n",
       "      <td>below five</td>\n",
       "      <td>8</td>\n",
       "      <td>0.69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>M</td>\n",
       "      <td>age_75+</td>\n",
       "      <td>below_average</td>\n",
       "      <td>below five</td>\n",
       "      <td>8</td>\n",
       "      <td>0.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>O</td>\n",
       "      <td>age_18_33</td>\n",
       "      <td>rich</td>\n",
       "      <td>above five</td>\n",
       "      <td>9</td>\n",
       "      <td>0.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>O</td>\n",
       "      <td>age_33_48</td>\n",
       "      <td>rich</td>\n",
       "      <td>above five</td>\n",
       "      <td>2</td>\n",
       "      <td>0.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>O</td>\n",
       "      <td>age_48_61</td>\n",
       "      <td>rich</td>\n",
       "      <td>above five</td>\n",
       "      <td>2</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>O</td>\n",
       "      <td>age_61_75</td>\n",
       "      <td>rich</td>\n",
       "      <td>above five</td>\n",
       "      <td>7</td>\n",
       "      <td>0.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90</th>\n",
       "      <td>O</td>\n",
       "      <td>age_75+</td>\n",
       "      <td>rich</td>\n",
       "      <td>above five</td>\n",
       "      <td>9</td>\n",
       "      <td>0.96</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>90 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   gender    age_bin     income_bin years_member_bin  max_prob_offer  \\\n",
       "1       M  age_18_33  below_average       below five               8   \n",
       "2       M  age_33_48  below_average       below five               8   \n",
       "3       M  age_48_61  below_average       below five               8   \n",
       "4       M  age_61_75  below_average       below five               8   \n",
       "5       M    age_75+  below_average       below five               8   \n",
       "..    ...        ...            ...              ...             ...   \n",
       "86      O  age_18_33           rich       above five               9   \n",
       "87      O  age_33_48           rich       above five               2   \n",
       "88      O  age_48_61           rich       above five               2   \n",
       "89      O  age_61_75           rich       above five               7   \n",
       "90      O    age_75+           rich       above five               9   \n",
       "\n",
       "    max_prob_of_offer  \n",
       "1                0.69  \n",
       "2                0.68  \n",
       "3                0.66  \n",
       "4                0.69  \n",
       "5                0.76  \n",
       "..                ...  \n",
       "86               0.93  \n",
       "87               0.97  \n",
       "88               0.95  \n",
       "89               0.94  \n",
       "90               0.96  \n",
       "\n",
       "[90 rows x 6 columns]"
      ]
     },
     "execution_count": 474,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#inverse transforming the labelled data to original form\n",
    "test_data_ml[['gender','age_bin','income_bin','years_member_bin']]=test_data_ml[['gender',\n",
    "                                                                                 'age_bin','income_bin','years_member_bin']].apply(lambda x: d[x.name].inverse_transform(x))\n",
    "test_data_ml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 475,
   "metadata": {},
   "outputs": [],
   "source": [
    "#swapping keys and values to remap the data to redable format\n",
    "age_range_dict_remap = {y:x for x,y in age_range_dict.items()}\n",
    "gender_dict_remap = {y:x for x,y in gender_dict.items()}\n",
    "income_dict_remap = {y:x for x,y in income_dict.items()}\n",
    "membership_dict_remap = {y:x for x,y in membership_dict.items()}\n",
    "test_data_ml['age_bin']=test_data_ml['age_bin'].map(age_range_dict_remap)\n",
    "test_data_ml['gender']=test_data_ml['gender'].map(gender_dict_remap)\n",
    "test_data_ml['income_bin']=test_data_ml['income_bin'].map(income_dict_remap)\n",
    "test_data_ml['years_member_bin']=test_data_ml['years_member_bin'].map(membership_dict_remap)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Results and Justification"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Click <a href=\"https://docs.google.com/spreadsheets/d/1Lc3pBF04SjOxjunbaiuLOw6ProiPE68ZOXrZ9BTnHY8/edit#gid=1770578135\" target=\"_blank\">here</a> to see final results in a google sheet\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 476,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "a = test_data_ml['max_prob_offer'].value_counts()\n",
    "x = list(a.index)\n",
    "y = list(a)\n",
    "x, y = zip(*sorted(zip(x, y)))\n",
    "my_colors = list('rgbkymc') \n",
    "fig, ax = plt.subplots(figsize=(7,7))    \n",
    "width = 0.75 # the width of the bars   # the x locations for the groups\n",
    "ax.bar(x, y, width, color=my_colors,alpha=0.7)\n",
    "ax.set_xticks([1,2,3,4,5,6,7,8,9,10])\n",
    "ax.set_yticks([5,10,20,30,40,50,60])\n",
    "for i, p in enumerate(ax.patches):\n",
    "    height = p.get_height()\n",
    "    ax.text(p.get_x()+p.get_width()/2., height + 0.1,y[i],ha=\"center\")\n",
    "plt.xlabel('offer id')\n",
    "plt.ylabel('count')\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The least completed offers were 3,4,5, and 10 and the only ones not sent via social media. The view rate is also very low for these offers since customers cannot intentionally complete an offer if they are unaware about the eligiblity. Therefore, not sending offers via social is not ideal for nearly all demographics.\n",
    "Offers 1,2,4,9 are BOGO(Buy One Get One) offers with matching rewards and maximum duration of 168 hours, which is really very short considering the difficulty constraint.\n",
    "Out of the two informational offers, offer 8 is determined to be most suitable. Offer 8 has a shorter duration, but is sent via social media, while offer 3 is not sent via social media.Offer 7 is a discount offer that is available for the longest duration, 240 hours, and with the highest number of promotion channels - email, web, social, mobileAs for offer 6, it is a discount offer that includes a good reward-difficulty ratio, ample duration time of 168 hours, and is also sent across all possible channels.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 478,
   "metadata": {},
   "outputs": [],
   "source": [
    "test_data_ml.to_csv('data/final_results.csv',index=False,mode='w+')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Seperating offers based on the type(BOGO,Informational and Discount)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 479,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style type=\"text/css\">\n",
       "</style>\n",
       "<table id=\"T_56d9b_\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th class=\"col_heading level0 col0\" >offer_id</th>\n",
       "      <th class=\"col_heading level0 col1\" >reward</th>\n",
       "      <th class=\"col_heading level0 col2\" >difficulty</th>\n",
       "      <th class=\"col_heading level0 col3\" >duration</th>\n",
       "      <th class=\"col_heading level0 col4\" >email</th>\n",
       "      <th class=\"col_heading level0 col5\" >mobile</th>\n",
       "      <th class=\"col_heading level0 col6\" >social</th>\n",
       "      <th class=\"col_heading level0 col7\" >web</th>\n",
       "      <th class=\"col_heading level0 col8\" >bogo</th>\n",
       "      <th class=\"col_heading level0 col9\" >informational</th>\n",
       "      <th class=\"col_heading level0 col10\" >discount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row0_col0\" class=\"data row0 col0\" >1</td>\n",
       "      <td id=\"T_56d9b_row0_col1\" class=\"data row0 col1\" >10</td>\n",
       "      <td id=\"T_56d9b_row0_col2\" class=\"data row0 col2\" >10</td>\n",
       "      <td id=\"T_56d9b_row0_col3\" class=\"data row0 col3\" >168</td>\n",
       "      <td id=\"T_56d9b_row0_col4\" class=\"data row0 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row0_col5\" class=\"data row0 col5\" >1</td>\n",
       "      <td id=\"T_56d9b_row0_col6\" class=\"data row0 col6\" >1</td>\n",
       "      <td id=\"T_56d9b_row0_col7\" class=\"data row0 col7\" >0</td>\n",
       "      <td id=\"T_56d9b_row0_col8\" class=\"data row0 col8\" >1</td>\n",
       "      <td id=\"T_56d9b_row0_col9\" class=\"data row0 col9\" >0</td>\n",
       "      <td id=\"T_56d9b_row0_col10\" class=\"data row0 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row1_col0\" class=\"data row1 col0\" >2</td>\n",
       "      <td id=\"T_56d9b_row1_col1\" class=\"data row1 col1\" >10</td>\n",
       "      <td id=\"T_56d9b_row1_col2\" class=\"data row1 col2\" >10</td>\n",
       "      <td id=\"T_56d9b_row1_col3\" class=\"data row1 col3\" >120</td>\n",
       "      <td id=\"T_56d9b_row1_col4\" class=\"data row1 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row1_col5\" class=\"data row1 col5\" >1</td>\n",
       "      <td id=\"T_56d9b_row1_col6\" class=\"data row1 col6\" >1</td>\n",
       "      <td id=\"T_56d9b_row1_col7\" class=\"data row1 col7\" >1</td>\n",
       "      <td id=\"T_56d9b_row1_col8\" class=\"data row1 col8\" >1</td>\n",
       "      <td id=\"T_56d9b_row1_col9\" class=\"data row1 col9\" >0</td>\n",
       "      <td id=\"T_56d9b_row1_col10\" class=\"data row1 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row2_col0\" class=\"data row2 col0\" >3</td>\n",
       "      <td id=\"T_56d9b_row2_col1\" class=\"data row2 col1\" >0</td>\n",
       "      <td id=\"T_56d9b_row2_col2\" class=\"data row2 col2\" >0</td>\n",
       "      <td id=\"T_56d9b_row2_col3\" class=\"data row2 col3\" >96</td>\n",
       "      <td id=\"T_56d9b_row2_col4\" class=\"data row2 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row2_col5\" class=\"data row2 col5\" >1</td>\n",
       "      <td id=\"T_56d9b_row2_col6\" class=\"data row2 col6\" >0</td>\n",
       "      <td id=\"T_56d9b_row2_col7\" class=\"data row2 col7\" >1</td>\n",
       "      <td id=\"T_56d9b_row2_col8\" class=\"data row2 col8\" >0</td>\n",
       "      <td id=\"T_56d9b_row2_col9\" class=\"data row2 col9\" >1</td>\n",
       "      <td id=\"T_56d9b_row2_col10\" class=\"data row2 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row3_col0\" class=\"data row3 col0\" >4</td>\n",
       "      <td id=\"T_56d9b_row3_col1\" class=\"data row3 col1\" >5</td>\n",
       "      <td id=\"T_56d9b_row3_col2\" class=\"data row3 col2\" >5</td>\n",
       "      <td id=\"T_56d9b_row3_col3\" class=\"data row3 col3\" >168</td>\n",
       "      <td id=\"T_56d9b_row3_col4\" class=\"data row3 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row3_col5\" class=\"data row3 col5\" >1</td>\n",
       "      <td id=\"T_56d9b_row3_col6\" class=\"data row3 col6\" >0</td>\n",
       "      <td id=\"T_56d9b_row3_col7\" class=\"data row3 col7\" >1</td>\n",
       "      <td id=\"T_56d9b_row3_col8\" class=\"data row3 col8\" >1</td>\n",
       "      <td id=\"T_56d9b_row3_col9\" class=\"data row3 col9\" >0</td>\n",
       "      <td id=\"T_56d9b_row3_col10\" class=\"data row3 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row4_col0\" class=\"data row4 col0\" >5</td>\n",
       "      <td id=\"T_56d9b_row4_col1\" class=\"data row4 col1\" >5</td>\n",
       "      <td id=\"T_56d9b_row4_col2\" class=\"data row4 col2\" >20</td>\n",
       "      <td id=\"T_56d9b_row4_col3\" class=\"data row4 col3\" >240</td>\n",
       "      <td id=\"T_56d9b_row4_col4\" class=\"data row4 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row4_col5\" class=\"data row4 col5\" >0</td>\n",
       "      <td id=\"T_56d9b_row4_col6\" class=\"data row4 col6\" >0</td>\n",
       "      <td id=\"T_56d9b_row4_col7\" class=\"data row4 col7\" >1</td>\n",
       "      <td id=\"T_56d9b_row4_col8\" class=\"data row4 col8\" >0</td>\n",
       "      <td id=\"T_56d9b_row4_col9\" class=\"data row4 col9\" >0</td>\n",
       "      <td id=\"T_56d9b_row4_col10\" class=\"data row4 col10\" >1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row5_col0\" class=\"data row5 col0\" >6</td>\n",
       "      <td id=\"T_56d9b_row5_col1\" class=\"data row5 col1\" >3</td>\n",
       "      <td id=\"T_56d9b_row5_col2\" class=\"data row5 col2\" >7</td>\n",
       "      <td id=\"T_56d9b_row5_col3\" class=\"data row5 col3\" >168</td>\n",
       "      <td id=\"T_56d9b_row5_col4\" class=\"data row5 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row5_col5\" class=\"data row5 col5\" >1</td>\n",
       "      <td id=\"T_56d9b_row5_col6\" class=\"data row5 col6\" >1</td>\n",
       "      <td id=\"T_56d9b_row5_col7\" class=\"data row5 col7\" >1</td>\n",
       "      <td id=\"T_56d9b_row5_col8\" class=\"data row5 col8\" >0</td>\n",
       "      <td id=\"T_56d9b_row5_col9\" class=\"data row5 col9\" >0</td>\n",
       "      <td id=\"T_56d9b_row5_col10\" class=\"data row5 col10\" >1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row6_col0\" class=\"data row6 col0\" >7</td>\n",
       "      <td id=\"T_56d9b_row6_col1\" class=\"data row6 col1\" >2</td>\n",
       "      <td id=\"T_56d9b_row6_col2\" class=\"data row6 col2\" >10</td>\n",
       "      <td id=\"T_56d9b_row6_col3\" class=\"data row6 col3\" >240</td>\n",
       "      <td id=\"T_56d9b_row6_col4\" class=\"data row6 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row6_col5\" class=\"data row6 col5\" >1</td>\n",
       "      <td id=\"T_56d9b_row6_col6\" class=\"data row6 col6\" >1</td>\n",
       "      <td id=\"T_56d9b_row6_col7\" class=\"data row6 col7\" >1</td>\n",
       "      <td id=\"T_56d9b_row6_col8\" class=\"data row6 col8\" >0</td>\n",
       "      <td id=\"T_56d9b_row6_col9\" class=\"data row6 col9\" >0</td>\n",
       "      <td id=\"T_56d9b_row6_col10\" class=\"data row6 col10\" >1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row7_col0\" class=\"data row7 col0\" >8</td>\n",
       "      <td id=\"T_56d9b_row7_col1\" class=\"data row7 col1\" >0</td>\n",
       "      <td id=\"T_56d9b_row7_col2\" class=\"data row7 col2\" >0</td>\n",
       "      <td id=\"T_56d9b_row7_col3\" class=\"data row7 col3\" >72</td>\n",
       "      <td id=\"T_56d9b_row7_col4\" class=\"data row7 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row7_col5\" class=\"data row7 col5\" >1</td>\n",
       "      <td id=\"T_56d9b_row7_col6\" class=\"data row7 col6\" >1</td>\n",
       "      <td id=\"T_56d9b_row7_col7\" class=\"data row7 col7\" >0</td>\n",
       "      <td id=\"T_56d9b_row7_col8\" class=\"data row7 col8\" >0</td>\n",
       "      <td id=\"T_56d9b_row7_col9\" class=\"data row7 col9\" >1</td>\n",
       "      <td id=\"T_56d9b_row7_col10\" class=\"data row7 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row8_col0\" class=\"data row8 col0\" >9</td>\n",
       "      <td id=\"T_56d9b_row8_col1\" class=\"data row8 col1\" >5</td>\n",
       "      <td id=\"T_56d9b_row8_col2\" class=\"data row8 col2\" >5</td>\n",
       "      <td id=\"T_56d9b_row8_col3\" class=\"data row8 col3\" >120</td>\n",
       "      <td id=\"T_56d9b_row8_col4\" class=\"data row8 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row8_col5\" class=\"data row8 col5\" >1</td>\n",
       "      <td id=\"T_56d9b_row8_col6\" class=\"data row8 col6\" >1</td>\n",
       "      <td id=\"T_56d9b_row8_col7\" class=\"data row8 col7\" >1</td>\n",
       "      <td id=\"T_56d9b_row8_col8\" class=\"data row8 col8\" >1</td>\n",
       "      <td id=\"T_56d9b_row8_col9\" class=\"data row8 col9\" >0</td>\n",
       "      <td id=\"T_56d9b_row8_col10\" class=\"data row8 col10\" >0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td id=\"T_56d9b_row9_col0\" class=\"data row9 col0\" >10</td>\n",
       "      <td id=\"T_56d9b_row9_col1\" class=\"data row9 col1\" >2</td>\n",
       "      <td id=\"T_56d9b_row9_col2\" class=\"data row9 col2\" >10</td>\n",
       "      <td id=\"T_56d9b_row9_col3\" class=\"data row9 col3\" >168</td>\n",
       "      <td id=\"T_56d9b_row9_col4\" class=\"data row9 col4\" >1</td>\n",
       "      <td id=\"T_56d9b_row9_col5\" class=\"data row9 col5\" >1</td>\n",
       "      <td id=\"T_56d9b_row9_col6\" class=\"data row9 col6\" >0</td>\n",
       "      <td id=\"T_56d9b_row9_col7\" class=\"data row9 col7\" >1</td>\n",
       "      <td id=\"T_56d9b_row9_col8\" class=\"data row9 col8\" >0</td>\n",
       "      <td id=\"T_56d9b_row9_col9\" class=\"data row9 col9\" >0</td>\n",
       "      <td id=\"T_56d9b_row9_col10\" class=\"data row9 col10\" >1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n"
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x1be9750bdf0>"
      ]
     },
     "execution_count": 479,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "portfolio.style.hide_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 481,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age_bin</th>\n",
       "      <th>income_bin</th>\n",
       "      <th>years_member_bin</th>\n",
       "      <th>max_prob_offer</th>\n",
       "      <th>max_prob_of_offer</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Others</td>\n",
       "      <td>33-48</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>9</td>\n",
       "      <td>0.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Female</td>\n",
       "      <td>18-33</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>9</td>\n",
       "      <td>0.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>Others</td>\n",
       "      <td>61-75</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>2</td>\n",
       "      <td>0.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>Others</td>\n",
       "      <td>18-33</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>1</td>\n",
       "      <td>0.70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>Others</td>\n",
       "      <td>33-48</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>2</td>\n",
       "      <td>0.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>Others</td>\n",
       "      <td>48-61</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>2</td>\n",
       "      <td>0.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>Male</td>\n",
       "      <td>48-61</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>9</td>\n",
       "      <td>0.86</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52</th>\n",
       "      <td>Female</td>\n",
       "      <td>33-48</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>1</td>\n",
       "      <td>1.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57</th>\n",
       "      <td>Others</td>\n",
       "      <td>33-48</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>1</td>\n",
       "      <td>0.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62</th>\n",
       "      <td>Male</td>\n",
       "      <td>33-48</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>9</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>Others</td>\n",
       "      <td>18-33</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>9</td>\n",
       "      <td>0.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>Others</td>\n",
       "      <td>33-48</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>2</td>\n",
       "      <td>0.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>Others</td>\n",
       "      <td>48-61</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>2</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>90</th>\n",
       "      <td>Others</td>\n",
       "      <td>75+</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>9</td>\n",
       "      <td>0.96</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    gender age_bin income_bin years_member_bin  max_prob_offer  \\\n",
       "12  Others   33-48    30k-50k        <=5 years               9   \n",
       "21  Female   18-33    50k-80k        <=5 years               9   \n",
       "29  Others   61-75    50k-80k        <=5 years               2   \n",
       "41  Others   18-33       80k+        <=5 years               1   \n",
       "42  Others   33-48       80k+        <=5 years               2   \n",
       "43  Others   48-61       80k+        <=5 years               2   \n",
       "48    Male   48-61    30k-50k         >5 years               9   \n",
       "52  Female   33-48    30k-50k         >5 years               1   \n",
       "57  Others   33-48    30k-50k         >5 years               1   \n",
       "62    Male   33-48    50k-80k         >5 years               9   \n",
       "86  Others   18-33       80k+         >5 years               9   \n",
       "87  Others   33-48       80k+         >5 years               2   \n",
       "88  Others   48-61       80k+         >5 years               2   \n",
       "90  Others     75+       80k+         >5 years               9   \n",
       "\n",
       "    max_prob_of_offer  \n",
       "12               0.75  \n",
       "21               0.74  \n",
       "29               0.75  \n",
       "41               0.70  \n",
       "42               0.90  \n",
       "43               0.91  \n",
       "48               0.86  \n",
       "52               1.00  \n",
       "57               0.93  \n",
       "62               0.95  \n",
       "86               0.93  \n",
       "87               0.97  \n",
       "88               0.95  \n",
       "90               0.96  "
      ]
     },
     "execution_count": 481,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bogo=[1,2,4,9]\n",
    "test_data_ml[test_data_ml['max_prob_offer'].isin(bogo)] #bogo"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 482,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age_bin</th>\n",
       "      <th>income_bin</th>\n",
       "      <th>years_member_bin</th>\n",
       "      <th>max_prob_offer</th>\n",
       "      <th>max_prob_of_offer</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Male</td>\n",
       "      <td>18-33</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Male</td>\n",
       "      <td>33-48</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>48-61</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Male</td>\n",
       "      <td>61-75</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Male</td>\n",
       "      <td>75+</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Female</td>\n",
       "      <td>48-61</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Female</td>\n",
       "      <td>61-75</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Female</td>\n",
       "      <td>75+</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Others</td>\n",
       "      <td>48-61</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.72</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Others</td>\n",
       "      <td>61-75</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Others</td>\n",
       "      <td>75+</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Male</td>\n",
       "      <td>18-33</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Male</td>\n",
       "      <td>61-75</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>Others</td>\n",
       "      <td>61-75</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.86</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>Male</td>\n",
       "      <td>61-75</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>Others</td>\n",
       "      <td>48-61</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>8</td>\n",
       "      <td>0.90</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    gender age_bin income_bin years_member_bin  max_prob_offer  \\\n",
       "1     Male   18-33    30k-50k        <=5 years               8   \n",
       "2     Male   33-48    30k-50k        <=5 years               8   \n",
       "3     Male   48-61    30k-50k        <=5 years               8   \n",
       "4     Male   61-75    30k-50k        <=5 years               8   \n",
       "5     Male     75+    30k-50k        <=5 years               8   \n",
       "8   Female   48-61    30k-50k        <=5 years               8   \n",
       "9   Female   61-75    30k-50k        <=5 years               8   \n",
       "10  Female     75+    30k-50k        <=5 years               8   \n",
       "13  Others   48-61    30k-50k        <=5 years               8   \n",
       "14  Others   61-75    30k-50k        <=5 years               8   \n",
       "15  Others     75+    30k-50k        <=5 years               8   \n",
       "16    Male   18-33    50k-80k        <=5 years               8   \n",
       "19    Male   61-75    50k-80k        <=5 years               8   \n",
       "44  Others   61-75       80k+        <=5 years               8   \n",
       "49    Male   61-75    30k-50k         >5 years               8   \n",
       "58  Others   48-61    30k-50k         >5 years               8   \n",
       "\n",
       "    max_prob_of_offer  \n",
       "1                0.69  \n",
       "2                0.68  \n",
       "3                0.66  \n",
       "4                0.69  \n",
       "5                0.76  \n",
       "8                0.74  \n",
       "9                0.84  \n",
       "10               0.87  \n",
       "13               0.72  \n",
       "14               0.83  \n",
       "15               0.77  \n",
       "16               0.61  \n",
       "19               0.61  \n",
       "44               0.86  \n",
       "49               0.98  \n",
       "58               0.90  "
      ]
     },
     "execution_count": 482,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "informational=[3,8]\n",
    "test_data_ml[test_data_ml['max_prob_offer'].isin(informational)] #informational"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 483,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>gender</th>\n",
       "      <th>age_bin</th>\n",
       "      <th>income_bin</th>\n",
       "      <th>years_member_bin</th>\n",
       "      <th>max_prob_offer</th>\n",
       "      <th>max_prob_of_offer</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Female</td>\n",
       "      <td>18-33</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Female</td>\n",
       "      <td>33-48</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Others</td>\n",
       "      <td>18-33</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Male</td>\n",
       "      <td>33-48</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Male</td>\n",
       "      <td>48-61</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.67</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Male</td>\n",
       "      <td>75+</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Female</td>\n",
       "      <td>33-48</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Female</td>\n",
       "      <td>48-61</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Female</td>\n",
       "      <td>61-75</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.70</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Female</td>\n",
       "      <td>75+</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Others</td>\n",
       "      <td>18-33</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Others</td>\n",
       "      <td>33-48</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Others</td>\n",
       "      <td>48-61</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>Others</td>\n",
       "      <td>75+</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>Male</td>\n",
       "      <td>18-33</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>Male</td>\n",
       "      <td>33-48</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>Male</td>\n",
       "      <td>48-61</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>Male</td>\n",
       "      <td>61-75</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>Male</td>\n",
       "      <td>75+</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>Female</td>\n",
       "      <td>18-33</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.79</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>Female</td>\n",
       "      <td>33-48</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>Female</td>\n",
       "      <td>48-61</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>Female</td>\n",
       "      <td>61-75</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.79</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>Female</td>\n",
       "      <td>75+</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>Others</td>\n",
       "      <td>75+</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&lt;=5 years</td>\n",
       "      <td>5</td>\n",
       "      <td>0.78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>Male</td>\n",
       "      <td>18-33</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>Male</td>\n",
       "      <td>33-48</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>Male</td>\n",
       "      <td>75+</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>1.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51</th>\n",
       "      <td>Female</td>\n",
       "      <td>18-33</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>Female</td>\n",
       "      <td>48-61</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54</th>\n",
       "      <td>Female</td>\n",
       "      <td>61-75</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55</th>\n",
       "      <td>Female</td>\n",
       "      <td>75+</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>Others</td>\n",
       "      <td>18-33</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59</th>\n",
       "      <td>Others</td>\n",
       "      <td>61-75</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>Others</td>\n",
       "      <td>75+</td>\n",
       "      <td>30k-50k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.89</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>Male</td>\n",
       "      <td>18-33</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>Male</td>\n",
       "      <td>48-61</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>64</th>\n",
       "      <td>Male</td>\n",
       "      <td>61-75</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65</th>\n",
       "      <td>Male</td>\n",
       "      <td>75+</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66</th>\n",
       "      <td>Female</td>\n",
       "      <td>18-33</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>1.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>67</th>\n",
       "      <td>Female</td>\n",
       "      <td>33-48</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>68</th>\n",
       "      <td>Female</td>\n",
       "      <td>48-61</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>Female</td>\n",
       "      <td>61-75</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70</th>\n",
       "      <td>Female</td>\n",
       "      <td>75+</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>71</th>\n",
       "      <td>Others</td>\n",
       "      <td>18-33</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>72</th>\n",
       "      <td>Others</td>\n",
       "      <td>33-48</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>6</td>\n",
       "      <td>0.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73</th>\n",
       "      <td>Others</td>\n",
       "      <td>48-61</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>74</th>\n",
       "      <td>Others</td>\n",
       "      <td>61-75</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75</th>\n",
       "      <td>Others</td>\n",
       "      <td>75+</td>\n",
       "      <td>50k-80k</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76</th>\n",
       "      <td>Male</td>\n",
       "      <td>18-33</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77</th>\n",
       "      <td>Male</td>\n",
       "      <td>33-48</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.96</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>Male</td>\n",
       "      <td>48-61</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>Male</td>\n",
       "      <td>61-75</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80</th>\n",
       "      <td>Male</td>\n",
       "      <td>75+</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>Female</td>\n",
       "      <td>18-33</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>82</th>\n",
       "      <td>Female</td>\n",
       "      <td>33-48</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>1.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>83</th>\n",
       "      <td>Female</td>\n",
       "      <td>48-61</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84</th>\n",
       "      <td>Female</td>\n",
       "      <td>61-75</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>85</th>\n",
       "      <td>Female</td>\n",
       "      <td>75+</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>Others</td>\n",
       "      <td>61-75</td>\n",
       "      <td>80k+</td>\n",
       "      <td>&gt;5 years</td>\n",
       "      <td>7</td>\n",
       "      <td>0.94</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    gender age_bin income_bin years_member_bin  max_prob_offer  \\\n",
       "6   Female   18-33    30k-50k        <=5 years               6   \n",
       "7   Female   33-48    30k-50k        <=5 years               6   \n",
       "11  Others   18-33    30k-50k        <=5 years               7   \n",
       "17    Male   33-48    50k-80k        <=5 years               6   \n",
       "18    Male   48-61    50k-80k        <=5 years               7   \n",
       "20    Male     75+    50k-80k        <=5 years               7   \n",
       "22  Female   33-48    50k-80k        <=5 years               7   \n",
       "23  Female   48-61    50k-80k        <=5 years               6   \n",
       "24  Female   61-75    50k-80k        <=5 years               7   \n",
       "25  Female     75+    50k-80k        <=5 years               6   \n",
       "26  Others   18-33    50k-80k        <=5 years               6   \n",
       "27  Others   33-48    50k-80k        <=5 years               7   \n",
       "28  Others   48-61    50k-80k        <=5 years               6   \n",
       "30  Others     75+    50k-80k        <=5 years               7   \n",
       "31    Male   18-33       80k+        <=5 years               7   \n",
       "32    Male   33-48       80k+        <=5 years               7   \n",
       "33    Male   48-61       80k+        <=5 years               7   \n",
       "34    Male   61-75       80k+        <=5 years               7   \n",
       "35    Male     75+       80k+        <=5 years               6   \n",
       "36  Female   18-33       80k+        <=5 years               7   \n",
       "37  Female   33-48       80k+        <=5 years               7   \n",
       "38  Female   48-61       80k+        <=5 years               6   \n",
       "39  Female   61-75       80k+        <=5 years               7   \n",
       "40  Female     75+       80k+        <=5 years               7   \n",
       "45  Others     75+       80k+        <=5 years               5   \n",
       "46    Male   18-33    30k-50k         >5 years               7   \n",
       "47    Male   33-48    30k-50k         >5 years               6   \n",
       "50    Male     75+    30k-50k         >5 years               7   \n",
       "51  Female   18-33    30k-50k         >5 years               7   \n",
       "53  Female   48-61    30k-50k         >5 years               7   \n",
       "54  Female   61-75    30k-50k         >5 years               7   \n",
       "55  Female     75+    30k-50k         >5 years               6   \n",
       "56  Others   18-33    30k-50k         >5 years               6   \n",
       "59  Others   61-75    30k-50k         >5 years               6   \n",
       "60  Others     75+    30k-50k         >5 years               6   \n",
       "61    Male   18-33    50k-80k         >5 years               6   \n",
       "63    Male   48-61    50k-80k         >5 years               7   \n",
       "64    Male   61-75    50k-80k         >5 years               7   \n",
       "65    Male     75+    50k-80k         >5 years               7   \n",
       "66  Female   18-33    50k-80k         >5 years               7   \n",
       "67  Female   33-48    50k-80k         >5 years               6   \n",
       "68  Female   48-61    50k-80k         >5 years               7   \n",
       "69  Female   61-75    50k-80k         >5 years               7   \n",
       "70  Female     75+    50k-80k         >5 years               6   \n",
       "71  Others   18-33    50k-80k         >5 years               7   \n",
       "72  Others   33-48    50k-80k         >5 years               6   \n",
       "73  Others   48-61    50k-80k         >5 years               7   \n",
       "74  Others   61-75    50k-80k         >5 years               7   \n",
       "75  Others     75+    50k-80k         >5 years               7   \n",
       "76    Male   18-33       80k+         >5 years               7   \n",
       "77    Male   33-48       80k+         >5 years               7   \n",
       "78    Male   48-61       80k+         >5 years               7   \n",
       "79    Male   61-75       80k+         >5 years               7   \n",
       "80    Male     75+       80k+         >5 years               7   \n",
       "81  Female   18-33       80k+         >5 years               7   \n",
       "82  Female   33-48       80k+         >5 years               7   \n",
       "83  Female   48-61       80k+         >5 years               7   \n",
       "84  Female   61-75       80k+         >5 years               7   \n",
       "85  Female     75+       80k+         >5 years               7   \n",
       "89  Others   61-75       80k+         >5 years               7   \n",
       "\n",
       "    max_prob_of_offer  \n",
       "6                0.75  \n",
       "7                0.69  \n",
       "11               0.78  \n",
       "17               0.62  \n",
       "18               0.67  \n",
       "20               0.68  \n",
       "22               0.74  \n",
       "23               0.78  \n",
       "24               0.70  \n",
       "25               0.78  \n",
       "26               0.84  \n",
       "27               0.83  \n",
       "28               0.81  \n",
       "30               0.76  \n",
       "31               0.64  \n",
       "32               0.74  \n",
       "33               0.75  \n",
       "34               0.77  \n",
       "35               0.76  \n",
       "36               0.79  \n",
       "37               0.84  \n",
       "38               0.73  \n",
       "39               0.79  \n",
       "40               0.80  \n",
       "45               0.78  \n",
       "46               0.90  \n",
       "47               0.89  \n",
       "50               1.00  \n",
       "51               0.91  \n",
       "53               0.93  \n",
       "54               0.92  \n",
       "55               0.94  \n",
       "56               0.93  \n",
       "59               0.92  \n",
       "60               0.89  \n",
       "61               0.95  \n",
       "63               0.95  \n",
       "64               0.95  \n",
       "65               0.98  \n",
       "66               1.00  \n",
       "67               0.94  \n",
       "68               0.97  \n",
       "69               0.95  \n",
       "70               0.97  \n",
       "71               0.98  \n",
       "72               0.99  \n",
       "73               0.99  \n",
       "74               0.99  \n",
       "75               0.98  \n",
       "76               0.94  \n",
       "77               0.96  \n",
       "78               0.94  \n",
       "79               0.97  \n",
       "80               0.95  \n",
       "81               0.98  \n",
       "82               1.00  \n",
       "83               0.93  \n",
       "84               0.98  \n",
       "85               0.98  \n",
       "89               0.94  "
      ]
     },
     "execution_count": 483,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "discount=[5,6,7,10]\n",
    "test_data_ml[test_data_ml['max_prob_offer'].isin(discount)] #discount"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 484,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "No of BOGO offers recommended :14\n",
      "No of Informational offers recommended :16\n",
      "No of Discount offers recommended :60\n"
     ]
    }
   ],
   "source": [
    "print(\"No of BOGO offers recommended :{}\".format(test_data_ml[test_data_ml['max_prob_offer'].isin(bogo)].shape[0]))\n",
    "print(\"No of Informational offers recommended :{}\".format(test_data_ml[test_data_ml['max_prob_offer'].isin(informational)].shape[0]))\n",
    "print(\"No of Discount offers recommended :{}\".format(test_data_ml[test_data_ml['max_prob_offer'].isin(discount)].shape[0]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Even though the model only has a 70% recall, it can predict the most suitable offer based on the offer completion probability very accurately. Other offers may or may not be sent, but the best one has to be sent to break the customer’s resistance which can be done easily due to the fact that we now know what kind of offers are attractive to what demographic of customers. The ideal way to promote the offers is over the social.Because of this model, we will definitely increase the offer completion rate since we will be sending offers based on the demographics which will inturn help the sales."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Improvement"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Starbucks location of purchase, day of purchase would have helped in increasing the models accuracy since it could have identified patterns based on location, weekday and weekend patterns of purchase. Feature engineering can be done on Recency and Frequency columns representing how recently a customer made a purchase and how often a customer purchases respectively without having any data leakage. A/B testing experiment can be done between different customers belonging to the same demographic to find more insights."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Acknowledgements"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "* This project was completed as part of Udacity Data Scientist Nanodegree and thanks to Starbucks for the labelled data set.\n",
    "\n",
    "* Special thanks to Chaitanya KC for assistance with the main project goal.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### References"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "* https://pbpython.com/natural-breaks.html\n",
    "\n",
    "* https://stackoverflow.com/questions/55104819/display-count-on-top-of-seaborn-barplot\n",
    "\n",
    "* https://github.com/mariavaghani/Optimizing-App-Offers-With-Starbucks\n",
    "\n",
    "* https://stackoverflow.com/questions/16476924/how-to-iterate-over-rows-in-a-dataframe-in-pandas\n",
    "\n",
    "* https://towardsdatascience.com/hyperparameter-tuning-the-random-forest-in-python-using-scikit-learn-28d2aa77dd74\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
